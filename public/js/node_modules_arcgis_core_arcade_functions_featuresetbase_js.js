"use strict";
(self["webpackChunk"] = self["webpackChunk"] || []).push([["node_modules_arcgis_core_arcade_functions_featuresetbase_js"],{

/***/ "./node_modules/@arcgis/core/arcade/featureSetCollection.js":
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureSetCollection.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ r)
/* harmony export */ });
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class r{constructor(){this.declaredRootClass="esri.arcade.featureSetCollection",this._layerById={},this._layerByName={}}add(e,r,t){this._layerById[r]=t,this._layerByName[e]=t}featureSetByName(e,r=!0,t=["*"]){return void 0===this._layerByName[e]?this.resolvePromise(null):this.resolvePromise(this._layerByName[e])}featureSetById(e,r=!0,t=["*"]){return void 0===this._layerById[e]?this.resolvePromise(null):this.resolvePromise(this._layerById[e])}castToText(){return"object, FeatureSetCollection"}resolvePromise(r){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.resolve)(r)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureSetUtils.js":
/*!*************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureSetUtils.js ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "constructAssociationMetaDataFeatureSetFromUrl": () => (/* binding */ j),
/* harmony export */   "constructFeatureSet": () => (/* binding */ g),
/* harmony export */   "constructFeatureSetFromPortalItem": () => (/* binding */ G),
/* harmony export */   "constructFeatureSetFromRelationship": () => (/* binding */ w),
/* harmony export */   "constructFeatureSetFromUrl": () => (/* binding */ T),
/* harmony export */   "convertToFeatureSet": () => (/* binding */ P),
/* harmony export */   "createFeatureSetCollectionFromMap": () => (/* binding */ E),
/* harmony export */   "createFeatureSetCollectionFromService": () => (/* binding */ b),
/* harmony export */   "getPortal": () => (/* binding */ D),
/* harmony export */   "initialiseMetaDataCache": () => (/* binding */ N),
/* harmony export */   "lookupUser": () => (/* binding */ q)
/* harmony export */ });
/* harmony import */ var _kernel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kernel.js */ "./node_modules/@arcgis/core/kernel.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./featureSetCollection.js */ "./node_modules/@arcgis/core/arcade/featureSetCollection.js");
/* harmony import */ var _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./featureset/actions/AttributeFilter.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js");
/* harmony import */ var _featureset_actions_GroupBy_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./featureset/actions/GroupBy.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/GroupBy.js");
/* harmony import */ var _featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./featureset/actions/OrderBy.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js");
/* harmony import */ var _featureset_actions_SpatialFilter_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./featureset/actions/SpatialFilter.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/SpatialFilter.js");
/* harmony import */ var _featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./featureset/actions/Top.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/Top.js");
/* harmony import */ var _featureset_sources_FeatureLayerDynamic_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./featureset/sources/FeatureLayerDynamic.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerDynamic.js");
/* harmony import */ var _featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./featureset/sources/FeatureLayerMemory.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerMemory.js");
/* harmony import */ var _featureset_sources_FeatureLayerRelated_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./featureset/sources/FeatureLayerRelated.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerRelated.js");
/* harmony import */ var _featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./featureset/support/cache.js */ "./node_modules/@arcgis/core/arcade/featureset/support/cache.js");
/* harmony import */ var _featureset_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./featureset/support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./featureset/support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../layers/FeatureLayer.js */ "./node_modules/@arcgis/core/layers/FeatureLayer.js");
/* harmony import */ var _portal_Portal_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../portal/Portal.js */ "./node_modules/@arcgis/core/portal/Portal.js");
/* harmony import */ var _portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../portal/PortalItem.js */ "./node_modules/@arcgis/core/portal/PortalItem.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function N(){null===_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache&&(_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache=new _featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"])}function F(e,t){if(_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache){const r=_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.getLayerInfo(e);if(r)return r.then((r=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]({url:e,outFields:t,sourceJSON:r}))));const n=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]({url:e,outFields:t});let a=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.create)(((e,t)=>{n.load().then((()=>{e(n.sourceJSON)}),(e=>{t(e)}))}));return _featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache&&(_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.setLayerInfo(e,a),a=a.catch((t=>{throw _featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.clearLayerInfo(e),t}))),a.then((()=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(n)))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]({url:e,outFields:t}))}function T(e,t,r,n,a,s=null){return F(e,["*"]).then((e=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(g(e,t,r,n,a,s))))}function g(e,t=null,r=null,n=!0,a=null,s=null){return!0===e._hasMemorySource()?new _featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_9__["default"]({layer:e,spatialReference:t,outFields:r,includeGeometry:n,lrucache:a,interceptor:s}):new _featureset_sources_FeatureLayerDynamic_js__WEBPACK_IMPORTED_MODULE_8__["default"]({layer:e,spatialReference:t,outFields:r,includeGeometry:n,lrucache:a,interceptor:s})}function A(e){if(null!==_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache){const t=_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.getLayerInfo(e);if(null!==t)return t}let r=(0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(e,{responseType:"json",query:{f:"json"}}).then((e=>{if(e.data){const t=e.data;return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(t)}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(null)}));return null!==_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache&&(_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.setLayerInfo(e,r),r=r.catch((t=>{throw _featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.clearLayerInfo(e),t}))),r}function C(e,r){const n="QUERYDATAELEMTS:"+r.toString()+":"+e;if(null!==_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache){const e=_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.getLayerInfo(n);if(null!==e)return e}let a=(0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(e+"/queryDataElements",{method:"post",responseType:"json",query:{layers:JSON.stringify([r.toString()]),f:"json"}}).then((e=>{if(e.data){const t=e.data;if(t.layerDataElements&&t.layerDataElements[0])return t.layerDataElements[0]}throw new Error("Not Found")}));return null!==_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache&&(_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.setLayerInfo(n,a),a=a.catch((e=>{throw _featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.clearLayerInfo(n),e}))),a}function k(e){if(null!==_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache){const t=_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.getLayerInfo(e);if(null!==t)return t}let r=(0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(e,{responseType:"json",query:{f:"json"}}).then((e=>{if(e.data){const t=e.data;return t.layers||(t.layers=[]),t.tables||(t.tables=[]),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(t)}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)({layers:[],tables:[]})}));return null!==_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache&&(_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.setLayerInfo(e,r),r=r.catch((t=>{throw _featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.clearLayerInfo(e),t}))),r}function j(e,t){const r={metadata:null,networkId:-1,unVersion:3,terminals:[],queryelem:null,layerNameLkp:{},lkp:null};return k(e).then((n=>{if(r.metadata=n,n.controllerDatasetLayers&&void 0!==n.controllerDatasetLayers.utilityNetworkLayerId&&null!==n.controllerDatasetLayers.utilityNetworkLayerId){if(n.layers)for(const e of n.layers)r.layerNameLkp[e.id]=e.name;if(n.tables)for(const e of n.tables)r.layerNameLkp[e.id]=e.name;const a=n.controllerDatasetLayers.utilityNetworkLayerId;return r.networkId=a,C(e,a).then((n=>{if(n){r.queryelem=n,r.queryelem&&r.queryelem.dataElement&&void 0!==r.queryelem.dataElement.schemaGeneration&&(r.unVersion=r.queryelem.dataElement.schemaGeneration),r.lkp={},r.queryelem.dataElement.domainNetworks||(r.queryelem.dataElement.domainNetworks=[]);for(const e of r.queryelem.dataElement.domainNetworks){for(const t of e.edgeSources?e.edgeSources:[]){const e={layerId:t.layerId,sourceId:t.sourceId,className:r.layerNameLkp[t.layerId]?r.layerNameLkp[t.layerId]:null};e.className&&(r.lkp[e.className]=e)}for(const t of e.junctionSources?e.junctionSources:[]){const e={layerId:t.layerId,sourceId:t.sourceId,className:r.layerNameLkp[t.layerId]?r.layerNameLkp[t.layerId]:null};e.className&&(r.lkp[e.className]=e)}}if(r.queryelem.dataElement.terminalConfigurations)for(const e of r.queryelem.dataElement.terminalConfigurations)for(const t of e.terminals)r.terminals.push({terminalId:t.terminalId,terminalName:t.terminalName});return A(e+"/"+a).then((n=>{if(n.systemLayers&&void 0!==n.systemLayers.associationsTableId&&null!==n.systemLayers.associationsTableId){const a=[];return r.unVersion>=4&&(a.push("STATUS"),a.push("PERCENTALONG")),T(e+"/"+n.systemLayers.associationsTableId.toString(),t,["OBJECTID","FROMNETWORKSOURCEID","TONETWORKSOURCEID","FROMGLOBALID","TOGLOBALID","TOTERMINALID","FROMTERMINALID","ASSOCIATIONTYPE","ISCONTENTVISIBLE","GLOBALID",...a],!1,null,null).then((e=>e.load())).then((e=>r.unVersion>=4?(e=e.filter(_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_15__.WhereClause.create("STATUS NOT IN (1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62,63)",e.getFieldsIndex()))).load():e)).then((e=>({lkp:r.lkp,associations:e,unVersion:r.unVersion,terminals:r.terminals})))}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[]}}))}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[]}}))}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[]}}))}function w(e,t,r,n=null,a=null,s=!0,i=null,l=null){let o=e.serviceUrl();return o?(o="/"===o.charAt(o.length-1)?o+t.relatedTableId.toString():o+"/"+t.relatedTableId.toString(),T(o,n,a,s,i,l).then((o=>new _featureset_sources_FeatureLayerRelated_js__WEBPACK_IMPORTED_MODULE_10__["default"]({layer:e,relatedLayer:o,relationship:t,objectId:r,spatialReference:n,outFields:a,includeGeometry:s,lrucache:i,interceptor:l})))):null}_featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"].registerAction(),_featureset_actions_GroupBy_js__WEBPACK_IMPORTED_MODULE_4__["default"].registerAction(),_featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_5__["default"].registerAction(),_featureset_actions_SpatialFilter_js__WEBPACK_IMPORTED_MODULE_6__["default"].registerAction(),_featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_7__["default"].registerAction();class O extends _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_2__["default"]{constructor(e,t=null,r=null,n=null){super(),this._map=e,this._overridespref=t,this.lrucache=r,this.interceptor=n,this._instantLayers=[]}makeAndAddFeatureSet(e,t=!0,r=null){const n=g(e,this._overridespref,null===r?["*"]:r,t,this.lrucache,this.interceptor);return this._instantLayers.push({featureset:n,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),n}featureSetByName(e,t=!0,r=null){if(void 0!==this._map.loaded&&void 0!==this._map.load&&!1===this._map.loaded)return this._map.load().then((()=>{try{return this.featureSetByName(e,t,r)}catch(n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.reject)(n)}}));null===r&&(r=["*"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);for(let s=0;s<this._instantLayers.length;s++){const r=this._instantLayers[s];if(r.opitem.title===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[s].featureset)}const a=this._map.layers.find((t=>t instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]&&t.title===e));if(a)return this.resolvePromise(this.makeAndAddFeatureSet(a,t,r));if(this._map.tables){const n=this._map.tables.find((t=>!!(t.title&&t.title===e||t.title&&t.title===e)));if(n){if(n instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"])return this.resolvePromise(this.makeAndAddFeatureSet(n,t,r));if(n._materializedTable);else{const e=n.outFields?n:{...n,outFields:["*"]};n._materializedTable=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"](e)}return n._materializedTable.load().then((()=>this.resolvePromise(this.makeAndAddFeatureSet(n._materializedTable,t,r))))}}return this.resolvePromise(null)}featureSetById(e,t=!0,r=["*"]){if(void 0!==this._map.loaded&&void 0!==this._map.load&&!1===this._map.loaded)return this._map.load().then((()=>{try{return this.featureSetById(e,t,r)}catch(n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.reject)(n)}}));null===r&&(r=["*"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);for(let s=0;s<this._instantLayers.length;s++){const r=this._instantLayers[s];if(r.opitem.id===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[s].featureset)}const a=this._map.layers.find((t=>t instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]&&t.id===e));if(a)return this.resolvePromise(this.makeAndAddFeatureSet(a,t,r));if(this._map.tables){const n=this._map.tables.find((t=>t.id===e));if(n){if(n instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"])return this.resolvePromise(this.makeAndAddFeatureSet(n,t,r));if(n._materializedTable);else{const e={...n,outFields:["*"]};n._materializedTable=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"](e)}return n._materializedTable.load().then((()=>this.resolvePromise(this.makeAndAddFeatureSet(n._materializedTable,t,r))))}}return this.resolvePromise(null)}}class v extends _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_2__["default"]{constructor(e,t=null,r=null,n=null){super(),this._url=e,this._overridespref=t,this.lrucache=r,this.interceptor=n,this.metadata=null,this._instantLayers=[]}get url(){return this._url}makeAndAddFeatureSet(e,t=!0,r=null){const n=g(e,this._overridespref,null===r?["*"]:r,t,this.lrucache);return this._instantLayers.push({featureset:n,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),n}_loadMetaData(){return k(this._url).then((e=>(this.metadata=e,e)))}load(){return this._loadMetaData()}clone(){return new v(this._url,this._overridespref,this.lrucache,this.interceptor)}featureSetByName(e,t=!0,r=null){null===r&&(r=["*"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);for(let a=0;a<this._instantLayers.length;a++){const r=this._instantLayers[a];if(r.opitem.title===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[a].featureset)}return this._loadMetaData().then((n=>{let a=null;for(const t of n.layers?n.layers:[])t.name===e&&(a=t);if(!a)for(const t of n.tables?n.tables:[])t.name===e&&(a=t);return a?F(this._url+"/"+a.id,["*"]).then((e=>this.makeAndAddFeatureSet(e,t,r))):this.resolvePromise(null)}))}featureSetById(e,t=!0,r=["*"]){null===r&&(r=["*"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);e=null!=e?e.toString():"";for(let a=0;a<this._instantLayers.length;a++){const r=this._instantLayers[a];if(r.opitem.id===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[a].featureset)}return this._loadMetaData().then((n=>{let a=null;for(const t of n.layers?n.layers:[])null!==t.id&&void 0!==t.id&&t.id.toString()===e&&(a=t);if(!a)for(const t of n.tables?n.tables:[])null!==t.id&&void 0!==t.id&&t.id.toString()===e&&(a=t);return a?F(this._url+"/"+a.id,["*"]).then((e=>this.makeAndAddFeatureSet(e,t,r))):this.resolvePromise(null)}))}}function E(e,t,r=null,n=null){return new O(e,t,r,n)}function b(e,t,r=null,n=null){return new v(e,t,r,n)}function D(e,t){if(null===e)return t;return new _portal_Portal_js__WEBPACK_IMPORTED_MODULE_17__["default"]({url:e.field("url")})}function q(r,n,a){return _kernel_js__WEBPACK_IMPORTED_MODULE_0__.id.findCredential(r.restUrl)?"loaded"===r.loadStatus&&""===n&&r.user&&r.user.sourceJSON&&!1===a?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(r.user.sourceJSON):""===n?(0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(r.restUrl+"/community/self",{responseType:"json",query:{f:"json",...!1===a?{}:{returnUserLicenseTypeExtensions:!0}}}).then((e=>{if(e.data){const t=e.data;if(t&&t.username)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(t)}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(null)})):(0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(r.restUrl+"/community/users/"+n,{responseType:"json",query:{f:"json"}}).then((e=>{if(e.data){const t=e.data;return t.error?null:(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(t)}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(null)})):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(null)}function P(e,t,r,n,a){if(null===e)return null;if(e instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]){switch(t){case"datasource":return g(e,a,e.outFields,!0,r,n).getDataSourceFeatureSet();case"parent":case"root":return g(e,a,e.outFields,!0,r,n)}return null}if(e instanceof _featureset_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_12__["default"])switch(t){case"datasource":return e.getDataSourceFeatureSet();case"parent":return e;case"root":return e.getRootFeatureSet()}return null}function G(e,t,r,n,a,s,i,l=null){if(_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache){const o=_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.getLayerInfo(e+":"+s.url);if(o)return o.then((e=>{try{const s=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]({url:(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_13__.extractServiceUrl)(e.url)+"/"+t,outFields:["*"]});return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.resolve)(g(s,r,n,a,i,l))}catch(s){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.reject)(s)}}),(e=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.reject)(e)))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_14__.create)(((o,u)=>{const c=new _portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_18__["default"]({id:e,portal:s}).load();_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache&&_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.setLayerInfo(e+":"+s.url,c),c.then((e=>{try{const s=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_16__["default"]({url:(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_13__.extractServiceUrl)(e.url)+"/"+t,outFields:["*"]});o(g(s,r,n,a,i,l))}catch(s){u(s)}}),(t=>{_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache&&_featureset_support_cache_js__WEBPACK_IMPORTED_MODULE_11__["default"].applicationCache.clearLayerInfo(e+":"+s.url),u(t)}))}))}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/actions/Adapted.js":
/*!************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/actions/Adapted.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AdaptedFeatureSet": () => (/* binding */ E),
/* harmony export */   "AdaptedField": () => (/* binding */ m),
/* harmony export */   "FieldRename": () => (/* binding */ v),
/* harmony export */   "OriginalField": () => (/* binding */ w),
/* harmony export */   "SqlExpressionAdapted": () => (/* binding */ T),
/* harmony export */   "StringToCodeAdapted": () => (/* binding */ C)
/* harmony export */ });
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../Graphic.js */ "./node_modules/@arcgis/core/Graphic.js");
/* harmony import */ var _kernel_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../kernel.js */ "./node_modules/@arcgis/core/arcade/kernel.js");
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../support/sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class m{constructor(e){this.field=e,this.sqlRewritable=!1}postInitialization(e,t){}}class w extends m{constructor(e){super(e),this.sqlRewritable=!0}extractValue(e){return e.attributes[this.field.name]}rewriteSql(e){return{rewritten:this.sqlRewritable,where:e}}}class v extends m{constructor(e,t,r){super((0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__.cloneField)(e)),this.originalField=e,this.sqlRewritable=!0,this.field.name=t,this.field.alias=r}rewriteSql(e,t){return{rewritten:this.sqlRewritable,where:(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.reformulateWithoutField)(e,this.field.name,this.originalField.name,t.getFieldsIndex())}}extractValue(e){return e.attributes[this.originalField.name]}}class C extends m{constructor(e,t,r){super(e),this.codefield=t,this.lkp=r,this.reverseLkp={};for(const s in r)this.reverseLkp[r[s]]=s;this.sqlRewritable=!0}rewriteSql(e,t){const r=this.evaluateNodeToWhereClause(e.parseTree,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__.FeatureServiceDatabaseType.Standardised,this.field.name,this.codefield instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__.WhereClause?(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.toWhereClause)(this.codefield,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__.FeatureServiceDatabaseType.Standardised):this.codefield,e.parameters);return r.indexOf(C.BADNESS)>=0?{rewritten:!1,where:e}:{rewritten:this.sqlRewritable,where:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__.WhereClause.create(r,t._parent.getFieldsIndex())}}evaluateNodeToWhereClause(e,t,r=null,s=null,a){let i,l,n,o;switch(e.type){case"interval":return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.convertIntervalToSql)(this.evaluateNodeToWhereClause(e.value,t,r,s,a),e.qualifier,e.op);case"case_expression":{let s=" CASE ";"simple"===e.format&&(s+=this.evaluateNodeToWhereClause(e.operand,t,r,C.BADNESS,a));for(let i=0;i<e.clauses.length;i++)s+=" WHEN "+this.evaluateNodeToWhereClause(e.clauses[i].operand,t,r,C.BADNESS,a)+" THEN "+this.evaluateNodeToWhereClause(e.clauses[i].value,t,r,C.BADNESS,a);return null!==e.else&&(s+=" ELSE "+this.evaluateNodeToWhereClause(e.else,t,r,C.BADNESS,a)),s+=" END ",s}case"param":{const r=a[e.value.toLowerCase()];if("string"==typeof r){return"'"+a[e.value.toLowerCase()].toString().replace(/'/g,"''")+"'"}if(r instanceof Date)return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeDateString)(r,t);if(r instanceof Array){const e=[];for(let s=0;s<r.length;s++)"string"==typeof r[s]?e.push("'"+r[s].toString().replace(/'/g,"''")+"'"):r[s]instanceof Date?e.push((0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeDateString)(r[s],t)):e.push(r[s].toString());return e}return r.toString()}case"expr_list":l=[];for(const i of e.value)l.push(this.evaluateNodeToWhereClause(i,t,r,s,a));return l;case"unary_expr":return" ( NOT "+this.evaluateNodeToWhereClause(e.expr,t,r,C.BADNESS,a)+" ) ";case"binary_expr":switch(e.operator){case"AND":return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" AND "+this.evaluateNodeToWhereClause(e.right,t,r,s,a)+") ";case"OR":return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" OR "+this.evaluateNodeToWhereClause(e.right,t,r,s,a)+") ";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IS NULL )";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IS NOT NULL )";case"IN":if(i=[],"expr_list"===e.right.type){if("column_ref"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){const i=[];let l=!0;for(const t of e.right.value){if("string"!==t.type){l=!1;break}if(void 0===this.lkp[t.value]){l=!1;break}i.push(this.lkp[t.value].toString())}if(l)return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+i.join(",")+")) "}return i=this.evaluateNodeToWhereClause(e.right,t,r,s,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+i.join(",")+")) "}return o=this.evaluateNodeToWhereClause(e.right,t,r,s,a),o instanceof Array?" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+o.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+o+")) ";case"NOT IN":if(i=[],"expr_list"===e.right.type){if("column_ref"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){const i=[];let l=!0;for(const t of e.right.value){if("string"!==t.type){l=!1;break}if(void 0===this.lkp[t.value]){l=!1;break}i.push(this.lkp[t.value].toString())}if(l)return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+i.join(",")+")) "}return i=this.evaluateNodeToWhereClause(e.right,t,r,s,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+i.join(",")+")) "}return o=this.evaluateNodeToWhereClause(e.right,t,r,s,a),o instanceof Array?" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+o.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+o+")) ";case"BETWEEN":return n=this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" BETWEEN "+n[0]+" AND "+n[1]+" ) ";case"NOTBETWEEN":return n=this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" NOT BETWEEN "+n[0]+" AND "+n[1]+" ) ";case"LIKE":return""!==e.escape?" ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)+" ESCAPE '"+e.escape+"') ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)+") ";case"NOT LIKE":return""!==e.escape?" ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" NOT LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)+" ESCAPE '"+e.escape+"') ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" NOT LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)+") ";case"<>":case"=":if("column_ref"===e.left.type&&"string"===e.right.type){if(e.left.column.toUpperCase()===this.field.name.toUpperCase()&&void 0!==this.lkp[e.right.value.toString()])return" ("+s+" "+e.operator+" "+this.lkp[e.right.value.toString()].toString()+") "}else if("column_ref"===e.right.type&&"string"===e.left.type&&e.right.column.toUpperCase()===this.field.name.toUpperCase())return" ("+this.lkp[e.right.value.toString()].toString()+" "+e.operator+" "+s+") ";return" ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" "+e.operator+" "+this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)+") ";case"<":case">":case">=":case"<=":case"*":case"-":case"+":case"/":return" ("+this.evaluateNodeToWhereClause(e.left,t,r,C.BADNESS,a)+" "+e.operator+" "+this.evaluateNodeToWhereClause(e.right,t,r,C.BADNESS,a)+") "}throw new Error("Not Supported Operator "+e.operator);case"null":return"null";case"bool":return!0===e.value?"1":"0";case"string":return"'"+e.value.toString().replace(/'/g,"''")+"'";case"timestamp":case"date":return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeDateString)(e.value,t);case"number":return e.value.toString();case"current_time":return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeToday)("date"===e.mode,t);case"column_ref":return r&&r.toLowerCase()===e.column.toLowerCase()?"("+s+")":e.column;case"function":{const s=this.evaluateNodeToWhereClause(e.args,t,r,C.BADNESS,a);return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.translateFunctionToDatabaseSpecific)(e.name,s,t)}}throw new Error("Unsupported sql syntax "+e.type)}extractValue(e){return this.codefield instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__.WhereClause?this.reverseLkp[this.codefield.calculateValueCompiled(e)]:this.reverseLkp[e.attributes[this.codefield]]}}C.BADNESS="_!!!_BAD_LKP_!!!!";class T extends m{constructor(e,t){super(e),this.sql=t}rewriteSql(e,t){return{rewritten:!0,where:(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.reformulateWithoutField)(e,this.field.name,(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.toWhereClause)(this.sql,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__.FeatureServiceDatabaseType.Standardised),t.getFieldsIndex())}}extractValue(e){return this.sql.calculateValueCompiled(e)}}class E extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]{constructor(e){super(e),this._calcFunc=null,this.declaredClass="esri.arcade.featureset.actions.Adapted",this.adaptedFields=null,this._extraFilter=null,this._extraFilter=e.extraFilter,this._parent=e.parentfeatureset,this._maxProcessing=30,this.adaptedFields=e.adaptedFields}static findField(e,t){for(const r of e)if(r.name.toLowerCase()===t.toString().toLowerCase())return r;return null}_initialiseFeatureSet(){null!==this._parent?(this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.spatialReference=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__["default"]({wkid:4326}),this.objectIdField="",this.globalIdField="",this.geometryType=_support_shared_js__WEBPACK_IMPORTED_MODULE_4__.layerGeometryEsriConstants.point,this.typeIdField="",this.types=null),this.fields=[];for(const e of this.adaptedFields)e.postInitialization(this,this._parent),this.fields.push(e.field)}_getSet(e){return null===this._wset?this._ensureLoaded().then((()=>this._extraFilter?this._getFilteredSet("",null,null,null,e):this._parent._getSet(e))).then((t=>(this._checkCancelled(e),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__["default"](t._candidates.slice(0),t._known.slice(0),t._ordered,this._clonePageDefinition(t.pagesDefinition)),this._wset))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.resolve)(this._wset)}_isInFeatureSet(e){return this._parent._isInFeatureSet(e)}_getFeatures(r,a,i,l){const n=[];-1!==a&&void 0===this._featureCache[a]&&n.push(a);const o=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(r,o))return this._expandPagedSet(r,o,0,0,l).then((()=>this._getFeatures(r,a,i,l)));let h=0;for(let e=r._lastFetchedIndex;e<r._known.length&&(h++,h<=i&&(r._lastFetchedIndex+=1),!(void 0===this._featureCache[r._known[e]]&&(r._known[e]!==a&&n.push(r._known[e]),n.length>=o)));e++);if(0===n.length)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.resolve)("success");r=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__["default"]([],n,r._ordered,null);const u=Math.min(n.length,i);return this._parent._getFeatures(r,-1,u,l).then((()=>{this._checkCancelled(l);const r=[];for(let e=0;e<u;e++){const t=this._parent._featureFromCache(n[e]);void 0!==t&&r.push({geometry:t.geometry,attributes:t.attributes,id:n[e]})}for(const s of r){const r=[];for(const e of this.adaptedFields)r[e.field.name]=e.extractValue(s);this._featureCache[s.id]=new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"]({attributes:r,geometry:(0,_kernel_js__WEBPACK_IMPORTED_MODULE_1__.cloneGeometry)(s.geometry)})}return"success"}))}_fetchAndRefineFeatures(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.reject)(new Error("Fetch and Refine should not be called in this featureset"))}_getFilteredSet(e,t,r,a,i){let l=!1;const n=this.reformulateWithoutAdaptions(r);l=n.cannot,r=n.where;let o=!1;if(null!==a){o=!0;const e=[];for(const t of this.adaptedFields)if(!(t instanceof w)&&!0===a.scanForField(t.field.name)){if(!(t instanceof v)){a=null,o=!1;break}e.push({field:t.field.name,newfield:t.originalField.name})}a&&e.length>0&&(a=a.replaceFields(e))}return null!==r?null!==this._extraFilter&&(r=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.combine)(this._extraFilter,r)):r=this._extraFilter,this._ensureLoaded().then((()=>this._parent._getFilteredSet(e,t,r,a,i))).then((e=>{let t;return this._checkCancelled(i),t=!0===l?new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__["default"](e._candidates.slice(0).concat(e._known.slice(0)),[],!0===o&&e._ordered,this._clonePageDefinition(e.pagesDefinition)):new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__["default"](e._candidates.slice(0),e._known.slice(0),!0===o&&e._ordered,this._clonePageDefinition(e.pagesDefinition)),t}))}reformulateWithoutAdaptions(e){const t={cannot:!1,where:e};if(null!==e)for(const r of this.adaptedFields)if(!0===(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.scanForField)(e,r.field.name)){const s=r.rewriteSql(e,this);if(!0!==s.rewritten){t.cannot=!0,t.where=null;break}t.where=s.where}return t}_stat(e,t,r,s,a,i,l){let n=!1,o=this.reformulateWithoutAdaptions(t);return n=o.cannot,t=o.where,o=this.reformulateWithoutAdaptions(a),n=n||o.cannot,null!==(a=o.where)?null!==this._extraFilter&&(a=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.combine)(this._extraFilter,a)):a=this._extraFilter,!0===n?null===a&&""===r&&null===s?this._manualStat(e,t,i,l):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.resolve)({calculated:!1}):this._parent._stat(e,t,r,s,a,i,l).then((n=>!1===n.calculated?null===a&&""===r&&null===s?this._manualStat(e,t,i,l):{calculated:!1}:n))}_canDoAggregates(e,t,r,s,a){if(null===this._parent)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.resolve)(!1);for(let n=0;n<e.length;n++)for(const t of this.adaptedFields)if(e[n].toLowerCase()===t.field.name.toLowerCase()&&!(t instanceof w))return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.resolve)(!1);const i=[];for(let n=0;n<t.length;n++){const e=t[n];if(null!==e.workingexpr){const t=this.reformulateWithoutAdaptions(e.workingexpr);if(t.cannot)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.resolve)(!1);const r=e.clone();r.workingexpr=t.where,i.push(r)}else i.push(e)}const l=this.reformulateWithoutAdaptions(a);return l.cannot?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.resolve)(!1):(null!==(a=l.where)?null!==this._extraFilter&&(a=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.combine)(this._extraFilter,a)):a=this._extraFilter,this._parent._canDoAggregates(e,i,r,s,a))}_getAggregatePagesDataSourceDefinition(e,t,r,s,a,i,l){if(null===this._parent)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.reject)(new Error("Should never be called"));const n=[];for(let h=0;h<t.length;h++){const e=t[h];if(null!==e.workingexpr){const t=this.reformulateWithoutAdaptions(e.workingexpr);if(t.cannot)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.reject)(new Error("Should never be called"));const r=e.clone();r.workingexpr=t.where,n.push(r)}else n.push(e)}const o=this.reformulateWithoutAdaptions(a);return o.cannot?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.reject)(new Error("Should never be called")):(null!==(a=o.where)?null!==this._extraFilter&&(a=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__.combine)(this._extraFilter,a)):a=this._extraFilter,this._parent._getAggregatePagesDataSourceDefinition(e,n,r,s,a,i,l))}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _)
/* harmony export */ });
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class _ extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__["default"]{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.actions.AttributeFilter",this._maxProcessing=1e3,this._parent=e.parentfeatureset,e.whereclause instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_5__.WhereClause?(this._whereclause=e.whereclause,this._whereClauseFunction=null):(this._whereClauseFunction=e.whereclause,this._whereclause=null)}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__["default"]({wkid:4326}),this.geometryType=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.layerGeometryEsriConstants.point)}_getSet(e){return null===this._wset?this._ensureLoaded().then((()=>this._parent._getFilteredSet("",null,this._whereclause,null,e))).then((s=>(this._checkCancelled(e),null!==this._whereClauseFunction?this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"](s._candidates.slice(0).concat(s._known.slice(0)),[],s._ordered,this._clonePageDefinition(s.pagesDefinition)):this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"](s._candidates.slice(0),s._known.slice(0),s._ordered,this._clonePageDefinition(s.pagesDefinition)),this._wset))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(this._wset)}_isInFeatureSet(e){let t=this._parent._isInFeatureSet(e);return t===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet?t:(t=this._idstates[e],void 0===t?_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.Unknown:t)}_getFeature(e,t,s){return this._parent._getFeature(e,t,s)}_getFeatures(e,t,s,i){return this._parent._getFeatures(e,t,s,i)}_featureFromCache(e){return this._parent._featureFromCache(e)}executeWhereClause(e){return this._whereclause.testFeature(e)}executeWhereClauseDeferred(e){if(null!==this._whereClauseFunction)try{const t=this._whereClauseFunction(e);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.isPromiseLike)(t)?t:(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(t)}catch(t){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.reject)(t)}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(this.executeWhereClause(e))}_fetchAndRefineFeatures(e,s,r){const n=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],e,!1,null),a=Math.min(s,e.length);return this._parent._getFeatures(n,-1,a,r).then((()=>{if(this._checkCancelled(r),null==this._whereClauseFunction){for(let t=0;t<a;t++){const s=this._parent._featureFromCache(e[t]);!0===this.executeWhereClause(s)?this._idstates[e[t]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet:this._idstates[e[t]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet}return"success"}const t=[];for(let s=0;s<a;s++){const i=this._parent._featureFromCache(e[s]);t.push(this.executeWhereClauseDeferred(i))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.all)(t).then((t=>{for(let r=0;r<s;r++)!0===t[r]?this._idstates[e[r]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet:this._idstates[e[r]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet;return"success"}))}))}_getFilteredSet(e,s,i,n,a){return null!==this._whereClauseFunction||(null!==i?null!==this._whereclause&&(i=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__.combine)(this._whereclause,i)):i=this._whereclause),this._ensureLoaded().then((()=>this._parent._getFilteredSet(e,s,i,n,a))).then((e=>{let s;return this._checkCancelled(a),s=null!==this._whereClauseFunction?new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"](e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,this._clonePageDefinition(e.pagesDefinition)):new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"](e._candidates.slice(0),e._known.slice(0),e._ordered,this._clonePageDefinition(e.pagesDefinition)),s}))}_stat(e,t,s,i,a,l,h){if(null!==this._whereClauseFunction)return null===a&&""===s&&null===i?this._manualStat(e,t,l,h):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)({calculated:!1});let u=this._whereclause;return null!==a&&null!==this._whereclause&&(u=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__.combine)(this._whereclause,a)),this._parent._stat(e,t,s,i,u,l,h).then((r=>!1===r.calculated?null===a&&""===s&&null===i?this._manualStat(e,t,l,h):{calculated:!1}:r))}_canDoAggregates(e,t,s,i,a){return null!==this._whereClauseFunction?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(!1):(null!==a?null!==this._whereclause&&(a=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__.combine)(this._whereclause,a)):a=this._whereclause,null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(!1):this._parent._canDoAggregates(e,t,s,i,a))}_getAggregatePagesDataSourceDefinition(e,t,s,i,n,a,h){return null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.reject)(new Error("Should never be called")):(null!==n?null!==this._whereclause&&(n=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__.combine)(this._whereclause,n)):n=this._whereclause,this._parent._getAggregatePagesDataSourceDefinition(e,t,s,i,n,a,h))}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__["default"]._featuresetFunctions.filter=function(e){if("function"==typeof e)return new _({parentfeatureset:this,whereclause:e});let t=null;return e instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_5__.WhereClause&&(t=e),new _({parentfeatureset:this,whereclause:t})}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/actions/GroupBy.js":
/*!************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/actions/GroupBy.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ G)
/* harmony export */ });
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../Graphic.js */ "./node_modules/@arcgis/core/Graphic.js");
/* harmony import */ var _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../chunks/languageUtils.js */ "./node_modules/@arcgis/core/chunks/languageUtils.js");
/* harmony import */ var _Adapted_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Adapted.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/Adapted.js");
/* harmony import */ var _AttributeFilter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AttributeFilter.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js");
/* harmony import */ var _OrderBy_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./OrderBy.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js");
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../support/OrderbyClause.js */ "./node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../support/sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _support_stats_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../support/stats.js */ "./node_modules/@arcgis/core/arcade/featureset/support/stats.js");
/* harmony import */ var _support_StatsField_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../support/StatsField.js */ "./node_modules/@arcgis/core/arcade/featureset/support/StatsField.js");
/* harmony import */ var _core_MD5_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../core/MD5.js */ "./node_modules/@arcgis/core/core/MD5.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../layers/support/Field.js */ "./node_modules/@arcgis/core/layers/support/Field.js");
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../layers/support/FieldsIndex.js */ "./node_modules/@arcgis/core/layers/support/FieldsIndex.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function C(e){if(!e)return"COUNT";switch(e.toLowerCase()){case"max":return"MAX";case"var":case"variance":return"VAR";case"avg":case"average":case"mean":return"AVG";case"min":return"MIN";case"sum":return"SUM";case"stdev":case"stddev":return"STDDEV";case"count":return"COUNT"}return"COUNT"}class G extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_5__["default"]{constructor(e){super(e),this._decodedStatsfield=[],this._decodedGroupbyfield=[],this._candosimplegroupby=!0,this.phsyicalgroupbyfields=[],this.objectIdField="ROW__ID",this._internalObjectIdField="ROW__ID",this._adaptedFields=[],this.declaredClass="esri.arcade.featureset.actions.Aggregate",this._uniqueIds=1,this._maxQuery=10,this._maxProcessing=10,this._parent=e.parentfeatureset,this._config=e}isTable(){return!0}_getSet(e){return null===this._wset?this._getFilteredSet("",null,null,null,e).then((e=>(this._wset=e,this._wset))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)(this._wset)}_isInFeatureSet(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_8__.IdState.InFeatureSet}nextUniqueName(e){for(;1===e["T"+this._uniqueIds.toString()];)this._uniqueIds++;const t="T"+this._uniqueIds.toString();return e[t]=1,t}convertToEsriFieldType(e){return e}_initialiseFeatureSet(){const e={};let t=!1,n=1;const r=this._parent?this._parent.getFieldsIndex():new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_17__["default"]([]);for(this.objectIdField="ROW__ID",this.globalIdField="";!1===t;){let e=!1;for(let t=0;t<this._config.groupbyfields.length;t++)if(this._config.groupbyfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}if(!1===e)for(let t=0;t<this._config.statsfields.length;t++)if(this._config.statsfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}!1===e?t=!0:(this.objectIdField="ROW__ID"+n.toString(),n++)}for(const i of this._config.statsfields){const e=new _support_StatsField_js__WEBPACK_IMPORTED_MODULE_11__["default"];e.field=i.name,e.tofieldname=i.name,e.workingexpr=i.expression instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_14__.WhereClause?i.expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_14__.WhereClause.create(i.expression,r),e.typeofstat=C(i.statistic),this._decodedStatsfield.push(e)}this._decodedGroupbyfield=[];for(const i of this._config.groupbyfields){const e={name:i.name,singlefield:null,tofieldname:i.name,expression:i.expression instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_14__.WhereClause?i.expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_14__.WhereClause.create(i.expression,r)};this._decodedGroupbyfield.push(e)}if(null!==this._parent){this.geometryType=this._parent.geometryType,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField="";for(const t of this._parent.fields)e[t.name.toUpperCase()]=1;this.types=null}else this.geometryType=_support_shared_js__WEBPACK_IMPORTED_MODULE_8__.layerGeometryEsriConstants.point,this.typeIdField="",this.types=null,this.spatialReference=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_15__["default"]({wkid:4326});this.fields=[];const a=new _support_StatsField_js__WEBPACK_IMPORTED_MODULE_11__["default"];a.field=this.nextUniqueName(e),a.tofieldname=this.objectIdField,a.workingexpr=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_14__.WhereClause.create(this._parent.objectIdField,this._parent.getFieldsIndex()),a.typeofstat="MIN",this._decodedStatsfield.push(a);for(const s of this._decodedGroupbyfield){const t=new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_16__["default"];if(s.name=this.nextUniqueName(e),t.name=s.tofieldname,t.alias=t.name,(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.isSingleField)(s.expression)){const e=this._parent.getField((0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.toWhereClause)(s.expression,_support_shared_js__WEBPACK_IMPORTED_MODULE_8__.FeatureServiceDatabaseType.Standardised));if(!e)throw new Error("Field is not present for Aggregation");s.name=e.name,s.singlefield=e.name,this.phsyicalgroupbyfields.push(e.name),t.type=e.type}else{t.type=this.convertToEsriFieldType((0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.predictType)(s.expression,this._parent.fields));const e=new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_16__["default"];e.name=s.name,e.alias=e.name,this.phsyicalgroupbyfields.push(s.name),this._adaptedFields.push(new _Adapted_js__WEBPACK_IMPORTED_MODULE_2__.SqlExpressionAdapted(e,s.expression)),this._candosimplegroupby=!1}this.fields.push(t)}if(this._adaptedFields.length>0)for(const i of this._parent.fields)this._adaptedFields.push(new _Adapted_js__WEBPACK_IMPORTED_MODULE_2__.OriginalField(i));for(let i=0;i<this._decodedStatsfield.length;i++){const t=new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_16__["default"];let s=null;const n=this._decodedStatsfield[i];n.field=this.nextUniqueName(e),n.tofieldname===this.objectIdField&&(this._internalObjectIdField=n.field),t.name=n.tofieldname,t.alias=t.name;const r=null!==n.workingexpr&&(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.isSingleField)(n.workingexpr)?(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.toWhereClause)(n.workingexpr,_support_shared_js__WEBPACK_IMPORTED_MODULE_8__.FeatureServiceDatabaseType.Standardised):"";switch(this._decodedStatsfield[i].typeofstat){case"SUM":if(""!==r){if(s=this._parent.getField(r),!s)throw new Error("Field is not present for Aggregation");t.type=s.type}else t.type="double";break;case"MIN":case"MAX":if(""!==r){if(s=this._parent.getField(r),!s)throw new Error("Field is not present for Aggregation");t.type=s.type}else t.type="double";break;case"COUNT":t.type="integer";break;case"STDDEV":case"VAR":case"AVG":if(""!==r&&(s=this._parent.getField(r),!s))throw new Error("Field is not present for Aggregation");t.type="double"}this.fields.push(t)}}_canDoAggregates(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)(!1)}_getFeatures(e,t,i,s){-1!==t&&this._featureCache[t];const n=this._maxQuery;return!0===this._checkIfNeedToExpandKnownPage(e,n)?this._expandPagedSet(e,n,0,0,s).then((()=>this._getFeatures(e,t,i,s))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)("success")}_getFilteredSet(e,t,i,s,l){if(""!==e)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)(new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__["default"]([],[],!0,null));let u=null;const f={ordered:!1,nowhereclause:!1};return this._ensureLoaded().then((()=>{if(null!==i)for(let e=0;e<this._decodedStatsfield.length;e++)if(!0===(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.scanForField)(i,this._decodedStatsfield[e].tofieldname)){f.nowhereclause=!0,i=null;break}if(null!==s){f.ordered=!0;for(let e=0;e<this._decodedStatsfield.length;e++)if(!0===s.scanForField(this._decodedStatsfield[e].tofieldname)){s=null,f.ordered=!1;break}if(null!==s)for(const e of this._decodedGroupbyfield)if(null===e.singlefield&&!0===s.scanForField(e.tofieldname)){s=null,f.ordered=!1;break}}return!1===this._candosimplegroupby?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)(!1):this._parent._canDoAggregates(this.phsyicalgroupbyfields,this._decodedStatsfield,"",null,null)})).then((e=>{if(e){let e=null;i&&(e=this._reformulateWhereClauseWithoutGroupByFields(i));let t=null;return s&&(t=this._reformulateOrderClauseWithoutGroupByFields(s)),this._parent._getAggregatePagesDataSourceDefinition(this.phsyicalgroupbyfields,this._decodedStatsfield,"",null,e,t,this._internalObjectIdField).then((e=>(this._checkCancelled(l),u=!0===f.nowhereclause?new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__["default"](e._candidates.slice(0).concat(e._known.slice(0)),[],!0===f.ordered&&e._ordered,this._clonePageDefinition(e.pagesDefinition)):new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__["default"](e._candidates.slice(0),e._known.slice(0),!0===f.ordered&&e._ordered,this._clonePageDefinition(e.pagesDefinition)),u)))}let t=this._parent;if(this._adaptedFields.length>0&&(t=new _Adapted_js__WEBPACK_IMPORTED_MODULE_2__.AdaptedFeatureSet({parentfeatureset:this._parent,adaptedFields:this._adaptedFields,extraFilter:null})),!0===f.nowhereclause)u=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__["default"](["GETPAGES"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:"manual",iterator:null,set:[],subfeatureset:new _OrderBy_js__WEBPACK_IMPORTED_MODULE_4__["default"]({parentfeatureset:t,orderbyclause:new _support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_7__["default"](this.phsyicalgroupbyfields.join(",")+","+this._parent.objectIdField+" ASC")})}});else{let e=t;if(null!==i){let t=null;i&&(t=this._reformulateWhereClauseWithoutGroupByFields(i)),e=new _AttributeFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]({parentfeatureset:e,whereclause:t})}u=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__["default"](["GETPAGES"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:"manual",iterator:null,set:[],subfeatureset:new _OrderBy_js__WEBPACK_IMPORTED_MODULE_4__["default"]({parentfeatureset:e,orderbyclause:new _support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_7__["default"](this.phsyicalgroupbyfields.join(",")+","+this._parent.objectIdField+" ASC")})}})}return u}))}_reformulateWhereClauseWithoutStatsFields(e){for(const t of this._decodedStatsfield)e=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.reformulateWithoutField)(e,t.tofieldname,(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.toWhereClause)(t.workingexpr,_support_shared_js__WEBPACK_IMPORTED_MODULE_8__.FeatureServiceDatabaseType.Standardised),this._parent.getFieldsIndex());return e}_reformulateWhereClauseWithoutGroupByFields(e){for(const t of this._decodedGroupbyfield)t.tofieldname!==t.name&&(e=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.reformulateWithoutField)(e,t.tofieldname,(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_9__.toWhereClause)(t.expression,_support_shared_js__WEBPACK_IMPORTED_MODULE_8__.FeatureServiceDatabaseType.Standardised),this._parent.getFieldsIndex()));return e}_reformulateOrderClauseWithoutGroupByFields(e){const t=[];for(const i of this._decodedGroupbyfield)i.tofieldname!==i.name&&t.push({field:i.tofieldname,newfield:i.name});return t.length>0?e.replaceFields(t):e}_clonePageDefinition(e){return null===e?null:!0===e.aggregatefeaturesetpagedefinition?{aggregatefeaturesetpagedefinition:!0,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,internal:e.internal}:this._parent._clonePageDefinition(e)}_refineSetBlock(e,t,i){try{if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQuery))return this._expandPagedSet(e,this._maxQuery,0,0,i).then((()=>this._refineSetBlock(e,t,i)));this._checkCancelled(i);const s=e._candidates.length;this._refineKnowns(e,t);e._candidates.length;return e._candidates.length,(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)(e)}catch(s){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.reject)(s)}}_expandPagedSet(e,t,i,s,n){return this._expandPagedSetFeatureSet(e,t,i,s,n)}_getPhysicalPage(t,i,s){return!0===t.pagesDefinition.aggregatefeaturesetpagedefinition?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.create)(((e,i)=>{this._sequentialGetPhysicalItem(t,t.pagesDefinition.resultRecordCount,s,[]).then((t=>{e(t)}),i)})):this._getAgregagtePhysicalPage(t,i,s).then((t=>{for(const i of t){const t={geometry:i.geometry,attributes:{}};for(const e of this._decodedGroupbyfield)t.attributes[e.tofieldname]=i.attributes[e.name];for(const e of this._decodedStatsfield)t.attributes[e.tofieldname]=i.attributes[e.field];this._featureCache[t.attributes[this.objectIdField]]=new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"](t)}return t.length}))}_sequentialGetPhysicalItem(e,t,i,s){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.create)(((n,r)=>{null===e.pagesDefinition.internal.iterator&&(e.pagesDefinition.internal.iterator=e.pagesDefinition.internal.subfeatureset.iterator(i)),!0===e.pagesDefinition.internal.fullyResolved||0===t?n(s.length):this._nextAggregateItem(e,t,i,s,(r=>{null===r?n(s.length):(t-=1,n(this._sequentialGetPhysicalItem(e,t,i,s)))}),r)}))}_nextAggregateItem(e,i,s,n,r,a){try{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_1__.U)(e.pagesDefinition.internal.iterator.next()).then((t=>{if(null===t)if(null!==e.pagesDefinition.internal.workingItem){const t=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);n.push(t),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(t.attributes[this.objectIdField]),e.pagesDefinition.internal.fullyResolved=!0,r(null)}else e.pagesDefinition.internal.fullyResolved=!0,r(null);else{const l=this._generateAggregateHash(t);if(null===e.pagesDefinition.internal.workingItem)e.pagesDefinition.internal.workingItem={features:[t],id:l};else{if(l!==e.pagesDefinition.internal.workingItem.id){const s=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);return n.push(s),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(s.attributes[this.objectIdField]),i-=1,e.pagesDefinition.internal.workingItem={features:[t],id:l},void r(s)}e.pagesDefinition.internal.workingItem.features.push(t)}this._nextAggregateItem(e,i,s,n,r,a)}}),a)}catch(l){a(l)}}_calculateFieldStat(e,t,i){const s=[];for(let n=0;n<e.features.length;n++)if(null!==t.workingexpr){const i=t.workingexpr.calculateValue(e.features[n]);null!==i&&s.push(i)}else s.push(null);switch(t.typeofstat){case"MIN":i.attributes[t.tofieldname]=(0,_support_stats_js__WEBPACK_IMPORTED_MODULE_10__.calculateStat)("min",s,-1);break;case"MAX":i.attributes[t.tofieldname]=(0,_support_stats_js__WEBPACK_IMPORTED_MODULE_10__.calculateStat)("max",s,-1);break;case"SUM":i.attributes[t.tofieldname]=(0,_support_stats_js__WEBPACK_IMPORTED_MODULE_10__.calculateStat)("sum",s,-1);break;case"COUNT":i.attributes[t.tofieldname]=s.length;break;case"VAR":i.attributes[t.tofieldname]=(0,_support_stats_js__WEBPACK_IMPORTED_MODULE_10__.calculateStat)("var",s,-1);break;case"STDDEV":i.attributes[t.tofieldname]=(0,_support_stats_js__WEBPACK_IMPORTED_MODULE_10__.calculateStat)("stddev",s,-1);break;case"AVG":i.attributes[t.tofieldname]=(0,_support_stats_js__WEBPACK_IMPORTED_MODULE_10__.calculateStat)("avg",s,-1)}return!0}_calculateAndAppendAggregateItem(t){const i={attributes:{},geometry:null};for(const e of this._decodedGroupbyfield){const s=e.singlefield?t.features[0].attributes[e.singlefield]:e.expression.calculateValue(t.features[0]);i.attributes[e.tofieldname]=s}for(const e of this._decodedStatsfield)this._calculateFieldStat(t,e,i);const s=[];for(let e=0;e<this._decodedStatsfield.length;e++)s.push(this._calculateFieldStat(t,this._decodedStatsfield[e],i));return this._featureCache[i.attributes[this.objectIdField]]=new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"]({attributes:i.attributes,geometry:i.geometry}),i}_generateAggregateHash(e){let t="";for(const i of this._decodedGroupbyfield){const s=i.singlefield?e.attributes[i.singlefield]:i.expression.calculateValue(e);t+=null==s?":":":"+s.toString()}return (0,_core_MD5_js__WEBPACK_IMPORTED_MODULE_12__.createMD5Hash)(t,_core_MD5_js__WEBPACK_IMPORTED_MODULE_12__.outputTypes.String)}_stat(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)({calculated:!1})}getFeatureByObjectId(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_13__.resolve)(null)}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_5__["default"]._featuresetFunctions.groupby=function(e,t){return new G({parentfeatureset:this,groupbyfields:e,statsfields:t})}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js":
/*!************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/languageUtils.js */ "./node_modules/@arcgis/core/chunks/languageUtils.js");
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/OrderbyClause.js */ "./node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]{constructor(e){super(e),this._orderbyclause=null,this.declaredClass="esri.arcade.featureset.actions.OrderBy",this._maxProcessing=100,this._orderbyclause=e.orderbyclause,this._parent=e.parentfeatureset}_getSet(e){return null===this._wset?this._ensureLoaded().then((()=>this._getFilteredSet("",null,null,this._orderbyclause,e))).then((t=>(this._checkCancelled(e),this._wset=t,this._wset))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(this._wset)}manualOrderSet(e,t){return this.getIdColumnDictionary(e,[],-1,t).then((e=>{this._orderbyclause.order(e);const t=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[],!0,null);for(let r=0;r<e.length;r++)t._known.push(e[r].id);return t}))}getIdColumnDictionary(t,r,n,i){if(n<t._known.length-1){const s=this._maxQueryRate();if("GETPAGES"===t._known[n+1])return (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__.U)(this._parent._expandPagedSet(t,s,0,0,i)).then((()=>this.getIdColumnDictionary(t,r,n,i)));let a=n+1;const o=[];for(;a<t._known.length&&"GETPAGES"!==t._known[a];)o.push(t._known[a]),a++;return n+=o.length,(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__.U)(this._parent._getFeatureBatch(o,i)).then((e=>{this._checkCancelled(i);for(const t of e)r.push({id:t.attributes[this.objectIdField],feature:t});return this.getIdColumnDictionary(t,r,n,i)}))}return t._candidates.length>0?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__.U)(this._refineSetBlock(t,this._maxProcessingRate(),i)).then((()=>(this._checkCancelled(i),this.getIdColumnDictionary(t,r,n,i)))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(r)}_isInFeatureSet(e){return this._parent._isInFeatureSet(e)}_getFeatures(e,t,r,n){return this._parent._getFeatures(e,t,r,n)}_featureFromCache(e){if(void 0===this._featureCache[e]){const t=this._parent._featureFromCache(e);if(void 0===t)return;return null===t?null:(this._featureCache[e]=t,t)}return this._featureCache[e]}_fetchAndRefineFeatures(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.reject)(new Error("Fetch and Refine should not be called in this featureset"))}_getFilteredSet(e,t,n,s,i){return this._ensureLoaded().then((()=>this._parent._getFilteredSet(e,t,n,null===s?this._orderbyclause:s,i))).then((e=>{this._checkCancelled(i);const s=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"](e._candidates.slice(0),e._known.slice(0),e._ordered,this._clonePageDefinition(e.pagesDefinition));let a=!0;return e._candidates.length>0&&(a=!1),!1===s._ordered?this.manualOrderSet(s,i).then((e=>(!1===a&&(null===t&&null===n||(e=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"](e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,this._clonePageDefinition(e.pagesDefinition)))),e))):s}))}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.orderBy=function(e){return""===e?this:new a({parentfeatureset:this,orderbyclause:new _support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_3__["default"](e)})}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/actions/SpatialFilter.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/actions/SpatialFilter.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ g)
/* harmony export */ });
/* harmony import */ var _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sources/Empty.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/Empty.js");
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../geometry/geometryEngineAsync.js */ "./node_modules/@arcgis/core/geometry/geometryEngineAsync.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class g extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]{constructor(e){super(e),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=e.relationString,this._parent=e.parentfeatureset,this._maxProcessing=40,this._relation=e.relation,this._relationGeom=e.relationGeom}_getSet(e){return null===this._wset?this._ensureLoaded().then((()=>this._parent._getFilteredSet("esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,null,null,e))).then((t=>(this._checkCancelled(e),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"](t._candidates.slice(0),t._known.slice(0),t._ordered,this._clonePageDefinition(t.pagesDefinition)),this._wset))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(this._wset)}_isInFeatureSet(e){let t=this._parent._isInFeatureSet(e);return t===_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.IdState.NotInFeatureSet?t:(t=this._idstates[e],void 0===t?_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.IdState.Unknown:t)}_getFeature(e,t,r){return this._parent._getFeature(e,t,r)}_getFeatures(e,t,r,i){return this._parent._getFeatures(e,t,r,i)}_featureFromCache(e){return this._parent._featureFromCache(e)}executeSpatialRelationTest(e){if(null===e.geometry)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(!1);switch(this._relation){case"esriSpatialRelEnvelopeIntersects":{const t=(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.shapeExtent)(this._relationGeom),r=(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.shapeExtent)(e.geometry);return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.intersects)(t,r)}case"esriSpatialRelIntersects":return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.intersects)(this._relationGeom,e.geometry);case"esriSpatialRelContains":return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.contains)(this._relationGeom,e.geometry);case"esriSpatialRelOverlaps":return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.overlaps)(this._relationGeom,e.geometry);case"esriSpatialRelWithin":return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.within)(this._relationGeom,e.geometry);case"esriSpatialRelTouches":return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.touches)(this._relationGeom,e.geometry);case"esriSpatialRelCrosses":return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.crosses)(this._relationGeom,e.geometry);case"esriSpatialRelRelation":return (0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_5__.relate)(this._relationGeom,e.geometry,this._relationString)}}_fetchAndRefineFeatures(e,t,n){const a=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],e,!1,null),l=Math.min(t,e.length);return this._parent._getFeatures(a,-1,l,n).then((()=>{this._checkCancelled(n);const t=[];for(let r=0;r<l;r++){const i=this._parent._featureFromCache(e[r]);t.push(this.executeSpatialRelationTest(i))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.all)(t)})).then((r=>{for(let n=0;n<t;n++)!0===r[n]?this._idstates[e[n]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.IdState.InFeatureSet:this._idstates[e[n]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.IdState.NotInFeatureSet;return"success"}))}_getFilteredSet(e,t,i,n,a){return this._ensureLoaded().then((()=>this._parent._getFilteredSet("esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,i,n,a))).then((e=>{let i;return this._checkCancelled(a),i=null!==t?new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"](e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,this._clonePageDefinition(e.pagesDefinition)):new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"](e._candidates.slice(0),e._known.slice(0),e._ordered,this._clonePageDefinition(e.pagesDefinition)),i}))}_stat(e,t,r,i,n,s,l){return""!==r?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)({calculated:!1}):this._parent._stat(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,n,s,l).then((a=>!1===a.calculated?null===n&&""===r&&null===i?this._manualStat(e,t,s,l):{calculated:!1}:a))}_canDoAggregates(e,t,r,i,n){return""!==r||null!==i||null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(!1):this._parent._canDoAggregates(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,n)}_getAggregatePagesDataSourceDefinition(e,t,r,i,n,a,s){return null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.reject)(new Error("Should never be called")):this._parent._getAggregatePagesDataSourceDefinition(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,n,a,s)}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.intersects=function(t){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:t})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.envelopeIntersects=function(t){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:t})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.contains=function(t){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:t})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.overlaps=function(t){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:t})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.within=function(t){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:t})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.touches=function(t){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:t})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.crosses=function(t){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:t})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]._featuresetFunctions.relate=function(t,r){return null==t?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_0__["default"]({parentfeatureset:this}):new g({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:t,relationString:r})}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/actions/Top.js":
/*!********************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/actions/Top.js ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__["default"]{constructor(t){super(t),this._topnum=0,this.declaredClass="esri.arcade.featureset.actions.Top",this._countedin=0,this._maxProcessing=100,this._topnum=t.topnum,this._parent=t.parentfeatureset}_getSet(t){return null===this._wset?this._ensureLoaded().then((()=>this._parent._getSet(t))).then((t=>(this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"](t._candidates.slice(0),t._known.slice(0),!1,this._clonePageDefinition(t.pagesDefinition)),this._setKnownLength(this._wset)>this._topnum&&(this._wset._known=this._wset._known.slice(0,this._topnum)),this._setKnownLength(this._wset)>=this._topnum&&(this._wset._candidates=[]),this._wset))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)(this._wset)}_setKnownLength(t){return t._known.length>0&&"GETPAGES"===t._known[t._known.length-1]?t._known.length-1:t._known.length}_isInFeatureSet(t){const e=this._parent._isInFeatureSet(t);if(e===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet)return e;const s=this._idstates[t];return s===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet||s===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet?s:e===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet&&void 0===s?this._countedin<this._topnum?(this._idstates[t]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet,this._countedin++,_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet):(this._idstates[t]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet,_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet):_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.Unknown}_expandPagedSet(t,e,n,a,r){if(null===this._parent)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.reject)(new Error("Parent Paging not implemented"));if(e>this._topnum&&(e=this._topnum),this._countedin>=this._topnum&&t.pagesDefinition.internal.set.length<=t.pagesDefinition.resultOffset){let e=t._known.length;return e>0&&"GETPAGES"===t._known[e-1]&&(t._known.length=e-1),e=t._candidates.length,e>0&&"GETPAGES"===t._candidates[e-1]&&(t._candidates.length=e-1),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)("success")}return this._parent._expandPagedSet(t,e,n,a,r).then((e=>(this._setKnownLength(t)>this._topnum&&(t._known.length=this._topnum),this._setKnownLength(t)>=this._topnum&&(t._candidates.length=0),e)))}_getFeatures(t,n,i,a){const r=[],o=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(t,o))return this._expandPagedSet(t,o,0,0,a).then((()=>this._getFeatures(t,n,i,a)));-1!==n&&void 0===this._featureCache[n]&&r.push(n);let _=0;for(let e=t._lastFetchedIndex;e<t._known.length&&(_++,_<=i&&(t._lastFetchedIndex+=1),!(void 0===this._featureCache[t._known[e]]&&(t._known[e]!==n&&r.push(t._known[e]),r.length>o)));e++);if(0===r.length)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)("success");const h=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],r,!1,null),u=Math.min(r.length,i);return this._parent._getFeatures(h,-1,u,a).then((()=>{for(let t=0;t<u;t++){const e=this._parent._featureFromCache(r[t]);void 0!==e&&(this._featureCache[r[t]]=e)}return"success"}))}_getFilteredSet(t,n,s,i,a){return this._ensureLoaded().then((()=>this._getSet(a))).then((t=>new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"](t._candidates.slice(0).concat(t._known.slice(0)),[],!1,this._clonePageDefinition(t.pagesDefinition))))}_refineKnowns(t,e){let s=0,i=null;const a=[];for(let r=0;r<t._candidates.length;r++){const o=this._isInFeatureSet(t._candidates[r]);if(o===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet){if(t._known.push(t._candidates[r]),s+=1,null===i?i={start:r,end:r}:i.end===r-1?i.end=r:(a.push(i),i={start:r,end:r}),t._known.length>=this._topnum)break}else if(o===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet)null===i?i={start:r,end:r}:i.end===r-1?i.end=r:(a.push(i),i={start:r,end:r}),s+=1;else if(o===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.Unknown)break;if(s>=e)break}null!==i&&a.push(i);for(let n=a.length-1;n>=0;n--)t._candidates.splice(a[n].start,a[n].end-a[n].start+1);this._setKnownLength(t)>this._topnum&&(t._known=t._known.slice(0,this._topnum)),this._setKnownLength(t)>=this._topnum&&(t._candidates=[])}_stat(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)({calculated:!1})}_canDoAggregates(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)(!1)}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__["default"]._featuresetFunctions.top=function(t){return new a({parentfeatureset:this,topnum:t})}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/sources/Empty.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/sources/Empty.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ n)
/* harmony export */ });
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class n extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_0__["default"]{constructor(e){super(e),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],[],!1,null),this._parent=e.parentfeatureset,this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__.FeatureServiceDatabaseType.Standardised}_getSet(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)(this._wset)}optimisePagingFeatureQueries(){}_isInFeatureSet(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet}_getFeature(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.reject)(new Error("No Feature Found in EmptySet"))}queryAttachments(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)([])}_getFeatures(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)("success")}_featureFromCache(){return null}_fetchAndRefineFeatures(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.reject)(new Error("Fetch and Refine should not be called in this featureset"))}_getFilteredSet(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)(new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],[],!1,null))}_stat(e,t,r,s,a,u,n){return this._manualStat(e,t,u,n)}_canDoAggregates(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.resolve)(!1)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerDynamic.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerDynamic.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ v)
/* harmony export */ });
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../Graphic.js */ "./node_modules/@arcgis/core/Graphic.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _Attachment_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../Attachment.js */ "./node_modules/@arcgis/core/arcade/Attachment.js");
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../support/sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _support_stats_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../support/stats.js */ "./node_modules/@arcgis/core/arcade/featureset/support/stats.js");
/* harmony import */ var _core_MD5_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/MD5.js */ "./node_modules/@arcgis/core/core/MD5.js");
/* harmony import */ var _kernel_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../kernel.js */ "./node_modules/@arcgis/core/kernel.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../geometry/support/jsonUtils.js */ "./node_modules/@arcgis/core/geometry/support/jsonUtils.js");
/* harmony import */ var _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../layers/FeatureLayer.js */ "./node_modules/@arcgis/core/layers/FeatureLayer.js");
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../layers/graphics/featureConversionUtils.js */ "./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js");
/* harmony import */ var _rest_query_operations_pbfOptimizedFeatureSet_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../rest/query/operations/pbfOptimizedFeatureSet.js */ "./node_modules/@arcgis/core/rest/query/operations/pbfOptimizedFeatureSet.js");
/* harmony import */ var _rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../rest/support/FeatureSet.js */ "./node_modules/@arcgis/core/rest/support/FeatureSet.js");
/* harmony import */ var _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../rest/support/Query.js */ "./node_modules/@arcgis/core/rest/support/Query.js");
/* harmony import */ var _rest_support_StatisticDefinition_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../rest/support/StatisticDefinition.js */ "./node_modules/@arcgis/core/rest/support/StatisticDefinition.js");
/* harmony import */ var _tasks_QueryTask_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../tasks/QueryTask.js */ "./node_modules/@arcgis/core/tasks/QueryTask.js");
/* harmony import */ var _rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../rest/query/operations/query.js */ "./node_modules/@arcgis/core/rest/query/operations/query.js");
/* harmony import */ var _Dictionary_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../Dictionary.js */ "./node_modules/@arcgis/core/arcade/Dictionary.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class v extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__["default"]{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.sources.FeatureLayerDynamic",this._removeGeometry=!1,this._overrideFields=null,this.formulaCredential=null,this._pageJustIds=!1,this._requestStandardised=!1,this._useDefinitionExpression=!0,e.spatialReference&&(this.spatialReference=e.spatialReference),this._transparent=!0,this._maxProcessing=1e3,this._layer=e.layer,this._wset=null,void 0!==e.outFields&&(this._overrideFields=e.outFields),void 0!==e.includeGeometry&&(this._removeGeometry=!1===e.includeGeometry)}_maxQueryRate(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_5__.defaultMaxRecords}end(){return this._layer}optimisePagingFeatureQueries(e){this._pageJustIds=e}convertQueryToLruCacheKey(e){const t=(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_5__.stableStringify)(e.toJSON());return (0,_core_MD5_js__WEBPACK_IMPORTED_MODULE_8__.createMD5Hash)(t,_core_MD5_js__WEBPACK_IMPORTED_MODULE_8__.outputTypes.String)}load(){return null===this._loadPromise&&(this._loadPromise=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.create)(((e,t)=>{try{if(!0===this._layer.loaded)return this._initialiseFeatureSet(),void e(this);this._layer.when().then((()=>{try{this._initialiseFeatureSet(),e(this)}catch(i){t(i)}}),t),this._layer.load()}catch(i){t(i)}}))),this._loadPromise}_initialiseFeatureSet(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType,this.fields=this._layer.fields.slice(0),this._layer.outFields)if(1===this._layer.outFields.length&&"*"===this._layer.outFields[0]);else{const e=[];for(const t of this.fields)if("oid"===t.type)e.push(t);else for(const i of this._layer.outFields)if(i.toLowerCase()===t.name.toLowerCase()){e.push(t);break}this.fields=e}else;if(null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{const e=[],t=[];for(const i of this.fields)if("oid"===i.type)e.push(i),t.push(i.name);else for(const r of this._overrideFields)if(r.toLowerCase()===i.name.toLowerCase()){e.push(i),t.push(i.name);break}this.fields=e,this._overrideFields=t}if(this._layer.source&&this._layer.source.sourceJSON){const e=this._layer.source.sourceJSON.currentVersion;!0===this._layer.source.sourceJSON.useStandardizedQueries?(this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_5__.FeatureServiceDatabaseType.StandardisedNoInterval,null!=e&&e>=10.61&&(this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_5__.FeatureServiceDatabaseType.Standardised)):null!=e&&(e>=10.5&&(this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_5__.FeatureServiceDatabaseType.StandardisedNoInterval,this._requestStandardised=!0),e>=10.61&&(this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_5__.FeatureServiceDatabaseType.Standardised))}this.objectIdField=this._layer.objectIdField;for(const e of this.fields)"global-id"===e.type&&(this.globalIdField=e.name);this.hasM=this._layer.supportsM,this.hasZ=this._layer.supportsZ,this.typeIdField=this._layer.typeIdField,this.types=this._layer.types}_isInFeatureSet(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_5__.IdState.InFeatureSet}_refineSetBlock(e){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.resolve)(e)}_candidateIdTransform(e){return e}_getSet(e){return null===this._wset?this._ensureLoaded().then((()=>this._getFilteredSet("",null,null,null,e))).then((e=>(this._wset=e,e))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.resolve)(this._wset)}_runDatabaseProbe(e){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.create)(((t,i)=>{try{this._ensureLoaded().then((()=>{try{const r=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];r.where=e.replace("OBJECTID",this._layer.objectIdField),this._layer.queryObjectIds(r).then((()=>{t(!0)}),(()=>{try{t(!1)}catch(e){i(e)}}))}catch(r){i(r)}}))}catch(r){i(r)}}))}_canUsePagination(){return!(!this._layer.capabilities||!this._layer.capabilities.query||!0!==this._layer.capabilities.query.supportsPagination)}_cacheableFeatureSetSourceKey(){return this._layer.url}pbfSupportedForQuery(e){return!e.outStatistics&&this._layer&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsFormatPBF&&!0===this._layer.capabilities.query.supportsQuantizationEditMode}queryPBF(e){return e.quantizationParameters={mode:"edit"},(0,_rest_query_operations_query_js__WEBPACK_IMPORTED_MODULE_19__.executeQueryPBF)(this._layer.parsedUrl,e,new _rest_query_operations_pbfOptimizedFeatureSet_js__WEBPACK_IMPORTED_MODULE_14__.OptimizedFeatureSetParserContext({})).then((e=>_rest_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_15__["default"].fromJSON((0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_13__.convertToFeatureSet)(e.data)).unquantize()))}get gdbVersion(){return this._layer&&this._layer.capabilities&&this._layer.capabilities.data&&this._layer.capabilities.data.isVersioned?this._layer.gdbVersion?this._layer.gdbVersion:"SDE.DEFAULT":""}nativeCapabilities(){return{title:this._layer.title,source:this,canQueryRelated:!0,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:this._requestStandardised}}executeQuery(e,t){const i=new _tasks_QueryTask_js__WEBPACK_IMPORTED_MODULE_18__["default"]({url:this._layer.parsedUrl.path}),r="execute"===t&&this.pbfSupportedForQuery(e);let s=null;if(this.recentlyUsedQueries){const a=this.convertQueryToLruCacheKey(e);s=this.recentlyUsedQueries.getFromCache(a),null===s&&(s=!0!==r?i[t](e):this.queryPBF(e),this.recentlyUsedQueries.addToCache(a,s),s=s.catch((e=>{throw this.recentlyUsedQueries.removeFromCache(a),e})))}return this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:e,method:t}),null===s&&(s=!0!==r?i[t](e):this.queryPBF(e)),s}_getFilteredSet(e,t,i,r,a){return this.databaseType().then((n=>{if(this.isTable()&&t&&null!==e&&""!==e){return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_4__["default"]([],[],!0,null)}if(this._canUsePagination())return this._getFilteredSetUsingPaging(e,t,i,r,a);let l="",o=!1;null!==r&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(l=r.constructClause(),o=!0);const u=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];return u.where=null===i?null===t?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(i,n),this._requestStandardised&&(u.sqlFormat="standard"),u.spatialRelationship=this._makeRelationshipEnum(e),u.outSpatialReference=this.spatialReference,u.orderByFields=""!==l?l.split(","):null,u.geometry=null===t?null:t,u.relationParameter=this._makeRelationshipParam(e),this.executeQuery(u,"executeForIds").then((e=>{null===e&&(e=[]),this._checkCancelled(a);return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_4__["default"]([],e,o,null)}))}))}_expandPagedSet(e,t,i,r,s){return this._expandPagedSetFeatureSet(e,t,i,r,s)}_getFilteredSetUsingPaging(e,t,i,r,a){try{let n="",l=!1;return null!==r&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(n=r.constructClause(),l=!0),this.databaseType().then((r=>{let o=null===i?null===t?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(i,r);this._layer.definitionExpression&&this._useDefinitionExpression&&(o=""!==o?"(("+this._layer.definitionExpression+") AND ("+o+"))":this._layer.definitionExpression);let u=this._maxQueryRate();const h=this._layer.capabilities.query.maxRecordCount;void 0!==h&&h<u&&(u=h);let c=null;if(!0===this._pageJustIds)c=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_4__["default"]([],["GETPAGES"],l,{spatialRel:this._makeRelationshipEnum(e),relationParam:this._makeRelationshipParam(e),outFields:this._layer.objectIdField,resultRecordCount:u,resultOffset:0,geometry:null===t?null:t,where:o,orderByFields:n,returnGeometry:!1,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}});else{let i=!0;!0===this._removeGeometry&&(i=!1);const r=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._layer.outFields?this._layer.outFields:["*"]);c=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_4__["default"]([],["GETPAGES"],l,{spatialRel:this._makeRelationshipEnum(e),relationParam:this._makeRelationshipParam(e),outFields:r.join(","),resultRecordCount:u,resultOffset:0,geometry:null===t?null:t,where:o,orderByFields:n,returnGeometry:i,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})}return this._expandPagedSet(c,u,0,1,a).then((()=>c))}))}catch(n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(n)}}_clonePageDefinition(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}}_getPhysicalPage(e,t,i){try{const t=e.pagesDefinition.internal.lastRetrieved,r=t,s=e.pagesDefinition.internal.lastPage,a=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];return this._requestStandardised&&(a.sqlFormat="standard"),a.spatialRelationship=e.pagesDefinition.spatialRel,a.relationParameter=e.pagesDefinition.relationParam,a.outFields=e.pagesDefinition.outFields.split(","),a.num=e.pagesDefinition.resultRecordCount,a.start=e.pagesDefinition.internal.lastPage,a.geometry=e.pagesDefinition.geometry,a.where=e.pagesDefinition.where,a.orderByFields=""!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(","):null,a.returnGeometry=e.pagesDefinition.returnGeometry,a.outSpatialReference=this.spatialReference,this.executeQuery(a,"execute").then((a=>{if(this._checkCancelled(i),e.pagesDefinition.internal.lastPage!==s)return"done";for(let t=0;t<a.features.length;t++)e.pagesDefinition.internal.set[r+t]=a.features[t].attributes[this._layer.objectIdField];if(!1===this._pageJustIds)for(let e=0;e<a.features.length;e++)this._featureCache[a.features[e].attributes[this._layer.objectIdField]]=a.features[e];return(void 0===a.exceededTransferLimit&&a.features.length!==e.pagesDefinition.resultRecordCount||!1===a.exceededTransferLimit)&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=t+a.features.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,"done"}))}catch(r){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(r)}}_fieldsIncludingObjectId(e){if(null===e)return[this.objectIdField];const t=e.slice(0);if(t.indexOf("*")>-1)return t;let i=!1;for(const r of t)if(r.toUpperCase()===this.objectIdField.toUpperCase()){i=!0;break}return!1===i&&t.push(this.objectIdField),t}_getFeatures(e,t,i,r){const s=[];try{if(-1!==t&&void 0===this._featureCache[t]&&s.push(t),!0===this._checkIfNeedToExpandKnownPage(e,this._maxProcessingRate()))return this._expandPagedSet(e,this._maxProcessingRate(),0,0,r).then((()=>this._getFeatures(e,t,i,r)));let n=0;for(let r=e._lastFetchedIndex;r<e._known.length;r++){if(e._lastFetchedIndex+=1,n++,void 0===this._featureCache[e._known[r]]){let i=!1;if(null!==this._layer._mode&&void 0!==this._layer._mode){const t=this._layer._mode;if(void 0!==t._featureMap[e._known[r]]){const s=t._featureMap[e._known[r]];null!==s&&(i=!0,this._featureCache[e._known[r]]=s)}}if(!1===i&&(e._known[r]!==t&&s.push(e._known[r]),s.length>=this._maxProcessingRate()-1))break}if(n>=i&&0===s.length)break}if(0===s.length)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.resolve)("success");try{const e=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];return this._requestStandardised&&(e.sqlFormat="standard"),e.objectIds=s,e.outFields=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._layer.outFields?this._layer.outFields:["*"]),e.returnGeometry=!0,!0===this._removeGeometry&&(e.returnGeometry=!1),e.outSpatialReference=this.spatialReference,this.executeQuery(e,"execute").then((e=>{if(this._checkCancelled(r),void 0!==e.error)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(new Error(e.error));for(let t=0;t<e.features.length;t++)this._featureCache[e.features[t].attributes[this._layer.objectIdField]]=e.features[t];return"success"}))}catch(a){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(a)}}catch(a){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(a)}}_getDistinctPages(e,t,i,r,s,a,n,l,o){return this._ensureLoaded().then((()=>this.databaseType())).then((u=>{let h=i.parseTree.column;for(let e=0;e<this._layer.fields.length;e++)if(this._layer.fields[e].name.toLowerCase()===h.toLowerCase()){h=this._layer.fields[e].name;break}const c=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];this._requestStandardised&&(c.sqlFormat="standard");let p=null===a?null===s?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(a,u);return this._layer.definitionExpression&&this._useDefinitionExpression&&(p=""!==p?"(("+this._layer.definitionExpression+") AND ("+p+"))":this._layer.definitionExpression),c.where=p,c.spatialRelationship=this._makeRelationshipEnum(r),c.relationParameter=this._makeRelationshipParam(r),c.geometry=null===s?null:s,c.returnDistinctValues=!0,c.returnGeometry=!1,c.outFields=[h],this.executeQuery(c,"execute").then((u=>{if(this._checkCancelled(o),!u.hasOwnProperty("features"))return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(new Error("Unnexected Result querying statistics from layer"));let d=!1;for(let e=0;e<this._layer.fields.length;e++)if(this._layer.fields[e].name===h){"date"===this._layer.fields[e].type&&(d=!0);break}for(let e=0;e<u.features.length;e++){if(d){const t=u.features[e].attributes[h];null!==t?l.push(new Date(t)):l.push(t)}else l.push(u.features[e].attributes[h]);if(l.length>=n)break}return 0===u.features.length?l:u.features.length===this._layer.capabilities.query.maxRecordCount&&l.length<n?this._getDistinctPages(e+u.features.length,t,i,r,s,a,n,l,o).then((e=>({calculated:!0,result:e}))):l}))}))}_distinctStat(e,t,i,r,s,a,n){return this._getDistinctPages(0,e,t,i,r,s,a,[],n).then((e=>({calculated:!0,result:e})))}isTable(){return this._layer.isTable||null===this._layer.geometryType||"table"===this._layer.type||""===this._layer.geometryType}_countstat(e,t,i,r){return this.databaseType().then((e=>{const s=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];if(this._requestStandardised&&(s.sqlFormat="standard"),this.isTable()&&i&&null!==t&&""!==t)return{calculated:!0,result:0};let a=null===r?null===i?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(r,e);return this._layer.definitionExpression&&this._useDefinitionExpression&&(a=""!==a?"(("+this._layer.definitionExpression+") AND ("+a+"))":this._layer.definitionExpression),s.where=a,s.where=a,s.spatialRelationship=this._makeRelationshipEnum(t),s.relationParameter=this._makeRelationshipParam(t),s.geometry=null===i?null:i,s.returnGeometry=!1,this.executeQuery(s,"executeForCount").then((e=>({calculated:!0,result:e})))}))}_stats(e,t,i,r,s,a,n){return this._ensureLoaded().then((()=>{const l=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsSqlExpression,o=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsStatistics,u=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsDistinct;return"count"===e?u?this._countstat(e,i,r,s):{calculated:!1}:!1===o||!1===(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.isSingleField)(t)&&!1===l||!1===t.isStandardized?""!==i||null!==s?{calculated:!1}:this._manualStat(e,t,a,n):"distinct"===e?!1===u?""!==i||null!==s?{calculated:!1}:this._manualStat(e,t,a,n):this._distinctStat(e,t,i,r,s,a,n):this.databaseType().then((a=>{if(this.isTable()&&r&&null!==i&&""!==i)return{calculated:!0,result:null};const n=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];this._requestStandardised&&(n.sqlFormat="standard");let l=null===s?null===r?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(s,a);this._layer.definitionExpression&&this._useDefinitionExpression&&(l=""!==l?"(("+this._layer.definitionExpression+") AND ("+l+"))":this._layer.definitionExpression),n.where=l,n.spatialRelationship=this._makeRelationshipEnum(i),n.relationParameter=this._makeRelationshipParam(i),n.geometry=null===r?null:r;const o=new _rest_support_StatisticDefinition_js__WEBPACK_IMPORTED_MODULE_17__["default"];o.statisticType=(0,_support_stats_js__WEBPACK_IMPORTED_MODULE_7__.decodeStatType)(e),o.onStatisticField=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(t,a),o.outStatisticFieldName="ARCADE_STAT_RESULT",n.returnGeometry=!1;let u="ARCADE_STAT_RESULT";return n.outStatistics=[o],this.executeQuery(n,"execute").then((e=>{if(!e.hasOwnProperty("features")||0===e.features.length)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(new Error("Unnexected Result querying statistics from layer"));let t=!1;for(let i=0;i<e.fields.length;i++)if("ARCADE_STAT_RESULT"===e.fields[i].name.toUpperCase()){u=e.fields[i].name,"date"===e.fields[i].type&&(t=!0);break}if(t){let t=e.features[0].attributes[u];return null!==t&&(t=new Date(e.features[0].attributes[u])),{calculated:!0,result:t}}return{calculated:!0,result:e.features[0].attributes[u]}}))}))}))}_stat(e,t,i,r,s,a,n){return this._stats(e,t,i,r,s,a,n)}_canDoAggregates(e,t){return this._ensureLoaded().then((()=>{let e=!1;const i=this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsSqlExpression;if(void 0!==this._layer.capabilities&&null!==this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsStatistics&&!0===this._layer.capabilities.query.supportsOrderBy&&(e=!0),e)for(let r=0;r<t.length-1;r++)null!==t[r].workingexpr&&(!1===t[r].workingexpr.isStandardized||!1===(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.isSingleField)(t[r].workingexpr)&&!1===i)&&(e=!1);return!1!==e}))}_makeRelationshipEnum(e){if(e.indexOf("esriSpatialRelRelation")>=0)return"relation";switch(e){case"esriSpatialRelRelation":return"relation";case"esriSpatialRelIntersects":return"intersects";case"esriSpatialRelContains":return"contains";case"esriSpatialRelOverlaps":return"overlaps";case"esriSpatialRelWithin":return"within";case"esriSpatialRelTouches":return"touches";case"esriSpatialRelCrosses":return"crosses";case"esriSpatialRelEnvelopeIntersects":return"envelope-intersects"}return e}_makeRelationshipParam(e){return e.indexOf("esriSpatialRelRelation")>=0?e.split(":")[1]:""}_getAggregatePagesDataSourceDefinition(e,t,i,r,a,n,l){return this._ensureLoaded().then((()=>this.databaseType())).then((o=>{let u="",h=!1,c=!1;null!==n&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(u=n.constructClause(),c=!0),this._layer.capabilities&&this._layer.capabilities.query&&!1===this._layer.capabilities.query.supportsPagination&&(c=!1,h=!0,u=this._layer.objectIdField);const p=[];for(let e=0;e<t.length;e++){const i=new _rest_support_StatisticDefinition_js__WEBPACK_IMPORTED_MODULE_17__["default"];i.onStatisticField=null!==t[e].workingexpr?(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(t[e].workingexpr,o):"",i.outStatisticFieldName=t[e].field,i.statisticType=t[e].toStatisticsName(),p.push(i)}""===u&&(u=e.join(","));let y=this._maxQueryRate();const f=this._layer.capabilities.query.maxRecordCount;void 0!==f&&f<y&&(y=f);let _=null===a?null===r?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_6__.toWhereClause)(a,o);this._layer.definitionExpression&&this._useDefinitionExpression&&(_=""!==_?"(("+this._layer.definitionExpression+") AND ("+_+"))":this._layer.definitionExpression);return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_4__["default"]([],["GETPAGES"],c,{groupbypage:!0,spatialRel:this._makeRelationshipEnum(i),relationParam:this._makeRelationshipParam(i),outFields:["*"],useOIDpagination:h,generatedOid:l,resultRecordCount:y,resultOffset:0,groupByFieldsForStatistics:e,outStatistics:p,geometry:null===r?null:r,where:_,orderByFields:u,returnGeometry:!1,returnIdsOnly:!1,internal:{lastMaxId:-1,set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})}))}_getAgregagtePhysicalPage(t,i,r){try{let i=t.pagesDefinition.where;!0===t.pagesDefinition.useOIDpagination&&(i=""!==i?"("+i+") AND ("+t.pagesDefinition.generatedOid+">"+t.pagesDefinition.internal.lastMaxId.toString()+")":t.pagesDefinition.generatedOid+">"+t.pagesDefinition.internal.lastMaxId.toString());const s=t.pagesDefinition.internal.lastRetrieved,a=s,n=t.pagesDefinition.internal.lastPage,l=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];return this._requestStandardised&&(l.sqlFormat="standard"),l.where=i,l.spatialRelationship=t.pagesDefinition.spatialRel,l.relationParameter=t.pagesDefinition.relationParam,l.outFields=t.pagesDefinition.outFields,l.outStatistics=t.pagesDefinition.outStatistics,l.geometry=t.pagesDefinition.geometry,l.groupByFieldsForStatistics=t.pagesDefinition.groupByFieldsForStatistics,l.num=t.pagesDefinition.resultRecordCount,l.start=t.pagesDefinition.internal.lastPage,l.returnGeometry=t.pagesDefinition.returnGeometry,l.orderByFields=""!==t.pagesDefinition.orderByFields?t.pagesDefinition.orderByFields.split(","):null,this.isTable()&&l.geometry&&l.spatialRelationship?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.resolve)([]):this.executeQuery(l,"execute").then((i=>{if(this._checkCancelled(r),!i.hasOwnProperty("features"))return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(new Error("Unnexected Result querying aggregates from layer"));const l=[];if(t.pagesDefinition.internal.lastPage!==n)return[];for(let e=0;e<i.features.length;e++)t.pagesDefinition.internal.set[a+e]=i.features[e].attributes[t.pagesDefinition.generatedOid];for(let t=0;t<i.features.length;t++)l.push(new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"]({attributes:i.features[t].attributes,geometry:null}));return!0===t.pagesDefinition.useOIDpagination?0===i.features.length?t.pagesDefinition.internal.fullyResolved=!0:t.pagesDefinition.internal.lastMaxId=i.features[i.features.length-1].attributes[t.pagesDefinition.generatedOid]:(void 0===i.exceededTransferLimit&&i.features.length!==t.pagesDefinition.resultRecordCount||!1===i.exceededTransferLimit)&&(t.pagesDefinition.internal.fullyResolved=!0),t.pagesDefinition.internal.lastRetrieved=s+i.features.length,t.pagesDefinition.internal.lastPage+=t.pagesDefinition.resultRecordCount,l}))}catch(s){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)(s)}}static create(e,t,i,r,s){const a=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_12__["default"]({url:e,outFields:null===t?["*"]:t});return new v({layer:a,spatialReference:i,lrucache:r,interceptor:s})}relationshipMetaData(){return this._layer&&this._layer.source&&this._layer.source.sourceJSON&&this._layer.source.sourceJSON.relationships?this._layer.source.sourceJSON.relationships:[]}serviceUrl(){return (0,_support_shared_js__WEBPACK_IMPORTED_MODULE_5__.extractServiceUrl)(this._layer.parsedUrl.path)}queryAttachments(e,t,r,s,a){if(this._layer.capabilities.data.supportsAttachment&&this._layer.capabilities.operations.supportsQueryAttachments){const n={objectIds:[e],returnMetadata:a};return(t&&t>0||r&&r>0)&&(n.size=[t&&t>0?t:0,r&&r>0?r:t+1]),s&&s.length>0&&(n.attachmentTypes=s),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:n,method:"attachments"}),this._layer.queryAttachments(n).then((t=>{const r=[];return t&&t[e]&&t[e].forEach((t=>{const s=this._layer.parsedUrl.path+"/"+e.toString()+"/attachments/"+t.id.toString();let n=null;a&&t.exifInfo&&(n=_Dictionary_js__WEBPACK_IMPORTED_MODULE_20__["default"].convertJsonToArcade(t.exifInfo,!0)),r.push(new _Attachment_js__WEBPACK_IMPORTED_MODULE_2__["default"](t.id,t.name,t.contentType,t.size,s,n))})),r}))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.resolve)([])}queryRelatedFeatures(i){const r={f:"json",relationshipId:i.relationshipId.toString(),definitionExpression:i.where,outFields:i.outFields.join(","),returnGeometry:i.returnGeometry.toString()};return void 0!==i.resultOffset&&null!==i.resultOffset&&(r.resultOffset=i.resultOffset.toString()),void 0!==i.resultRecordCount&&null!==i.resultRecordCount&&(r.resultRecordCount=i.resultRecordCount.toString()),i.orderByFields&&(r.orderByFields=i.orderByFields.join(",")),i.objectIds.length>0&&(r.objectIds=i.objectIds.join(",")),i.outSpatialReference&&(r.outSR=JSON.stringify(i.outSpatialReference.toJSON())),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preRequestCallback({layer:this._layer,queryPayload:r,method:"relatedrecords",url:this._layer.parsedUrl.path+"/queryRelatedRecords"}),(0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this._layer.parsedUrl.path+"/queryRelatedRecords",{responseType:"json",query:r}).then((t=>{if(t.data){const i={},r=t.data;if(r&&r.relatedRecordGroups){const t=r.spatialReference;for(const s of r.relatedRecordGroups){const a=s.objectId,n=[];for(const i of s.relatedRecords){i.geometry&&(i.geometry.spatialReference=t);const r=new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"]({geometry:i.geometry?(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_11__.fromJSON)(i.geometry):null,attributes:i.attributes});n.push(r)}i[a]={features:n,exceededTransferLimit:!0===r.exceededTransferLimit}}}return i}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.reject)("Invalid Request")}))}getFeatureByObjectId(e,t){const i=new _tasks_QueryTask_js__WEBPACK_IMPORTED_MODULE_18__["default"]({url:this._layer.parsedUrl.path}),r=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_16__["default"];return r.outFields=t,r.returnGeometry=!1,r.outSpatialReference=this.spatialReference,r.where=this.objectIdField+"="+e.toString(),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:r,method:"execute"}),i.execute(r).then((e=>1===e.features.length?e.features[0]:null))}getIdentityUser(){return this.load().then((()=>{var e;const t=null==(e=_kernel_js__WEBPACK_IMPORTED_MODULE_9__.id)?void 0:e.findCredential(this._layer.url);return t?t.userId:null}))}getOwningSystemUrl(){return this.load().then((()=>{var e;const i=null==(e=_kernel_js__WEBPACK_IMPORTED_MODULE_9__.id)?void 0:e.findServerInfo(this._layer.url);if(i)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.resolve)(i.owningSystemUrl);let r=this._layer.url;const s=r.toLowerCase().indexOf("/rest/services");return r=s>-1?r.substring(0,s):r,r?(r+="/rest/info",(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.create)(((e,i)=>{(0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(r,{query:{f:"json"}}).then((t=>{let i="";t.data&&t.data.owningSystemUrl&&(i=t.data.owningSystemUrl),e(i)}),(t=>{e("")}))}))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_10__.resolve)("")}))}getDataSourceFeatureSet(){const e=new v({layer:this._layer,spatialReference:this.spatialReference,outFields:this._overrideFields,includeGeometry:!this._removeGeometry,lrucache:this.recentlyUsedQueries,interceptor:this.featureSetQueryInterceptor});return e._useDefinitionExpression=!1,e}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerMemory.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerMemory.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ y)
/* harmony export */ });
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../Graphic.js */ "./node_modules/@arcgis/core/Graphic.js");
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../support/sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _geometry_Geometry_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../geometry/Geometry.js */ "./node_modules/@arcgis/core/geometry/Geometry.js");
/* harmony import */ var _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../layers/FeatureLayer.js */ "./node_modules/@arcgis/core/layers/FeatureLayer.js");
/* harmony import */ var _layers_support_FeatureType_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../layers/support/FeatureType.js */ "./node_modules/@arcgis/core/layers/support/FeatureType.js");
/* harmony import */ var _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../layers/support/Field.js */ "./node_modules/@arcgis/core/layers/support/Field.js");
/* harmony import */ var _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../rest/support/Query.js */ "./node_modules/@arcgis/core/rest/support/Query.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class y extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.sources.FeatureLayerMemory",this._removeGeometry=!1,this._overrideFields=null,this._forceIsTable=!1,e.spatialReference&&(this.spatialReference=e.spatialReference),this._transparent=!0,this._maxProcessing=1e3,this._layer=e.layer,this._wset=null,!0===e.isTable&&(this._forceIsTable=!0),void 0!==e.outFields&&(this._overrideFields=e.outFields),void 0!==e.includeGeometry&&(this._removeGeometry=!1===e.includeGeometry)}_maxQueryRate(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_3__.defaultMaxRecords}end(){return this._layer}optimisePagingFeatureQueries(){}load(){return null===this._loadPromise&&(this._loadPromise=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.create)(((e,t)=>{if(!0===this._layer.loaded)return this._initialiseFeatureSet(),void e(this);this._layer.when().then((()=>{try{this._initialiseFeatureSet(),e(this)}catch(r){t(r)}}),t),this._layer.load()}))),this._loadPromise}get gdbVersion(){return""}_initialiseFeatureSet(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType,this.fields=this._layer.fields.slice(0),this._layer.outFields)if(1===this._layer.outFields.length&&"*"===this._layer.outFields[0]);else{const e=[];for(const t of this.fields)if("oid"===t.type)e.push(t);else for(const r of this._layer.outFields)if(r.toLowerCase()===t.name.toLowerCase()){e.push(t);break}this.fields=e}else;if(null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{const e=[],t=[];for(const r of this.fields)if("oid"===r.type)e.push(r),t.push(r.name);else for(const s of this._overrideFields)if(s.toLowerCase()===r.name.toLowerCase()){e.push(r),t.push(r.name);break}this.fields=e,this._overrideFields=t}this.objectIdField=this._layer.objectIdField;for(const e of this.fields)"global-id"===e.type&&(this.globalIdField=e.name);this.hasM=this._layer.supportsM,this.hasZ=this._layer.supportsZ,this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.FeatureServiceDatabaseType.Standardised,this.typeIdField=this._layer.typeIdField,this.types=this._layer.types}isTable(){return this._forceIsTable||this._layer.isTable||"table"===this._layer.type||!this._layer.geometryType}_isInFeatureSet(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_3__.IdState.InFeatureSet}_candidateIdTransform(e){return e}_getSet(e){return null===this._wset?this._ensureLoaded().then((()=>this._getFilteredSet("",null,null,null,e))).then((e=>(this._wset=e,e))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(this._wset)}_changeFeature(t){const r={};for(const e of this.fields)r[e.name]=t.attributes[e.name];return new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"]({geometry:!0===this._removeGeometry?null:t.geometry,attributes:r})}_getFilteredSet(e,t,s,a,n){let u="",h=!1;if(null!==a&&(u=a.constructClause(),h=!0),this.isTable()&&t&&null!==e&&""!==e){const e=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[],!0,null);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(e)}const c=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_10__["default"];return c.where=null===s?null===t?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_4__.toWhereClause)(s,_support_shared_js__WEBPACK_IMPORTED_MODULE_3__.FeatureServiceDatabaseType.Standardised),c.spatialRelationship=this._makeRelationshipEnum(e),c.outSpatialReference=this.spatialReference,c.orderByFields=""!==u?u.split(","):null,c.geometry=null===t?null:t,c.returnGeometry=!0,c.relationParameter=this._makeRelationshipParam(e),this._layer.queryFeatures(c).then((e=>{if(null===e)return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[],h,null);this._checkCancelled(n);const t=[];e.features.forEach((e=>{const r=e.attributes[this._layer.objectIdField];t.push(r),this._featureCache[r]=this._changeFeature(e)}));return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],t,h,null)}))}_makeRelationshipEnum(e){if(e.indexOf("esriSpatialRelRelation")>=0)return"relation";switch(e){case"esriSpatialRelRelation":return"relation";case"esriSpatialRelIntersects":return"intersects";case"esriSpatialRelContains":return"contains";case"esriSpatialRelOverlaps":return"overlaps";case"esriSpatialRelWithin":return"within";case"esriSpatialRelTouches":return"touches";case"esriSpatialRelCrosses":return"crosses";case"esriSpatialRelEnvelopeIntersects":return"envelope-intersects"}return e}_makeRelationshipParam(e){return e.indexOf("esriSpatialRelRelation")>=0?e.split(":")[1]:""}_queryAllFeatures(){if(this._wset)return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(this._wset);const e=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_10__["default"];return e.where="1=1",this._ensureLoaded().then((()=>{if(this._layer.source&&this._layer.source.items){const e=[];return this._layer.source.items.forEach((t=>{const r=t.attributes[this._layer.objectIdField];e.push(r),this._featureCache[r]=this._changeFeature(t)})),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],e,!1,null),this._wset}return this._layer.queryFeatures(e).then((e=>{const t=[];return e.features.forEach((e=>{const r=e.attributes[this._layer.objectIdField];t.push(r),this._featureCache[r]=this._changeFeature(e)})),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],t,!1,null),this._wset}))}))}_getFeatures(e,t,r){const s=[];-1!==t&&void 0===this._featureCache[t]&&s.push(t);for(let i=e._lastFetchedIndex;i<e._known.length&&(e._lastFetchedIndex+=1,!(void 0===this._featureCache[e._known[i]]&&(e._known[i]!==t&&s.push(e._known[i]),s.length>r)));i++);return 0===s.length?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)("success"):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(new Error("Unaccounted for Features. Not in Feature Collection"))}_refineSetBlock(e){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(e)}_stat(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)({calculated:!1})}_canDoAggregates(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(!1)}relationshipMetaData(){return[]}static _cloneAttr(e){const t={};for(const r in e)t[r]=e[r];return t}nativeCapabilities(){return{title:this._layer.title,canQueryRelated:!1,source:this,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:!0}}static create(e,t){let r=e.layerDefinition.objectIdField;const s=e.layerDefinition.typeIdField?e.layerDefinition.typeIdField:"",i=[];if(e.layerDefinition.types)for(const h of e.layerDefinition.types)i.push(_layers_support_FeatureType_js__WEBPACK_IMPORTED_MODULE_8__["default"].fromJSON(h));let a=e.layerDefinition.geometryType;void 0===a&&(a=e.featureSet.geometryType||"");let l=e.featureSet.features;const n=t.toJSON();if(""===r||void 0===r){let t=!1;for(const s of e.layerDefinition.fields)if("oid"===s.type||"esriFieldTypeOID"===s.type){r=s.name,t=!0;break}if(!1===t){let t="FID",s=!0,i=0;for(;s;){let r=!0;for(const s of e.layerDefinition.fields)if(s.name===t){r=!1;break}!0===r?s=!1:(i++,t="FID"+i.toString())}e.layerDefinition.fields.push({type:"esriFieldTypeOID",name:t,alias:t});const a=[];for(let r=0;r<l.length;r++)a.push({geometry:e.featureSet.features[r].geometry,attributes:e.featureSet.features[r].attributes?this._cloneAttr(e.featureSet.features[r].attributes):{}}),a[r].attributes[t]=r;l=a,r=t}}const o=[];for(const h of e.layerDefinition.fields)h instanceof _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_9__["default"]?o.push(h):o.push(_layers_support_Field_js__WEBPACK_IMPORTED_MODULE_9__["default"].fromJSON(h));let u=a;switch(u){case"esriGeometryPoint":u="point";break;case"esriGeometryPolyline":u="polyline";break;case"esriGeometryPolygon":u="polygon";break;case"esriGeometryExtent":u="extent";break;case"esriGeometryMultipoint":u="multipoint"}for(const c of l)c.geometry&&c.geometry instanceof _geometry_Geometry_js__WEBPACK_IMPORTED_MODULE_6__["default"]==!1&&(c.geometry.type=u,void 0===c.geometry.spatialReference&&(c.geometry.spatialReference=n));const p={outFields:["*"],source:l,fields:o,types:i,typeIdField:s,objectIdField:r,spatialReference:t};p.geometryType=u||"point";const _=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_7__["default"](p);return new y({layer:_,spatialReference:t,isTable:null===u||""===u})}queryAttachments(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)([])}getFeatureByObjectId(e){const t=new _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_10__["default"];return t.where=this.objectIdField+"="+e.toString(),this._layer.queryFeatures(t).then((e=>1===e.features.length?e.features[0]:null))}getOwningSystemUrl(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)("")}getIdentityUser(){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)("")}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerRelated.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerRelated.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ u)
/* harmony export */ });
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../Graphic.js */ "./node_modules/@arcgis/core/Graphic.js");
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../support/FeatureSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js");
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../support/IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _rest_support_RelationshipQuery_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../rest/support/RelationshipQuery.js */ "./node_modules/@arcgis/core/rest/support/RelationshipQuery.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class u extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.sources.FeatureLayerRelated",this._findObjectId=-1,this._requestStandardised=!1,this._removeGeometry=!1,this._overrideFields=null,this.featureObjectId=null,this.relatedLayer=null,this.relationship=null,e.spatialReference&&(this.spatialReference=e.spatialReference),this._transparent=!0,this._maxProcessing=1e3,this._layer=e.layer,this._wset=null,this._findObjectId=e.objectId,this.featureObjectId=e.objectId,this.relationship=e.relationship,this.relatedLayer=e.relatedLayer,void 0!==e.outFields&&(this._overrideFields=e.outFields),void 0!==e.includeGeometry&&(this._removeGeometry=!1===e.includeGeometry)}_maxQueryRate(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_3__.defaultMaxRecords}end(){return this._layer}optimisePagingFeatureQueries(){}load(){return null===this._loadPromise&&(this._loadPromise=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.create)(((e,t)=>{(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.all)([this._layer.load(),this.relatedLayer.load()]).then((()=>{this._initialiseFeatureSet(),e(this)}),t)}))),this._loadPromise}nativeCapabilities(){return this.relatedLayer.nativeCapabilities()}_initialiseFeatureSet(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this.relatedLayer.geometryType,this.fields=this.relatedLayer.fields.slice(0),null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{const e=[],t=[];for(const r of this.fields)if("oid"===r.type)e.push(r),t.push(r.name);else for(const i of this._overrideFields)if(i.toLowerCase()===r.name.toLowerCase()){e.push(r),t.push(r.name);break}this.fields=e,this._overrideFields=t}const e=this._layer.nativeCapabilities();e&&(this._databaseType=e.databaseType,this._requestStandardised=e.requestStandardised),this.objectIdField=this.relatedLayer.objectIdField,this.globalIdField=this.relatedLayer.globalIdField,this.hasM=this.relatedLayer.supportsM,this.hasZ=this.relatedLayer.supportsZ,this.typeIdField=this.relatedLayer.typeIdField,this.types=this.relatedLayer.types}databaseType(){return this.relatedLayer.databaseType().then((()=>(this._databaseType=this.relatedLayer._databaseType,this._databaseType)))}isTable(){return this.relatedLayer.isTable()}_isInFeatureSet(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_3__.IdState.InFeatureSet}_candidateIdTransform(e){return e}_getSet(e){return null===this._wset?this._ensureLoaded().then((()=>this._getFilteredSet("",null,null,null,e))).then((e=>(this._wset=e,e))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(this._wset)}_changeFeature(t){const r={};for(const e of this.fields)r[e.name]=t.attributes[e.name];return new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"]({geometry:!0===this._removeGeometry?null:t.geometry,attributes:r})}_getFilteredSet(e,t,i,s,a){return this.databaseType().then((()=>{if(this.isTable()&&t&&null!==e&&""!==e){return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[],!0,null)}const n=this._layer.nativeCapabilities();if(!1===n.canQueryRelated){return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"]([],[],!0,null)}if(n.capabilities.queryRelated&&n.capabilities.queryRelated.supportsPagination)return this._getFilteredSetUsingPaging(e,t,i,s,a);let l="",d=!1;null!==s&&n.capabilities&&n.capabilities.queryRelated&&!0===n.capabilities.queryRelated.supportsOrderBy&&(l=s.constructClause(),d=!0);const u=new _rest_support_RelationshipQuery_js__WEBPACK_IMPORTED_MODULE_5__["default"];u.objectIds=[this._findObjectId];const h=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this.relatedLayer.fields?this.relatedLayer.fields.map((e=>e.name)):["*"]);u.outFields=h,u.relationshipId=this.relationship.id,u.where="1=1";let c=!0;return!0===this._removeGeometry&&(c=!1),u.returnGeometry=c,this._requestStandardised&&(u.sqlFormat="standard"),u.outSpatialReference=this.spatialReference,u.orderByFields=""!==l?l.split(","):null,n.source.queryRelatedFeatures(u).then((s=>{this._checkCancelled(a);const n=s[this._findObjectId]?s[this._findObjectId].features:[],l=[];for(let e=0;e<n.length;e++)this._featureCache[n[e].attributes[this._layer.objectIdField]]=n[e],l.push(n[e].attributes[this._layer.objectIdField]);const o=t&&null!==e&&""!==e,u=null!=i;return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"](o||u?l:[],o||u?[]:l,d,null)}))}))}_fieldsIncludingObjectId(e){if(null===e)return[this.objectIdField];const t=e.slice(0);if(t.indexOf("*")>-1)return t;let r=!1;for(const i of t)if(i.toUpperCase()===this.objectIdField.toUpperCase()){r=!0;break}return!1===r&&t.push(this.objectIdField),t}_getFilteredSetUsingPaging(e,t,i,s,a){try{let n="",l=!1;const d=this._layer.nativeCapabilities();return null!==s&&d&&d.capabilities.queryRelated&&!0===d.capabilities.queryRelated.supportsOrderBy&&(n=s.constructClause(),l=!0),this.databaseType().then((()=>{const s="1=1";let o=this._maxQueryRate();const u=d.capabilities.query.maxRecordCount;void 0!==u&&u<o&&(o=u);const h=t&&null!==e&&""!==e,c=null!=i;let p=null,y=!0;!0===this._removeGeometry&&(y=!1);const f=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this.relatedLayer.fields?this.relatedLayer.fields.map((e=>e.name)):["*"]);return p=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_2__["default"](h||c?["GETPAGES"]:[],h||c?[]:["GETPAGES"],l,{outFields:f.join(","),resultRecordCount:o,resultOffset:0,objectIds:[this._findObjectId],where:s,orderByFields:n,returnGeometry:y,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}}),this._expandPagedSet(p,o,0,0,a).then((()=>p))}))}catch(n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.reject)(n)}}_expandPagedSet(e,t,r,i,s){return this._expandPagedSetFeatureSet(e,t,r,i,s)}_clonePageDefinition(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}}_getPhysicalPage(e,t,r){try{const t=e.pagesDefinition.internal.lastRetrieved,i=t,s=e.pagesDefinition.internal.lastPage,a=this._layer.nativeCapabilities(),n=new _rest_support_RelationshipQuery_js__WEBPACK_IMPORTED_MODULE_5__["default"];return!0===this._requestStandardised&&(n.sqlFormat="standard"),n.relationshipId=this.relationship.id,n.objectIds=e.pagesDefinition.objectIds,n.resultOffset=e.pagesDefinition.internal.lastPage,n.resultRecordCount=e.pagesDefinition.resultRecordCount,n.outFields=e.pagesDefinition.outFields.split(","),n.where=e.pagesDefinition.where,n.orderByFields=""!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(","):null,n.returnGeometry=e.pagesDefinition.returnGeometry,n.outSpatialReference=this.spatialReference,a.source.queryRelatedFeatures(n).then((a=>{if(this._checkCancelled(r),e.pagesDefinition.internal.lastPage!==s)return 0;const n=a[this._findObjectId]?a[this._findObjectId].features:[];for(let t=0;t<n.length;t++)e.pagesDefinition.internal.set[i+t]=n[t].attributes[this._layer.objectIdField];for(let e=0;e<n.length;e++)this._featureCache[n[e].attributes[this._layer.objectIdField]]=n[e];const l=!a[this._findObjectId]||!1===a[this._findObjectId].exceededTransferLimit;return n.length!==e.pagesDefinition.resultRecordCount&&l&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=t+n.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,n.length}))}catch(i){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.reject)(i)}}_getFeatures(e,t,r,i){const s=[];-1!==t&&void 0===this._featureCache[t]&&s.push(t);const a=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(e,a))return this._expandPagedSet(e,a,0,0,i).then((()=>this._getFeatures(e,t,r,i)));let n=0;for(let l=e._lastFetchedIndex;l<e._known.length&&(n++,n<=r&&(e._lastFetchedIndex+=1),!("GETPAGES"!==e._known[l]&&void 0===this._featureCache[e._known[l]]&&(e._known[l]!==t&&s.push(e._known[l]),s.length>r)))&&!(n>=r&&0===s.length);l++);return 0===s.length?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)("success"):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.reject)(new Error("Unaccounted for Features. Not in Feature Collection"))}_refineSetBlock(e,t,r){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(e)}_stat(e,t,r,i,s,a,n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)({calculated:!1})}get gdbVersion(){return this.relatedLayer.gdbVersion}_canDoAggregates(e,t,r,i,s){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.resolve)(!1)}relationshipMetaData(){return this.relatedLayer.relationshipMetaData()}serviceUrl(){return this.relatedLayer.serviceUrl()}queryAttachments(e,t,r,i,s){return this.relatedLayer.queryAttachments(e,t,r,i,s)}getFeatureByObjectId(e,t){return this.relatedLayer.getFeatureByObjectId(e,t)}getOwningSystemUrl(){return this.relatedLayer.getOwningSystemUrl()}getIdentityUser(){return this.relatedLayer.getIdentityUser()}getDataSourceFeatureSet(){return this.relatedLayer}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ E)
/* harmony export */ });
/* harmony import */ var _FeatureSetIterator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FeatureSetIterator.js */ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSetIterator.js");
/* harmony import */ var _IdSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IdSet.js */ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js");
/* harmony import */ var _shared_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _cache_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache.js */ "./node_modules/@arcgis/core/arcade/featureset/support/cache.js");
/* harmony import */ var _stats_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./stats.js */ "./node_modules/@arcgis/core/arcade/featureset/support/stats.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var _geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../geometry/geometryEngineAsync.js */ "./node_modules/@arcgis/core/geometry/geometryEngineAsync.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../layers/support/FieldsIndex.js */ "./node_modules/@arcgis/core/layers/support/FieldsIndex.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class E{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=_shared_js__WEBPACK_IMPORTED_MODULE_2__.FeatureServiceDatabaseType.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.types=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,e&&e.lrucache&&(this.recentlyUsedQueries=e.lrucache),e&&e.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,t){return void 0===t?this[e]:(void 0!==this[e]&&(this[e]=t),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.create)(((e,t)=>{if(!0===this._parent.loaded)return this._initialiseFeatureSet(),void e(this);this._parent.load().then((()=>{try{this._initialiseFeatureSet(),e(this)}catch(r){t(r)}}),t)}))),this._loadPromise}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__["default"]({wkid:4326}),this.geometryType=_shared_js__WEBPACK_IMPORTED_MODULE_2__.layerGeometryEsriConstants.point)}getField(e,t){let r;return(t=t||this.fields)&&(e=e.toLowerCase(),t.some((t=>(t&&t.name.toLowerCase()===e&&(r=t),!!r)))),r}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_9__["default"](this.fields)),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!==e&&e.aborted)throw new Error("Operation has been cancelled.")}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,t,r,n,s){return null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(!1):this._parent._canDoAggregates(e,t,r,n,s)}_getAggregatePagesDataSourceDefinition(e,t,r,n,s,i,a){return null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(new Error("Should never be called")):this._parent._getAggregatePagesDataSourceDefinition(e,t,r,n,s,i,a)}_getAgregagtePhysicalPage(e,t,r){return null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(new Error("Should never be called")):this._parent._getAgregagtePhysicalPage(e,t,r)}databaseType(){if(this._databaseType===_shared_js__WEBPACK_IMPORTED_MODULE_2__.FeatureServiceDatabaseType.NotEvaluated){if(null!==_cache_js__WEBPACK_IMPORTED_MODULE_3__["default"].applicationCache){const e=_cache_js__WEBPACK_IMPORTED_MODULE_3__["default"].applicationCache.getDatabaseType(this._cacheableFeatureSetSourceKey());if(null!==e)return e}if(null!==this._databaseTypeProbed)return this._databaseTypeProbed;const e=[{thetype:_shared_js__WEBPACK_IMPORTED_MODULE_2__.FeatureServiceDatabaseType.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:_shared_js__WEBPACK_IMPORTED_MODULE_2__.FeatureServiceDatabaseType.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:_shared_js__WEBPACK_IMPORTED_MODULE_2__.FeatureServiceDatabaseType.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];let t=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.create)(((t,r)=>{this._getDatabaseTypeImpl(e,0).then((e=>{this._databaseType=e,t(this._databaseType)}),(e=>{r(e)}))}));return null!==_cache_js__WEBPACK_IMPORTED_MODULE_3__["default"].applicationCache&&(_cache_js__WEBPACK_IMPORTED_MODULE_3__["default"].applicationCache.setDatabaseType(this._cacheableFeatureSetSourceKey(),t),t=t.catch((e=>{throw _cache_js__WEBPACK_IMPORTED_MODULE_3__["default"].applicationCache.clearDatabaseType(this._cacheableFeatureSetSourceKey()),e}))),this._databaseTypeProbed=t,this._databaseTypeProbed}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(this._databaseType)}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_getDatabaseTypeImpl(e,t){return t>=e.length?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(_shared_js__WEBPACK_IMPORTED_MODULE_2__.FeatureServiceDatabaseType.StandardisedNoInterval):this._runDatabaseProbe(e[t].testwhere).then((r=>!0===r?e[t].thetype:this._getDatabaseTypeImpl(e,t+1)))}_runDatabaseProbe(e){return null!==this._parent?this._parent._runDatabaseProbe(e):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(new Error("Not Implemented"))}isTable(){return this._parent.isTable()}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return _shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.Unknown}_getSet(e){throw new Error("Not implemented in abstract class")}_getFeature(e,t,r){try{return this._checkCancelled(r),void 0!==this._featureFromCache(t)?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(this._featureFromCache(t)):this._getFeatures(e,t,this._maxProcessingRate(),r).then((()=>(this._checkCancelled(r),void 0!==this._featureFromCache(t)?this._featureFromCache(t):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(new Error("Feature Not Found")))))}catch(n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(n)}}_getFeatureBatch(e,r){try{this._checkCancelled(r);const n=new _IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],e,!1,null),s=[];return this._getFeatures(n,-1,e.length,r).then((()=>{this._checkCancelled(r);for(const t of e)void 0!==this._featureFromCache(t)&&s.push(this._featureFromCache(t));return s}))}catch(n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(n)}}_getFeatures(e,t,r,n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)("success")}_getFilteredSet(e,t,r,n,s){throw new Error("Not implemented in abstract class")}_refineSetBlock(e,t,r){try{if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQueryRate()))return this._expandPagedSet(e,this._maxQueryRate(),0,0,r).then((()=>this._refineSetBlock(e,t,r)));this._checkCancelled(r);const n=e._candidates.length;this._refineKnowns(e,t);let s=n-e._candidates.length;return 0===e._candidates.length||s>=t?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(e):this._refineIfParentKnown(e,t-s,r).then((()=>{if(this._checkCancelled(r),this._refineKnowns(e,t-s),s=n-e._candidates.length,s<t&&e._candidates.length>0){const n=t-s,i=this._prepareFetchAndRefineSet(e._candidates);return this._fetchAndRefineFeatures(i,i.length>n?n:e._candidates.length,r).then((()=>(this._checkCancelled(r),this._refineKnowns(e,t-s),e)))}return e}))}catch(n){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(n)}}_fetchAndRefineFeatures(e,t,r){return null}_prepareFetchAndRefineSet(e){const t=[];for(let r=0;r<e.length;r++)this._isPhysicalFeature(e[r])&&t.push(e[r]);return t}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,t){let r=0,n=null;const i=[];t=this._maxQueryRate();for(let a=0;a<e._candidates.length&&"GETPAGES"!==e._candidates[a];a++){let l=!1;const h=this._candidateIdTransform(e._candidates[a]);h!==e._candidates[a]&&(l=!0);const u=this._isInFeatureSet(h);if(u===_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.InFeatureSet)!0===l?e._known.indexOf(h)<0&&(e._known.push(h),r+=1):(e._known.push(e._candidates[a]),r+=1),null===n?n={start:a,end:a}:n.end===a-1?n.end=a:(i.push(n),n={start:a,end:a});else if(u===_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.NotInFeatureSet)null===n?n={start:a,end:a}:n.end===a-1?n.end=a:(i.push(n),n={start:a,end:a}),r+=1;else if(u===_shared_js__WEBPACK_IMPORTED_MODULE_2__.IdState.Unknown&&(r+=1,!0===e._ordered))break;if(r>=t)break}null!==n&&i.push(n);for(let s=i.length-1;s>=0;s--)e._candidates.splice(i[s].start,i[s].end-i[s].start+1)}_refineIfParentKnown(e,r,n){const s=new _IdSet_js__WEBPACK_IMPORTED_MODULE_1__["default"]([],[],e._ordered,null);return s._candidates=e._candidates.slice(0),this._parent._refineSetBlock(s,r,n)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,t){if(null===e.pagesDefinition)return!1;let r=0;for(let n=e._lastFetchedIndex;n<e._known.length;n++){if("GETPAGES"===e._known[n])return!0;if(void 0===this._featureCache[e._known[n]]&&(r+=1,r>=t))break}return!1}_checkIfNeedToExpandCandidatePage(e,t){if(null===e.pagesDefinition)return!1;let r=0;for(let n=0;n<e._candidates.length;n++){if("GETPAGES"===e._candidates[n])return!0;if(r+=1,r>=t)break}return!1}_expandPagedSet(e,t,r,n,s){return null===this._parent?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.reject)(new Error("Parent Paging not implemented")):this._parent._expandPagedSet(e,t,r,n,s)}_expandPagedSetFeatureSet(e,t,r,n,s){return e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(n=1),0===n&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(n=2),0===n?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)("finished"):this._getPage(e,n,s).then((n=>r+n<t?this._expandPagedSet(e,t,r+n,0,s):"success"))}_getPage(e,t,r){const n=1===t?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){n.length=n.length-1;let t=0;for(let s=0;s<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+s>=e.pagesDefinition.internal.set.length);s++)n[n.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+s],t++;e.pagesDefinition.resultOffset+=t;let r=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(r=!0),!1===r&&n.push("GETPAGES"),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(t)}return this._getPhysicalPage(e,t,r).then((()=>this._getPage(e,t,r)))}_getPhysicalPage(e,t,r){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,t,r,n){return this._ensureLoaded().then((()=>this._stat(e,t,"",null,null,r,n).then((s=>!1===s.calculated?this._manualStat(e,t,r,n).then((e=>e.result)):s.result))))}_manualStat(e,t,r,n){switch(e.toLowerCase()){case"count":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.count)(this,n).then((e=>({calculated:!0,result:e})));case"distinct":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.distinct)(this,t,r).then((e=>({calculated:!0,result:e})));case"avg":case"mean":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.mean)(this,t,n).then((e=>({calculated:!0,result:e})));case"stdev":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.stdev)(this,t,n).then((e=>({calculated:!0,result:e})));case"variance":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.variance)(this,t,n).then((e=>({calculated:!0,result:e})));case"sum":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.sum)(this,t,n).then((e=>({calculated:!0,result:e})));case"min":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.min)(this,t,n).then((e=>({calculated:!0,result:e})));case"max":return (0,_stats_js__WEBPACK_IMPORTED_MODULE_4__.max)(this,t,n).then((e=>({calculated:!0,result:e})));default:return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)({calculated:!0,result:0})}}_stat(e,t,r,n,s,i,a){return this._parent._stat(e,t,r,n,s,i,a).then((l=>!1===l.calculated?null===s&&""===r&&null===n?this._manualStat(e,t,i,a):{calculated:!1}:l))}_unionAllGeomSelf(e){const t=this.iterator(this._defaultTracker(e)),r=[];return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.create)(((e,n)=>{this._unionShapeInBatches(r,t,e,n)}))}_unionAllGeom(e){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.create)(((t,r)=>{const n=this.iterator(this._defaultTracker(e)),s=[];this._unionShapeInBatches(s,n,t,r)}))}_unionShapeInBatches(e,t,r,n){t.next().then((s=>{try{null!==s&&null!==s.geometry&&e.push(s.geometry),e.length>30||null===s&&e.length>1?(0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_7__.union)(e).then((i=>{try{null===s?r(i):(e=[i],this._unionShapeInBatches(e,t,r,n))}catch(a){n(a)}}),n):null===s?1===e.length?r(e[0]):r(null):this._unionShapeInBatches(e,t,r,n)}catch(i){n(i)}}),n)}iterator(t){return new _FeatureSetIterator_js__WEBPACK_IMPORTED_MODULE_0__["default"](this,t)}intersection(e,t=!1){return E._featuresetFunctions.intersection.bind(this)(e,t)}difference(e,t=!1,r=!0){return E._featuresetFunctions.difference.bind(this)(e,t,r)}symmetricDifference(e,t=!1,r=!0){return E._featuresetFunctions.symmetricDifference.bind(this)(e,t,r)}morphShape(e,t,r="unknown",n=null){return E._featuresetFunctions.morphShape.bind(this)(e,t,r,n)}morphShapeAndAttributes(e,t,r="unknown"){return E._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,t,r)}union(e,t=!1){return E._featuresetFunctions.union.bind(this)(e,t)}intersects(e){return E._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return E._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return E._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return E._featuresetFunctions.overlaps.bind(this)(e)}relate(e,t){return E._featuresetFunctions.relate.bind(this)(e,t)}within(e){return E._featuresetFunctions.within.bind(this)(e)}touches(e){return E._featuresetFunctions.touches.bind(this)(e)}top(e){return E._featuresetFunctions.top.bind(this)(e)}crosses(e){return E._featuresetFunctions.crosses.bind(this)(e)}buffer(e,t,r,n=!0){return E._featuresetFunctions.buffer.bind(this)(e,t,r,n)}filter(e,t=null){return E._featuresetFunctions.filter.bind(this)(e,t)}orderBy(e){return E._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,t){return E._featuresetFunctions.dissolve.bind(this)(e,t)}groupby(e,t){return E._featuresetFunctions.groupby.bind(this)(e,t)}reduce(e,t=null,r){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.create)(((n,s)=>{this._reduceImpl(this.iterator(this._defaultTracker(r)),e,t,0,n,s,0)}))}_reduceImpl(e,t,r,n,s,i,a){try{if(++a>1e3)return void setTimeout((()=>{a=0,this._reduceImpl(e,t,r,n,s,i,a)}));e.next().then((l=>{try{if(null===l)s(r);else{const h=t(r,l,n,this);(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.isPromiseLike)(h)?h.then((r=>{this._reduceImpl(e,t,r,n+1,s,i,a)}),i):this._reduceImpl(e,t,h,n+1,s,i,a)}}catch(h){i(h)}}),i)}catch(l){i(l)}}removeField(e){return E._featuresetFunctions.removeField.bind(this)(e)}addField(e,t,r=null){return E._featuresetFunctions.addField.bind(this)(e,t,r)}sumArea(e,t=!1,r){const n=(0,_shared_js__WEBPACK_IMPORTED_MODULE_2__.convertSquareUnitsToCode)(e);return this.reduce(((e,r)=>null===r.geometry?0:t?(0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_7__.geodesicArea)(r.geometry,n).then((t=>e+t)):(0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_7__.planarArea)(r.geometry,n).then((t=>e+t))),0,r)}sumLength(e,t=!1,r){const n=(0,_shared_js__WEBPACK_IMPORTED_MODULE_2__.convertLinearUnitsToCode)(e);return this.reduce(((e,r)=>null===r.geometry?0:t?(0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_7__.geodesicLength)(r.geometry,n).then((t=>e+t)):(0,_geometry_geometryEngineAsync_js__WEBPACK_IMPORTED_MODULE_7__.planarLength)(r.geometry,n).then((t=>e+t))),0,r)}_substituteVars(e,t){if(null!==t){const r={};for(const e in t)r[e.toLowerCase()]=t[e];e.parameters=r}}distinct(e,t=1e3,r=null,n){return this.load().then((()=>{const s=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create(e,this.getFieldsIndex());return this._substituteVars(s,r),this.calculateStatistic("distinct",s,t,this._defaultTracker(n))}))}min(e,t=null,r){return this.load().then((()=>{const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create(e,this.getFieldsIndex());return this._substituteVars(n,t),this.calculateStatistic("min",n,-1,this._defaultTracker(r))}))}max(e,t=null,r){return this.load().then((()=>{const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create(e,this.getFieldsIndex());return this._substituteVars(n,t),this.calculateStatistic("max",n,-1,this._defaultTracker(r))}))}avg(e,t=null,r){return this.load().then((()=>{const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create(e,this.getFieldsIndex());return this._substituteVars(n,t),this.calculateStatistic("avg",n,-1,this._defaultTracker(r))}))}sum(e,t=null,r){return this.load().then((()=>{const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create(e,this.getFieldsIndex());return this._substituteVars(n,t),this.calculateStatistic("sum",n,-1,this._defaultTracker(r))}))}stdev(e,t=null,r){return this.load().then((()=>{const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create(e,this.getFieldsIndex());return this._substituteVars(n,t),this.calculateStatistic("stdev",n,-1,this._defaultTracker(r))}))}variance(e,t=null,r){return this.load().then((()=>{const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create(e,this.getFieldsIndex());return this._substituteVars(n,t),this.calculateStatistic("variance",n,-1,this._defaultTracker(r))}))}count(e){return this.load().then((()=>this.calculateStatistic("count",_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_6__.WhereClause.create("1",this.getFieldsIndex()),-1,this._defaultTracker(e))))}_defaultTracker(e){return e||{aborted:!1}}forEach(e,t){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.create)(((r,n)=>{this._forEachImpl(this.iterator(this._defaultTracker(t)),e,this,r,n,0)}))}_forEachImpl(e,t,r,n,s,i){try{if(++i>1e3)return void setTimeout((()=>{i=0,this._forEachImpl(e,t,r,n,s,i)}),0);e.next().then((a=>{try{if(null===a)n(r);else{const l=t(a);null==l?this._forEachImpl(e,t,r,n,s,i):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.isPromiseLike)(l)?l.then((()=>{try{this._forEachImpl(e,t,r,n,s,i)}catch(a){s(a)}}),s):this._forEachImpl(e,t,r,n,s,i)}}catch(l){s(l)}}),s)}catch(a){s(a)}}convertToJSON(e){const t={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let r=0;r<this.fields.length;r++)t.layerDefinition.fields.push((0,_shared_js__WEBPACK_IMPORTED_MODULE_2__.esriFieldToJson)(this.fields[r]));return this.reduce(((e,r)=>{const n={geometry:r.geometry&&r.geometry.toJSON(),attributes:{}};for(const t in r.attributes)n.attributes[t]=r.attributes[t];return t.featureSet.features.push(n),1}),0,e).then((()=>t))}castToText(){return"object, FeatureSet"}queryAttachments(e,t,r,n,s){return this._parent.queryAttachments(e,t,r,n,s)}serviceUrl(){return this._parent.serviceUrl()}subtypes(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map((e=>({name:e.name,code:e.id}))):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const t of this.fields)e.push((0,_shared_js__WEBPACK_IMPORTED_MODULE_2__.esriFieldToJson)(t));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===_shared_js__WEBPACK_IMPORTED_MODULE_2__.layerGeometryEsriRestConstants[this.geometryType]?"":_shared_js__WEBPACK_IMPORTED_MODULE_2__.layerGeometryEsriRestConstants[this.geometryType],fields:e}}convertToText(e,t){return"schema"===e?this._ensureLoaded().then((()=>JSON.stringify(this.schema()))):"featureset"===e?this._ensureLoaded().then((()=>{const e=[];return this.reduce(((t,r)=>{const n={geometry:r.geometry?r.geometry.toJSON():null,attributes:r.attributes};return null!==n.geometry&&n.geometry.spatialReference&&delete n.geometry.spatialReference,e.push(n),1}),0,t).then((()=>{const t=this.schema();return t.features=e,t.spatialReference=this.spatialReference.toJSON(),JSON.stringify(t)}))})):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(this.castToText())}getFeatureByObjectId(e,t){return this._parent.getFeatureByObjectId(e,t)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===(null==e?void 0:e.featureset)?this:"none"===(null==e?void 0:e.featureset)?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,t=null){return"keeptype"===(null==t?void 0:t.featureset)?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(this):"schema"===(null==t?void 0:t.featureset)?this._ensureLoaded().then((()=>JSON.parse(JSON.stringify(this.schema())))):"none"===(null==t?void 0:t.featureset)?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_5__.resolve)(null):this._ensureLoaded().then((()=>{const r=[];return this.reduce(((e,n)=>{const s={geometry:n.geometry?!0===(null==t?void 0:t.keepGeometryType)?n.geometry:n.geometry.toJSON():null,attributes:n.attributes};return null!==s.geometry&&s.geometry.spatialReference&&!0!==(null==t?void 0:t.keepGeometryType)&&delete s.geometry.spatialReference,r.push(s),1}),0,e).then((()=>{const e=this.schema();return e.features=r,e.spatialReference=!0===(null==t?void 0:t.keepGeometryType)?this.spatialReference:this.spatialReference.toJSON(),e}))}))}}E._featuresetFunctions={};


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/FeatureSetIterator.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/FeatureSetIterator.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ n)
/* harmony export */ });
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class n{constructor(t,e){this._lastId=-1,this._progress=e,this._parent=t}reset(){this._lastId=-1}nextBatch(e){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((t=>this.nextBatch(e)),(t=>this.nextBatch(e)));const n={returnpromise:null,hasset:!1},s=[];return n.returnpromise=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.create)(((t,a)=>{this._parent._getSet(this._progress).then((h=>{let _=h._known.length-1;if("GETPAGES"===h._known[h._known.length-1]&&(_-=1),this._lastId+e>_&&h._known.length>0&&"GETPAGES"===h._known[h._known.length-1])this._parent._expandPagedSet(h,this._parent._maxQueryRate(),0,0,this._progress).then((s=>{n.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(e).then(t,a)}),(t=>{n.hasset=!0,this._parent._mainSetInUse=null,a(t)}));else{if(_>=this._lastId+e||0===h._candidates.length){for(let t=0;t<e;t++){const e=t+this._lastId+1;if(e>=h._known.length)break;s[t]=h._known[e]}return this._lastId+=s.length,0===s.length&&(n.hasset=!0,this._parent._mainSetInUse=null,t([])),void this._parent._getFeatureBatch(s,this._progress).then((e=>{n.hasset=!0,this._parent._mainSetInUse=null,t(e)}),(t=>{n.hasset=!0,this._parent._mainSetInUse=null,a(t)}))}this._parent._refineSetBlock(h,this._parent._maxProcessingRate(),this._progress).then((()=>{n.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(e).then(t,a)}),(t=>{n.hasset=!0,this._parent._mainSetInUse=null,a(t)}))}}),(t=>{n.hasset=!0,this._parent._mainSetInUse=null,a(t)}))})),!1===n.hasset&&(this._parent._mainSetInUse=n.returnpromise,n.hasset=!0),n.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((t=>this.next()),(t=>this.next()));const e={returnpromise:null,hasset:!1};return e.returnpromise=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.create)(((t,n)=>{this._parent._getSet(this._progress).then((s=>{this._lastId<s._known.length-1?"GETPAGES"===s._known[this._lastId+1]?this._parent._expandPagedSet(s,this._parent._maxQueryRate(),0,0,this._progress).then((t=>(e.hasset=!0,this._parent._mainSetInUse=null,this.next()))).then(t,n):(this._lastId+=1,this._parent._getFeature(s,s._known[this._lastId],this._progress).then((n=>{e.hasset=!0,this._parent._mainSetInUse=null,t(n)}),(t=>{e.hasset=!0,this._parent._mainSetInUse=null,n(t)}))):s._candidates.length>0?this._parent._refineSetBlock(s,this._parent._maxProcessingRate(),this._progress).then((()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.next().then(t,n)}),(t=>{e.hasset=!0,this._parent._mainSetInUse=null,n(t)})):(e.hasset=!0,this._parent._mainSetInUse=null,t(null))}),(t=>{e.hasset=!0,this._parent._mainSetInUse=null,n(t)}))})),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}count(){return-1!==this._parent._totalCount?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.resolve)(this._parent._totalCount):this._parent._getSet(this._progress).then((t=>this._refineAllSets(t))).then((t=>(this._parent._totalCount=t._known.length,(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.resolve)(this._parent._totalCount))))}_refineAllSets(t){return t._known.length>0&&"GETPAGES"===t._known[t._known.length-1]?this._parent._expandPagedSet(t,this._parent._maxQueryRate(),0,1,this._progress).then((e=>this._refineAllSets(t))).then((t=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.resolve)(t))):t._candidates.length>0?"GETPAGES"===t._known[t._candidates.length-1]?this._parent._expandPagedSet(t,this._parent._maxQueryRate(),0,2,this._progress).then((e=>this._refineAllSets(t))).then((t=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.resolve)(t))):this._parent._refineSetBlock(t,this._parent._maxProcessingRate(),this._progress).then((t=>t._candidates.length>0?this._refineAllSets(t):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.resolve)(t))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.resolve)(t)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/IdSet.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class t{constructor(t,s,i,e){this._candidates=null,this._known=null,this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=t,this._known=s,this._ordered=i,this.pagesDefinition=e}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ e)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t(t,e){return t===e?0:null===t?-1:null===e?1:t<e?-1:1}class e{constructor(t){const e=t.split(",");this._fields=[],this._directions=[];for(let s=0;s<e.length;s++){const t=e[s].match(/\S+/g);this._fields.push(t[0]),2===t.length?"asc"===t[1].toLowerCase()?this._directions.push(1):this._directions.push(0):this._directions.push(1)}}constructClause(){let t="";for(let e=0;e<this._fields.length;e++)0!==e&&(t+=","),t+=this._fields[e],1===this._directions[e]?t+=" ASC":t+=" DESC";return t}order(e){e.sort(((e,s)=>{for(let i=0;i<this._fields.length;i++){const r=this.featureValue(e.feature,this._fields[i],i),l=this.featureValue(s.feature,this._fields[i],i);let o=0;if(o=1===this._directions[i]?t(r,l):-1*t(r,l),0!==o)return o}return 0}))}scanForField(t){for(let e=0;e<this._fields.length;e++)if(this._fields[e].toLowerCase().trim()===t.toLowerCase().trim())return!0;return!1}replaceFields(t){let s="";for(let e=0;e<this._fields.length;e++){0!==e&&(s+=",");let i=this._fields[e];for(const e of t)if(i.toLowerCase()===e.field.toLowerCase()){i=e.newfield;break}s+=i,1===this._directions[e]?s+=" ASC":s+=" DESC"}return new e(s)}featureValue(t,e,s){const i=t.attributes[e];if(void 0!==i)return i;for(const r in t.attributes)if(e.toLowerCase()===r.toLowerCase())return this._fields[s]=r,t.attributes[r];return null}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/StatsField.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/StatsField.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ n)
/* harmony export */ });
/* harmony import */ var _shared_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _sqlUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function a(a){if("function"===a.parseTree.type){if(0===a.parseTree.args.value.length)return{name:a.parseTree.name,expr:null};if(a.parseTree.args.value.length>1)throw new Error("Statistic does not have 1 or 0 Parameters");const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_2__.WhereClause.create((0,_sqlUtils_js__WEBPACK_IMPORTED_MODULE_1__.toWhereClauseFromTree)(a.parseTree.args.value[0],_shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Standardised,a.parameters),a.fieldsIndex);return{name:a.parseTree.name,expr:n}}return null}class n{clone(){const e=new n;return e.field=this.field,e.tofieldname=this.tofieldname,e.typeofstat=this.typeofstat,e.workingexpr=this.workingexpr,e}static parseStatField(e,r,i){const s=new n;s.field=e;const o=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_2__.WhereClause.create(r,i),l=a(o);if(null===l)throw new Error("Invalid Statistic Function");const p=l.name.toUpperCase().trim();if("MIN"===p){if(s.typeofstat="MIN",s.workingexpr=l.expr,null===o)throw new Error("Invalid Statistic Function Parameters")}else if("MAX"===p){if(s.typeofstat="MAX",s.workingexpr=l.expr,null===o)throw new Error("Invalid Statistic Function Parameters")}else if("COUNT"===p)s.typeofstat="COUNT",s.workingexpr=l.expr;else if("STDEV"===p){if(s.typeofstat="STDDEV",s.workingexpr=l.expr,null===o)throw new Error("Invalid Statistic Function Parameters")}else if("SUM"===p){if(s.typeofstat="SUM",s.workingexpr=l.expr,null===o)throw new Error("Invalid Statistic Function Parameters")}else if("MEAN"===p){if(s.typeofstat="AVG",s.workingexpr=l.expr,null===o)throw new Error("Invalid Statistic Function Parameters")}else if("AVG"===p){if(s.typeofstat="AVG",s.workingexpr=l.expr,null===o)throw new Error("Invalid Statistic Function Parameters")}else{if("VAR"!==p)throw new Error("Invalid Statistic Function");if(s.typeofstat="VAR",s.workingexpr=l.expr,null===o)throw new Error("Invalid Statistic Function Parameters")}return s}toStatisticsName(){switch(this.typeofstat.toUpperCase()){case"MIN":return"min";case"MAX":return"max";case"SUM":return"sum";case"COUNT":default:return"count";case"VAR":return"var";case"STDDEV":return"stddev";case"AVG":return"avg"}}}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/cache.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/cache.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ a)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(a){void 0===this._databaseTypeMetaData[a]&&delete this._databaseTypeMetaData[a]}getDatabaseType(a){return"MUSTBESET"===a||void 0===this._databaseTypeMetaData[a]?null:this._databaseTypeMetaData[a]}setDatabaseType(a,e){this._databaseTypeMetaData[a]=e}getLayerInfo(a){return void 0===this._layerInfo[a]?null:this._layerInfo[a]}setLayerInfo(a,e){this._layerInfo[a]=e}clearLayerInfo(a){void 0!==this._layerInfo[a]&&delete this._layerInfo[a]}}a.applicationCache=null;


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "combine": () => (/* binding */ o),
/* harmony export */   "convertIntervalToSql": () => (/* binding */ T),
/* harmony export */   "isSingleField": () => (/* binding */ E),
/* harmony export */   "makeDateString": () => (/* binding */ u),
/* harmony export */   "makeToday": () => (/* binding */ i),
/* harmony export */   "predictType": () => (/* binding */ f),
/* harmony export */   "reformulateWithoutField": () => (/* binding */ s),
/* harmony export */   "scanForField": () => (/* binding */ h),
/* harmony export */   "toWhereClause": () => (/* binding */ n),
/* harmony export */   "toWhereClauseFromTree": () => (/* binding */ a),
/* harmony export */   "translateFunctionToDatabaseSpecific": () => (/* binding */ l)
/* harmony export */ });
/* harmony import */ var _shared_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! luxon */ "./node_modules/luxon/build/cjs-browser/luxon.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n(e,r){return c(e.parseTree,r,e.parameters)}function a(e,r,t){return c(e,r,t)}function s(t,n,a,s){return _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_1__.WhereClause.create(c(t.parseTree,_shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Standardised,t.parameters,n,a),s)}function o(t,a,s="AND"){return _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_1__.WhereClause.create("(("+n(t,_shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Standardised)+")"+s+"("+n(a,_shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Standardised)+"))",t.fieldsIndex)}function c(e,r,t,n=null,a=null){let s,o,f,d;switch(e.type){case"interval":return T(c(e.value,r,t,n,a),e.qualifier,e.op);case"case_expression":{let s=" CASE ";"simple"===e.format&&(s+=c(e.operand,r,t,n,a));for(let o=0;o<e.clauses.length;o++)s+=" WHEN "+c(e.clauses[o].operand,r,t,n,a)+" THEN "+c(e.clauses[o].value,r,t,n,a);return null!==e.else&&(s+=" ELSE "+c(e.else,r,t,n,a)),s+=" END ",s}case"param":{const n=t[e.value.toLowerCase()];if("string"==typeof n){return"'"+t[e.value.toLowerCase()].toString().replace(/'/g,"''")+"'"}if(n instanceof Date)return u(n,r);if(n instanceof Array){const e=[];for(let t=0;t<n.length;t++)"string"==typeof n[t]?e.push("'"+n[t].toString().replace(/'/g,"''")+"'"):n[t]instanceof Date?e.push(u(n[t],r)):e.push(n[t].toString());return e}return n.toString()}case"expr_list":o=[];for(const s of e.value)o.push(c(s,r,t,n,a));return o;case"unary_expr":return" ( NOT "+c(e.expr,r,t,n,a)+" ) ";case"binary_expr":switch(e.operator){case"AND":return" ("+c(e.left,r,t,n,a)+" AND "+c(e.right,r,t,n,a)+") ";case"OR":return" ("+c(e.left,r,t,n,a)+" OR "+c(e.right,r,t,n,a)+") ";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+c(e.left,r,t,n,a)+" IS NULL )";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+c(e.left,r,t,n,a)+" IS NOT NULL )";case"IN":return s=[],"expr_list"===e.right.type?(s=c(e.right,r,t,n,a)," ("+c(e.left,r,t,n,a)+" IN ("+s.join(",")+")) "):(d=c(e.right,r,t,n,a),d instanceof Array?" ("+c(e.left,r,t,n,a)+" IN ("+d.join(",")+")) ":" ("+c(e.left,r,t,n,a)+" IN ("+d+")) ");case"NOT IN":return s=[],"expr_list"===e.right.type?(s=c(e.right,r,t,n,a)," ("+c(e.left,r,t,n,a)+" NOT IN ("+s.join(",")+")) "):(d=c(e.right,r,t,n,a),d instanceof Array?" ("+c(e.left,r,t,n,a)+" NOT IN ("+d.join(",")+")) ":" ("+c(e.left,r,t,n,a)+" NOT IN ("+d+")) ");case"BETWEEN":return f=c(e.right,r,t,n,a)," ("+c(e.left,r,t,n,a)+" BETWEEN "+f[0]+" AND "+f[1]+" ) ";case"NOTBETWEEN":return f=c(e.right,r,t,n,a)," ("+c(e.left,r,t,n,a)+" NOT BETWEEN "+f[0]+" AND "+f[1]+" ) ";case"LIKE":return""!==e.escape?" ("+c(e.left,r,t,n,a)+" LIKE "+c(e.right,r,t,n,a)+" ESCAPE '"+e.escape+"') ":" ("+c(e.left,r,t,n,a)+" LIKE "+c(e.right,r,t,n,a)+") ";case"NOT LIKE":return""!==e.escape?" ("+c(e.left,r,t,n,a)+" NOT LIKE "+c(e.right,r,t,n,a)+" ESCAPE '"+e.escape+"') ":" ("+c(e.left,r,t,n,a)+" NOT LIKE "+c(e.right,r,t,n,a)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+c(e.left,r,t,n,a)+" "+e.operator+" "+c(e.right,r,t,n,a)+") "}throw new Error("Not Supported Operator "+e.operator);case"null":return"null";case"bool":return!0===e.value?"1":"0";case"string":return"'"+e.value.toString().replace(/'/g,"''")+"'";case"timestamp":case"date":return u(e.value,r);case"number":return e.value.toString();case"current_time":return i("date"===e.mode,r);case"column_ref":return n&&n.toLowerCase()===e.column.toLowerCase()?"("+a+")":e.column;case"function":{const s=c(e.args,r,t,n,a);return l(e.name,s,r)}}throw new Error("Unsupported sql syntax "+e.type)}function l(r,t,n){switch(r.toLowerCase().trim()){case"abs":if(1!==t.length)throw new Error("Invalid Parameter for call to ABS");return"abs("+t[0]+")";case"ceiling":case"ceil":if(1!==t.length)throw new Error("Invalid Parameter for call to CEILING");switch(n){case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.StandardisedNoInterval:}return"CEILING("+t[0]+")";case"floor":if(1!==t.length)throw new Error("Invalid Parameter for call to Floor");return"FLOOR("+t[0]+")";case"log":if(1!==t.length)throw new Error("Invalid Parameter for call to LOG");return"LOG("+t[0]+")";case"log10":if(1!==t.length)throw new Error("Invalid Parameter for call to LOG10");return"LOG10("+t[0]+")";case"power":if(2!==t.length)throw new Error("Invalid Parameter for call to POWER");return"POWER("+t[0]+","+t[1]+")";case"round":if(2===t.length)return"ROUND("+t[0]+","+t[1]+")";if(1===t.length)return"ROUND("+t[0]+")";throw new Error("Invalid Parameter for call to ROUND");case"truncate":if(t.length<1||t.length>2)throw new Error("Invalid Parameter for TRUNCATE function");return n===_shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.SqlServer?"ROUND("+t[0]+(1===t.length?"0":","+t[1])+",1)":"TRUNCATE("+t[0]+(1===t.length?")":","+t[1]+")");case"char_length":case"len":if(1!==t.length)throw new Error("Invalid Parameter for CHAR_LENGTH function");switch(n){case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.SqlServer:return"LEN("+t[0]+")";case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Oracle:return"LENGTH("+t[0]+")";default:return"CHAR_LENGTH("+t[0]+")"}case"concat":if(t.length<1)throw new Error("Invalid Parameter for CONCAT function");{let e="CONCAT(";for(let r=0;r<t.length;r++)0!==r&&(e+=","),e+=t[r];return e+=")",e}case"lower":case"lcase":if(1!==t.length)throw new Error("Invalid Parameter for Lower function");return"LOWER("+t[0]+")";case"upper":case"ucase":if(1!==t.length)throw new Error("Invalid Parameter for Upper function");return"UPPER("+t[0]+")";case"substring":{let r="";switch(n){case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Oracle:return r="SUBSTR("+t[0]+","+t[1],3===t.length&&(r+=","+t[2]),r+=")",r;case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.SqlServer:return r=3===t.length?"SUBSTRING("+t[0]+","+t[1]+","+t[2]+")":"SUBSTRING("+t[0]+",  "+t[1]+", LEN("+t[0]+") - "+t[1]+")",r;default:return r="SUBSTRING("+t[0]+" FROM "+t[1],3===t.length&&(r+=" FOR "+t[2]),r+=")",r}}case"extract":return"EXTRACT("+t[0].replace(/\'/g,"")+" FROM "+t[1]+")"}throw new Error("Function Not Recognised")}function u(r,n){const a=luxon__WEBPACK_IMPORTED_MODULE_2__.DateTime.fromJSDate(r),s=0===a.hour&&0===a.minute&&0===a.second&&0===a.millisecond;switch(n){case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.FILEGDB:case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.StandardisedNoInterval:return s?`date '${a.toFormat("yyyy-LL-dd")}'`:`date '${a.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Oracle:return s?`TO_DATE('${a.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${a.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.SqlServer:return`'${a.toFormat(s?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.PGDB:return`#${a.toFormat(s?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Postgres:return`TIMESTAMP '${a.toFormat(s?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`date '${a.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function i(r,t){switch(t){case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.FILEGDB:case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.StandardisedNoInterval:case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Oracle:return r?"CURRENT_DATE":"CURRENT_TIMESTAMP";case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.SqlServer:return r?"CAST(GETDATE() AS DATE)":"GETDATE()";case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.PGDB:case _shared_js__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDatabaseType.Postgres:default:return r?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function f(e,r,t={}){const n={},a={},s={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",oid:"integer",long:"integer","small-integer":"integer",integer:"integer",single:"double",double:"double",date:"date",string:"string"};for(const o of r){const e=s[o.type];n[o.name.toLowerCase()]=void 0===e?"":e}for(const o in t){const e=s[t[o]];a[o.toLowerCase()]=void 0===e?"":e}switch(d(n,e.parseTree,e.parameters,a)){case"double":case"double":return"double";case"integer":return"integer";case"date":return"date";case"string":return"string"}return""}function d(e,r,t,n){let a;switch(r.type){case"interval":return"integer";case"case_expression":{const a=[];if("simple"===r.format){for(let s=0;s<r.clauses.length;s++)a.push(d(e,r.clauses[s].value,t,n));null!==r.else&&a.push(d(e,r.else,t,n))}else{for(let s=0;s<r.clauses.length;s++)a.push(d(e,r.else,t,n));null!==r.else&&a.push(d(e,r.else,t,n))}return g(a)}case"param":{const e=n[r.value.toLowerCase()];if(void 0===e&&t){const e=t[r.value.toLowerCase()];if(void 0===e)return"";if(null===e)return"";if("string"==typeof e||e instanceof String)return"string";if("boolean"==typeof e)return"boolean";if(e instanceof Date)return"date";if("number"==typeof e)return e%1==0?"integer":"double"}return void 0===e?"":e}case"expr_list":{const a=[];for(const s of r.value)a.push(d(e,s,t,n));return a}case"unary_expr":return"boolean";case"binary_expr":switch(r.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==r.right.type)throw new Error("Unsupported RHS for IS");return"boolean";case"*":case"-":case"+":case"/":return g([d(e,r.left,t,n),d(e,r.right,t,n)]);default:throw new Error("Not Supported Operator "+r.operator)}case"null":return"";case"bool":return"boolean";case"string":return"string";case"number":return null===r.value?"":r.value%1==0?"integer":"double";case"date":case"timestamp":case"current_time":return"date";case"column_ref":{const t=e[r.column.toLowerCase()];return void 0===t?"":t}case"function":switch(r.name.toLowerCase()){case"position":case"extract":case"char_length":return"integer";case"round":case"round":return a=d(e,r.args,t,n),a instanceof Array?a.length>0?a[0]:"":a;case"sign":return a=d(e,r.args,t,n),a instanceof Array&&(a=g(a)),"integer"===a||"double"===a?a:"double";case"ceiling":case"floor":case"abs":{const a=d(e,r.args,t,n);return a instanceof Array?g(a):a}case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"power":case"truncate":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string"}return""}throw new Error("Unsupported sql syntax "+r.type)}const p={boolean:1,string:2,integer:3,double:4,date:5};function g(e){if(e){let r="";for(const t of e)""!==t&&(r=""===r||p[r]<p[t]?t:r);return r}return""}function h(e,r){return y(e.parseTree,r)}function E(e){return"column_ref"===e.parseTree.type}function y(e,r){if(null==e)return!1;switch(e.type){case"when_clause":return y(e.operand,r)||y(e.value,r);case"case_expression":for(const t of e.clauses)if(y(t,r))return!0;return!("simple"!==e.format||!y(e.operand,r))||!(null===e.else||!y(e.else,r));case"param":case"null":case"bool":case"date":case"timestamp":case"string":case"number":return!1;case"expr_list":for(const t of e.value)if(y(t,r))return!0;return!1;case"unary_expr":return y(e.expr,r);case"binary_expr":return y(e.left,r)||y(e.right,r);case"column_ref":return r.toLowerCase()===e.column.toLowerCase();case"function":return y(e.args,r)}return!1}function m(e){let r="";return r+=e.period.toUpperCase(),r}function T(e,r,t){let n="";return n="interval-period"===r.type?m(r):m(r.start)+" TO "+m(r.end),"INTERVAL "+t+" "+e+" "+n}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/featureset/support/stats.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/featureset/support/stats.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "calculateStat": () => (/* binding */ p),
/* harmony export */   "count": () => (/* binding */ w),
/* harmony export */   "decodeStatType": () => (/* binding */ m),
/* harmony export */   "distinct": () => (/* binding */ C),
/* harmony export */   "max": () => (/* binding */ v),
/* harmony export */   "mean": () => (/* binding */ M),
/* harmony export */   "min": () => (/* binding */ d),
/* harmony export */   "stdev": () => (/* binding */ y),
/* harmony export */   "sum": () => (/* binding */ j),
/* harmony export */   "variance": () => (/* binding */ x)
/* harmony export */ });
/* harmony import */ var _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/languageUtils.js */ "./node_modules/@arcgis/core/chunks/languageUtils.js");
/* harmony import */ var _shared_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _sqlUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function s(t){return t=+t,isFinite(t)?t-t%1||(t<0?-0:0===t?t:0):t}function i(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];return n/t.length}function o(t){const n=i(t);let e=0;for(let r=0;r<t.length;r++)e+=(n-t[r])**2;return e/t.length}function h(t){const n=i(t);let e=0;for(let r=0;r<t.length;r++)e+=(n-t[r])**2;return e/(t.length-1)}function f(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];return n}function g(t,u){const l=[],c={},a=[];for(let s=0;s<t.length;s++){if(void 0!==t[s]&&null!==t[s]){const u=t[s];if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__.isNumber)(u)||(0,_shared_js__WEBPACK_IMPORTED_MODULE_1__.isString)(u))void 0===c[u]&&(l.push(u),c[u]=1);else{let t=!1;for(let n=0;n<a.length;n++)!0===(0,_shared_js__WEBPACK_IMPORTED_MODULE_1__.equalityTest)(a[n],u)&&(t=!0);!1===t&&(a.push(u),l.push(u))}}if(l.length>=u&&-1!==u)return l}return l}function m(t){switch(t.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function p(t,n,e=1e3){switch(t.toLowerCase()){case"distinct":return g(n,e);case"avg":case"mean":return i(n);case"min":return Math.min.apply(Math,n);case"sum":return f(n);case"max":return Math.max.apply(Math,n);case"stdev":case"stddev":return Math.sqrt(o(n));case"var":case"variance":return o(n);case"count":return n.length}return 0}function d(t,n,e){return U(t,n,e,!0).then((t=>0===t.length?null:Math.min.apply(Math,t)))}function v(t,n,e){return U(t,n,e,!0).then((t=>0===t.length?null:Math.max.apply(Math,t)))}function M(t,n,e){let r="";return!1===(0,_sqlUtils_js__WEBPACK_IMPORTED_MODULE_2__.isSingleField)(n)&&(r=(0,_sqlUtils_js__WEBPACK_IMPORTED_MODULE_2__.predictType)(n,t.fields,null)),U(t,n,e,!0).then((t=>{if(0===t.length)return null;const n=i(t);return null===n?n:"integer"===r?s(n):n}))}function x(t,n,e){return U(t,n,e,!0).then((t=>0===t.length?null:h(t)))}function y(t,n,e){return U(t,n,e,!0).then((t=>0===t.length?null:Math.sqrt(h(t))))}function j(t,n,e){return U(t,n,e,!0).then((t=>0===t.length?null:f(t)))}function w(t,n){try{return t.iterator(n).count()}catch(e){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.reject)(e)}}function U(t,n,e,r=!1){try{const u=t.iterator(e);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.create)(((t,e)=>{q(u,[],n,r,t,e)}))}catch(u){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.reject)(u)}}function q(n,e,r,u,l,c){(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__.U)(n.next().then((t=>{try{if(null!==t){const a=r.calculateValue(t);return null===a?!1===u&&(e[e.length]=a):e[e.length]=a,q(n,e,r,u,l,c)}l(e)}catch(a){c(a)}}),c))}function C(t,n,e=1e3,r=null){return L(t,n,e,r)}function L(t,n,e,r){try{return V(t.iterator(r),{},[],n,e)}catch(u){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.reject)(u)}}function V(t,n,e,r,u){return t.next().then((l=>{if(null!==l){const c=r.calculateValue(l);return null!=c&&void 0===n[c]&&(e.push(c),n[c]=1),e.length>=u&&-1!==u?e:V(t,n,e,r,u)}return e}))}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/functions/featuresetbase.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/functions/featuresetbase.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "registerFunctions": () => (/* binding */ te)
/* harmony export */ });
/* harmony import */ var _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ArcadePortal.js */ "./node_modules/@arcgis/core/arcade/ArcadePortal.js");
/* harmony import */ var _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Dictionary.js */ "./node_modules/@arcgis/core/arcade/Dictionary.js");
/* harmony import */ var _Feature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Feature.js */ "./node_modules/@arcgis/core/arcade/Feature.js");
/* harmony import */ var _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../featureSetCollection.js */ "./node_modules/@arcgis/core/arcade/featureSetCollection.js");
/* harmony import */ var _featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../featureSetUtils.js */ "./node_modules/@arcgis/core/arcade/featureSetUtils.js");
/* harmony import */ var _FunctionWrapper_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../FunctionWrapper.js */ "./node_modules/@arcgis/core/arcade/FunctionWrapper.js");
/* harmony import */ var _ImmutableArray_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ImmutableArray.js */ "./node_modules/@arcgis/core/arcade/ImmutableArray.js");
/* harmony import */ var _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../chunks/languageUtils.js */ "./node_modules/@arcgis/core/chunks/languageUtils.js");
/* harmony import */ var _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../featureset/actions/Adapted.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/Adapted.js");
/* harmony import */ var _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../featureset/actions/AttributeFilter.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js");
/* harmony import */ var _featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../featureset/actions/OrderBy.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js");
/* harmony import */ var _featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../featureset/actions/Top.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/Top.js");
/* harmony import */ var _featureset_sources_Empty_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../featureset/sources/Empty.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/Empty.js");
/* harmony import */ var _featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../featureset/sources/FeatureLayerMemory.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerMemory.js");
/* harmony import */ var _featureset_support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../featureset/support/OrderbyClause.js */ "./node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js");
/* harmony import */ var _featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../featureset/support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../featureset/support/sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _fieldStats_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./fieldStats.js */ "./node_modules/@arcgis/core/arcade/functions/fieldStats.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../layers/FeatureLayer.js */ "./node_modules/@arcgis/core/layers/FeatureLayer.js");
/* harmony import */ var _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../layers/support/Field.js */ "./node_modules/@arcgis/core/layers/support/Field.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function J(e,t,n,r){if(1===r.length){if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(r[0]))return (0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_17__.calculateStat)(e,r[0],-1);if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.b)(r[0]))return (0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_17__.calculateStat)(e,r[0].toArray(),-1)}return (0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_17__.calculateStat)(e,r,-1)}function q(e,t,n){const r=e.getVariables();if(r.length>0){const i=[];for(let e=0;e<r.length;e++){const a={name:r[e]};i.push(t.evaluateIdentifier(n,a))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.all)(i).then((t=>{const n={};for(let e=0;e<r.length;e++)n[r[e]]=t[e];return e.parameters=n,e}))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(e)}function K(e,t,n=null){for(const r in e)if(r.toLowerCase()===t.toLowerCase())return e[r];return n}function Y(e){if(null===e)return null;const t={type:K(e,"type",""),name:K(e,"name","")};if("range"===t.type)t.range=K(e,"range",[]);else{t.codedValues=[];for(const n of K(e,"codedValues",[]))t.codedValues.push({name:K(n,"name",""),code:K(n,"code",null)})}return t}function Z(e){if(null===e)return null;const t={},n=K(e,"wkt",null);null!==n&&(t.wkt=n);const r=K(e,"wkid",null);return null!==r&&(t.wkid=r),t}function Q(e){if(null===e)return null;const t={hasZ:K(e,"hasz",!1),hasM:K(e,"hasm",!1)},n=K(e,"spatialreference",null);n&&(t.spatialReference=Z(n));const r=K(e,"x",null);if(null!==r)return t.x=r,t.y=K(e,"y",null),t;const i=K(e,"rings",null);if(null!==i)return t.rings=i,t;const a=K(e,"paths",null);if(null!==a)return t.paths=a,t;const s=K(e,"points",null);if(null!==s)return t.points=s,t;for(const l of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const n=K(e,l,null);null!==n&&(t[l]=n)}return t}function X(e,t){for(const n of t)if(n===e)return!0;return!1}function ee(e){return!!e.layerDefinition&&(!!e.featureSet&&(!1!==X(e.layerDefinition.geometryType,["","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&(null!==e.layerDefinition.objectIdField&&""!==e.layerDefinition.objectIdField&&(!1!==(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(e.layerDefinition.fields)&&!1!==(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(e.featureSet.features)))))}function te(B){"async"===B.mode&&(B.functions.getuser=function(n,r){return B.standardFunctionAsync(n,r,((r,s,l)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(l,1,2);let o=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(l[1],""),f=!0===o;if(o=!0===o||!1===o?"":(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(o),l[0]instanceof _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__["default"]){let e=null;return n.services&&n.services.portal&&(e=n.services.portal),e=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.getPortal)(l[0],e),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.lookupUser)(e,o,f).then((e=>{if(e){const n=JSON.parse(JSON.stringify(e));for(const e of["lastLogin","created","modified"])void 0!==n[e]&&null!==n[e]&&(n[e]=new Date(n[e]));return _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"].convertObjectToArcadeDictionary(n)}return null}))}let u=null;if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(l[0])&&(u=l[0]),u)return f=!1,o?null:u.load().then((()=>u.getOwningSystemUrl())).then((r=>{if(!r)return o?null:u.getIdentityUser().then((e=>e?_Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"].convertObjectToArcadeDictionary({username:e}):null));let s=null;return n.services&&n.services.portal&&(s=n.services.portal),s=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.getPortal)(new _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__["default"](r),s),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.lookupUser)(s,o,f).then((e=>{if(e){const n=JSON.parse(JSON.stringify(e));for(const e of["lastLogin","created","modified"])void 0!==n[e]&&null!==n[e]&&(n[e]=new Date(n[e]));return _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"].convertObjectToArcadeDictionary(n)}return null}))}));throw new Error("Invalid Parameter")}))},B.signatures.push({name:"getuser",min:"1",max:"2"}),B.functions.featuresetbyid=function(e,t){return B.standardFunctionAsync(e,t,((e,t,n)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(n,2,4),n[0]instanceof _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_3__["default"]){const e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(n[1]);let t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(n[2],null);const r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.y)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(n[3],!0));if(null===t&&(t=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(t))throw new Error("Invalid Parameter");return n[0].featureSetById(e,r,t)}throw new Error("Invalid Parameter")}))},B.signatures.push({name:"featuresetbyid",min:"2",max:"4"}),B.functions.getfeatureset=function(e,t){return B.standardFunctionAsync(e,t,((t,r,i)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(i,1,2),i[0]instanceof _Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]){let t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(i[1],"datasource");return null===t&&(t="datasource"),t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(t).toLowerCase(),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.convertToFeatureSet)(i[0]._layer,t,e.lrucache,e.interceptor,e.spatialReference)}throw new Error("Invalid Parameter")}))},B.signatures.push({name:"getfeatureset",min:"1",max:"2"}),B.functions.featuresetbyportalitem=function(t,n){return B.standardFunctionAsync(t,n,((n,r,a)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(a,2,5),null===a[0])throw new Error("Portal is required");if(a[0]instanceof _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__["default"]){const e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(a[1]),n=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(a[2]);let r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(a[3],null);const s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.y)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(a[4],!0));if(null===r&&(r=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(r))throw new Error("Invalid Parameter");let o=null;return t.services&&t.services.portal&&(o=t.services.portal),o=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.getPortal)(a[0],o),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromPortalItem)(e,n,t.spatialReference,r,s,o,t.lrucache,t.interceptor)}if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(a[0]))throw new Error("Portal is required");const s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(a[0]),o=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(a[1]);let f=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(a[2],null);const u=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.y)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(a[3],!0));if(null===f&&(f=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(f))throw new Error("Invalid Parameter");if(t.services&&t.services.portal)return (0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromPortalItem)(s,o,t.spatialReference,f,u,t.services.portal,t.lrucache,t.interceptor);throw new Error("Portal is required")}))},B.signatures.push({name:"featuresetbyportalitem",min:"2",max:"5"}),B.functions.featuresetbyname=function(e,t){return B.standardFunctionAsync(e,t,((e,t,n)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(n,2,4),n[0]instanceof _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_3__["default"]){const e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(n[1]);let t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(n[2],null);const r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.y)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(n[3],!0));if(null===t&&(t=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(t))throw new Error("Invalid Parameter");return n[0].featureSetByName(e,r,t)}throw new Error("Invalid Parameter")}))},B.signatures.push({name:"featuresetbyname",min:"2",max:"4"}),B.functions.featureset=function(e,n){return B.standardFunction(e,n,((n,r,i)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(i,1,1);let a=i[0];const s={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(a))a=JSON.parse(a),void 0!==a.layerDefinition?(s.layerDefinition=a.layerDefinition,s.featureSet=a.featureSet,a.layerDefinition.spatialReference&&(s.layerDefinition.spatialReference=a.layerDefinition.spatialReference)):(s.featureSet.features=a.features,s.featureSet.geometryType=a.geometryType,s.layerDefinition.geometryType=s.featureSet.geometryType,s.layerDefinition.objectIdField=a.objectIdFieldName,s.layerDefinition.typeIdField=a.typeIdFieldName,s.layerDefinition.globalIdField=a.globalIdFieldName,s.layerDefinition.fields=a.fields,a.spatialReference&&(s.layerDefinition.spatialReference=a.spatialReference));else{if(!(i[0]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"]))throw new Error("Invalid Parameter");{a=JSON.parse(i[0].castToText());const e=K(a,"layerdefinition");if(null!==e){s.layerDefinition.geometryType=K(e,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.globalIdField=K(e,"globalidfield",""),s.layerDefinition.objectIdField=K(e,"objectidfield",""),s.layerDefinition.typeIdField=K(e,"typeidfield","");const t=K(e,"spatialreference",null);t&&(s.layerDefinition.spatialReference=Z(t));for(const r of K(e,"fields",[])){const e={name:K(r,"name",""),alias:K(r,"alias",""),type:K(r,"type",""),nullable:K(r,"nullable",!0),editable:K(r,"editable",!0),length:K(r,"length",null),domain:Y(K(r,"domain"))};s.layerDefinition.fields.push(e)}const n=K(a,"featureset",null);if(n){const e={};for(const t of s.layerDefinition.fields)e[t.name.toLowerCase()]=t.name;for(const t of K(n,"features",[])){const n={},r=K(t,"attributes",{});for(const t in r)n[e[t.toLowerCase()]]=r[t];s.featureSet.features.push({attributes:n,geometry:Q(K(t,"geometry",null))})}}}else{s.layerDefinition.geometryType=K(a,"geometrytype",""),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.objectIdField=K(a,"objectidfieldname",""),s.layerDefinition.typeIdField=K(a,"typeidfieldname","");const e=K(a,"spatialreference",null);e&&(s.layerDefinition.spatialReference=Z(e));for(const n of K(a,"fields",[])){const e={name:K(n,"name",""),alias:K(n,"alias",""),type:K(n,"type",""),nullable:K(n,"nullable",!0),editable:K(n,"editable",!0),length:K(n,"length",null),domain:Y(K(n,"domain"))};s.layerDefinition.fields.push(e)}const t={};for(const n of s.layerDefinition.fields)t[n.name.toLowerCase()]=n.name;for(const n of K(a,"features",[])){const e={},r=K(n,"attributes",{});for(const n in r)e[t[n.toLowerCase()]]=r[n];s.featureSet.features.push({attributes:e,geometry:Q(K(n,"geometry",null))})}}}}if(!1===ee(s))throw new Error("Invalid Parameter");return _featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_13__["default"].create(s,e.spatialReference)}))},B.signatures.push({name:"featureset",min:"1",max:"1"}),B.functions.filter=function(e,t){return B.standardFunctionAsync(e,t,((t,n,r)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(r,2,2),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(r[0])||(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.b)(r[0])){const t=[];let n=r[0];n instanceof _ImmutableArray_js__WEBPACK_IMPORTED_MODULE_6__["default"]&&(n=n.toArray());let i=null;if(r[1]instanceof _FunctionWrapper_js__WEBPACK_IMPORTED_MODULE_5__["default"])i=B.arcadeCustomFunctionHandler(r[1]);else if(r[1]instanceof _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.N)i=(...t)=>r[1].fn(e,{preparsed:!0,arguments:t});else{if(!(r[1]instanceof _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.S))throw new Error("Invalid Parameter");i=(...e)=>{if(e.length!==r[1].paramCount)throw new Error("Invalid parameters");return r[1].fn(...e)}}return n.reduce(((e,r,a)=>e.then((e=>{a>0&&!0===e&&t.push(n[a-1]);const s=i(r);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.isPromiseLike)(s)?s:(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(s)}))),Promise.resolve(!1)).then((e=>(!0===e&&n.length>0&&t.push(n[n.length-1]),t)))}return (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(r[0])?r[0].load().then((t=>{const n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(r[1],t.getFieldsIndex()),i=n.getVariables();if(i.length>0){const t=[];for(let n=0;n<i.length;n++){const r={name:i[n]};t.push(B.evaluateIdentifier(e,r))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.all)(t).then((e=>{const t={};for(let n=0;n<i.length;n++)t[i[n]]=e[n];return n.parameters=t,new _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_9__["default"]({parentfeatureset:r[0],whereclause:n})}))}return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(new _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_9__["default"]({parentfeatureset:r[0],whereclause:n}))})):B.failDefferred("Filter cannot accept this parameter type")}))},B.signatures.push({name:"filter",min:"2",max:"2"}),B.functions.orderby=function(e,t){return B.standardFunctionAsync(e,t,((e,t,n)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(n,2,2),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(n[0])){const e=new _featureset_support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_14__["default"](n[1]);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(new _featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_10__["default"]({parentfeatureset:n[0],orderbyclause:e}))}return B.failDefferred("Order cannot accept this parameter type")}))},B.signatures.push({name:"orderby",min:"2",max:"2"}),B.functions.top=function(e,t){return B.standardFunctionAsync(e,t,((e,t,n)=>((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(n,2,2),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(n[0])?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(new _featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_11__["default"]({parentfeatureset:n[0],topnum:n[1]})):(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(n[0])?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.t)(n[1])>=n[0].length?n[0].slice(0):n[0].slice(0,(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.t)(n[1])):(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.b)(n[0])?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.t)(n[1])>=n[0].length()?n[0].slice(0):n[0].slice(0,(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.t)(n[1])):B.failDefferred("Top cannot accept this parameter type"))))},B.signatures.push({name:"top",min:"2",max:"2"}),B.functions.first=function(e,t){return B.standardFunctionAsync(e,t,((e,t,r)=>((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(r,1,1),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(r[0])?r[0].first(e.abortSignal).then((e=>{if(null!==e){const t=_Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"].createFromGraphicLikeObject(e.geometry,e.attributes,r[0]);t._underlyingGraphic=e,e=t}return e})):(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(r[0])?0===r[0].length?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(null):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(r[0][0]):(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.b)(r[0])?0===r[0].length()?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(null):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(r[0].get(0)):null)))},B.signatures.push({name:"first",min:"1",max:"1"}),B.functions.attachments=function(e,r){return B.standardFunctionAsync(e,r,((r,i,a)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(a,1,2);const s={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(a.length>1)if(a[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"]){if(a[1].hasField("minsize")&&(s.minsize=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.t)(a[1].field("minsize"))),a[1].hasField("metadata")&&(s.returnMetadata=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.y)(a[1].field("metadata"))),a[1].hasField("maxsize")&&(s.maxsize=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.t)(a[1].field("maxsize"))),a[1].hasField("types")){const e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.V)(a[1].field("types"),!1);e.length>0&&(s.types=e)}}else if(null!==a[1])throw new Error("Invalid Parameter");if(a[0]instanceof _Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]){let t=a[0]._layer;return t instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_20__["default"]&&(t=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSet)(t,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===t||!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(t)?[]:t.load().then((()=>t.queryAttachments(a[0].field(t.objectIdField),s.minsize,s.maxsize,s.types,s.returnMetadata)))}if(null===a[0])return[];throw new Error("Invalid Parameter")}))},B.signatures.push({name:"attachments",min:"1",max:"2"}),B.functions.featuresetbyrelationshipname=function(e,t){return B.standardFunctionAsync(e,t,((t,r,i)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(i,2,4);const a=i[0],s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(i[1]);let l=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(i[2],null);const c=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.y)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(i[3],!0));if(null===l&&(l=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(l))throw new Error("Invalid Parameter");if(null===i[0])return null;if(!(i[0]instanceof _Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]))throw new Error("Invalid Parameter");let d=a._layer;return d instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_20__["default"]&&(d=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSet)(d,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===d||!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(d)?null:d.load().then((t=>{const n=t.relationshipMetaData().filter((e=>e.name===s));if(0===n.length)return null;if(void 0!==n[0].relationshipTableId&&null!==n[0].relationshipTableId&&n[0].relationshipTableId>-1)return (0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromRelationship)(t,n[0],a.field(t.objectIdField),t.spatialReference,l,c,e.lrucache,e.interceptor);let r=t.serviceUrl();return r?(r="/"===r.charAt(r.length-1)?r+n[0].relatedTableId.toString():r+"/"+n[0].relatedTableId.toString(),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromUrl)(r,t.spatialReference,l,c,e.lrucache,e.interceptor).then((e=>e.load().then((()=>e.relationshipMetaData())).then((r=>{if(r=r.filter((e=>e.id===n[0].id)),!1===a.hasField(n[0].keyField)||null===a.field(n[0].keyField))return t.getFeatureByObjectId(a.field(t.objectIdField),[n[0].keyField]).then((t=>{if(t){const i=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(r[0].keyField+"= @id",e.getFieldsIndex());return i.parameters={id:t.attributes[n[0].keyField]},e.filter(i)}return new _featureset_sources_Empty_js__WEBPACK_IMPORTED_MODULE_12__["default"]({parentfeatureset:e})}));const i=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(r[0].keyField+"= @id",e.getFieldsIndex());return i.parameters={id:a.field(n[0].keyField)},e.filter(i)}))))):null}))}))},B.signatures.push({name:"featuresetbyrelationshipname",min:"2",max:"4"}),B.functions.featuresetbyassociation=function(e,t){return B.standardFunctionAsync(e,t,((t,r,i)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(i,2,3);const a=i[0],s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.E)(i[1],"")).toLowerCase(),l=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(i[2])?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(i[2]):null;if(null===i[0])return null;if(!(i[0]instanceof _Feature_js__WEBPACK_IMPORTED_MODULE_2__["default"]))throw new Error("Invalid Parameter");let f=a._layer;return f instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_20__["default"]&&(f=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSet)(f,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===f||!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(f)?null:f.load().then((()=>{const t=f.serviceUrl();return (0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructAssociationMetaDataFeatureSetFromUrl)(t,e.spatialReference)})).then((e=>{let t=null,n=null,r=!1;if(null!==l&&""!==l&&void 0!==l){for(const t of e.terminals)t.terminalName===l&&(n=t.terminalId);null===n&&(r=!0)}const i=e.associations.getFieldsIndex(),o=i.get("TOGLOBALID").name,u=i.get("FROMGLOBALID").name,c=i.get("TOTERMINALID").name,d=i.get("FROMTERMINALID").name,m=i.get("FROMNETWORKSOURCEID").name,p=i.get("TONETWORKSOURCEID").name,y=i.get("ASSOCIATIONTYPE").name,g=i.get("ISCONTENTVISIBLE").name,h=i.get("OBJECTID").name;for(const s of f.fields)if("global-id"===s.type){t=a.field(s.name);break}let F=null,I=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_21__["default"]({name:"percentalong",alias:"percentalong",type:"double"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create("0",e.associations.getFieldsIndex())),E=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_21__["default"]({name:"side",alias:"side",type:"string"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create("''",e.associations.getFieldsIndex()));const D="globalid",w="globalId",b={};for(const a in e.lkp)b[a]=e.lkp[a].sourceId;const A=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.StringToCodeAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_21__["default"]({name:"classname",alias:"classname",type:"string"}),null,b);let N="";switch(s){case"midspan":{N=`((${o}='${t}') OR ( ${u}='${t}')) AND (${y} IN (5))`,A.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(`CASE WHEN (${o}='${t}') THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex());const n=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_15__.cloneField)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,u));n.name=D,n.alias=D,F=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.SqlExpressionAdapted(n,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(`CASE WHEN (${u}='${t}') THEN ${o} ELSE ${u} END`,e.associations.getFieldsIndex())),I=e.unVersion>=4?new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.OriginalField(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,i.get("PERCENTALONG").name)):new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_21__["default"]({name:"percentalong",alias:"percentalong",type:"double"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create("0",e.associations.getFieldsIndex()));break}case"junctionedge":{N=`((${o}='${t}') OR ( ${u}='${t}')) AND (${y} IN (4,6))`,A.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(`CASE WHEN (${o}='${t}') THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex());const n=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_15__.cloneField)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,u));n.name=D,n.alias=D,F=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.SqlExpressionAdapted(n,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(`CASE WHEN (${u}='${t}') THEN ${o} ELSE ${u} END`,e.associations.getFieldsIndex())),E=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_21__["default"]({name:"side",alias:"side",type:"string"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(`CASE WHEN (${y}=4) THEN 'from' ELSE 'to' END`,e.associations.getFieldsIndex()));break}case"connected":{let r=`${o}='@T'`,i=`${u}='@T'`;null!==n&&(r+=` AND ${c}=@A`,i+=` AND ${d}=@A`),N="(("+r+") OR ("+i+"))",N=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.P)(N,"@T",t),r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.P)(r,"@T",t),null!==n&&(r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.P)(r,"@A",n.toString()),N=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.P)(N,"@A",n.toString())),A.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create("CASE WHEN "+r+` THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex());const a=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_15__.cloneField)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,u));a.name=D,a.alias=D,F=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.SqlExpressionAdapted(a,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create("CASE WHEN "+r+` THEN ${u} ELSE ${o} END`,e.associations.getFieldsIndex()));break}case"container":N=`${o}='${t}' AND ${y} = 2`,null!==n&&(N+=` AND ${c} = `+n.toString()),A.codefield=m,N="( "+N+" )",F=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,u),D,D);case"content":N=`(${u}='${t}' AND ${y} = 2)`,null!==n&&(N+=` AND ${d} = `+n.toString()),A.codefield=p,N="( "+N+" )",F=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,o),D,D);break;case"structure":N=`(${o}='${t}' AND ${y} = 3)`,null!==n&&(N+=` AND ${c} = `+n.toString()),A.codefield=m,N="( "+N+" )",F=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,u),D,w);break;case"attached":N=`(${u}='${t}' AND ${y} = 3)`,null!==n&&(N+=` AND ${d} = `+n.toString()),A.codefield=p,N="( "+N+" )",F=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,o),D,w);break;default:throw new Error("Invalid Parameter")}r&&(N="1 <> 1");return new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet({parentfeatureset:e.associations,adaptedFields:[new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.OriginalField(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,h)),new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.OriginalField(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_8__.AdaptedFeatureSet.findField(e.associations.fields,g)),F,E,A,I],extraFilter:N?_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(N,e.associations.getFieldsIndex()):null})}))}))},B.signatures.push({name:"featuresetbyassociation",min:"2",max:"6"}),B.functions.groupby=function(e,n){return B.standardFunctionAsync(e,n,((n,r,i)=>((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(i,3,3),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(i[0])?i[0].load().then((n=>{const r=[],a=[];let s=!1,l=[];if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(i[1]))l.push(i[1]);else if(i[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"])l.push(i[1]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(i[1]))l=i[1];else{if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.b)(i[1]))return B.failDefferred("Illegal Value: GroupBy");l=i[1].toArray()}for(const e of l)if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(e)){const t=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(e),n.getFieldsIndex()),i=!0===(0,_featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_16__.isSingleField)(t)?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(e):"%%%%FIELDNAME";r.push({name:i,expression:t}),"%%%%FIELDNAME"===i&&(s=!0)}else{if(!(e instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"]))return B.failDefferred("Illegal Value: GroupBy");{const t=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",i=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===t&&(s=!0),!t)return B.failDefferred("Illegal Value: GroupBy");r.push({name:t,expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(i||t,n.getFieldsIndex())})}}if(l=[],(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(i[2]))l.push(i[2]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(i[2]))l=i[2];else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.b)(i[2]))l=i[2].toArray();else{if(!(i[2]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"]))return B.failDefferred("Illegal Value: GroupBy");l.push(i[2])}for(const e of l){if(!(e instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"]))return B.failDefferred("Illegal Value: GroupBy");{const t=e.hasField("name")?e.field("name"):"",r=e.hasField("statistic")?e.field("statistic"):"",i=e.hasField("expression")?e.field("expression"):"";if(!t||!r||!i)return B.failDefferred("Illegal Value: GroupBy");a.push({name:t,statistic:r.toLowerCase(),expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(i,n.getFieldsIndex())})}}if(s){const e={};for(const r of n.fields)e[r.name.toLowerCase()]=1;for(const n of r)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);for(const n of a)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of r)if("%%%%FIELDNAME"===n.name){for(;1===e["field_"+t.toString()];)t++;e["field_"+t.toString()]=1,n.name="FIELD_"+t.toString()}}const o=[];for(const t of r)o.push(q(t.expression,B,e));for(const t of a)o.push(q(t.expression,B,e));return o.length>0?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.all)(o).then((()=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(i[0].groupby(r,a)))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(i[0].groupby(r,a))})):B.failDefferred("Illegal Value: GroupBy"))))},B.signatures.push({name:"groupby",min:"3",max:"3"}),B.functions.distinct=function(e,n){return B.standardFunctionAsync(e,n,((n,r,i)=>(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.o)(i[0])?((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.p)(i,2,2),i[0].load().then((n=>{const r=[];let a=[];if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(i[1]))a.push(i[1]);else if(i[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"])a.push(i[1]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.a)(i[1]))a=i[1];else{if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.b)(i[1]))return B.failDefferred("Illegal Value: GroupBy");a=i[1].toArray()}let s=!1;for(const e of a)if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.f)(e)){const t=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(e),n.getFieldsIndex()),i=!0===(0,_featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_16__.isSingleField)(t)?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_7__.d)(e):"%%%%FIELDNAME";r.push({name:i,expression:t}),"%%%%FIELDNAME"===i&&(s=!0)}else{if(!(e instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__["default"]))return B.failDefferred("Illegal Value: GroupBy");{const t=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",i=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===t&&(s=!0),!t)return B.failDefferred("Illegal Value: GroupBy");r.push({name:t,expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_19__.WhereClause.create(i||t,n.getFieldsIndex())})}}if(s){const e={};for(const r of n.fields)e[r.name.toLowerCase()]=1;for(const n of r)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of r)if("%%%%FIELDNAME"===n.name){for(;1===e["field_"+t.toString()];)t++;e["field_"+t.toString()]=1,n.name="FIELD_"+t.toString()}}const l=[];for(const t of r)l.push(q(t.expression,B,e));return l.length>0?(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.all)(l).then((()=>(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(i[0].groupby(r,[])))):(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_18__.resolve)(i[0].groupby(r,[]))}))):J("distinct",n,r,i)))})}


/***/ }),

/***/ "./node_modules/@arcgis/core/core/MD5.js":
/*!***********************************************!*\
  !*** ./node_modules/@arcgis/core/core/MD5.js ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createMD5Hash": () => (/* binding */ x),
/* harmony export */   "outputTypes": () => (/* binding */ n)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n={Base64:0,Hex:1,String:2,Raw:3},t=8,r=(1<<t)-1;function e(n,t){const r=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(r>>16)<<16|65535&r}function o(n){const e=[];for(let o=0,u=n.length*t;o<u;o+=t)e[o>>5]|=(n.charCodeAt(o/t)&r)<<o%32;return e}function u(n){const e=[];for(let o=0,u=32*n.length;o<u;o+=t)e.push(String.fromCharCode(n[o>>5]>>>o%32&r));return e.join("")}function c(n){const t="0123456789abcdef",r=[];for(let e=0,o=4*n.length;e<o;e++)r.push(t.charAt(n[e>>2]>>e%4*8+4&15)+t.charAt(n[e>>2]>>e%4*8&15));return r.join("")}function f(n){const t="=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=[];for(let o=0,u=4*n.length;o<u;o+=3){const u=(n[o>>2]>>o%4*8&255)<<16|(n[o+1>>2]>>(o+1)%4*8&255)<<8|n[o+2>>2]>>(o+2)%4*8&255;for(let c=0;c<4;c++)8*o+6*c>32*n.length?e.push(t):e.push(r.charAt(u>>6*(3-c)&63))}return e.join("")}function s(n,t){return n<<t|n>>>32-t}function i(n,t,r,o,u,c){return e(s(e(e(t,n),e(o,c)),u),r)}function h(n,t,r,e,o,u,c){return i(t&r|~t&e,n,t,o,u,c)}function a(n,t,r,e,o,u,c){return i(t&e|r&~e,n,t,o,u,c)}function l(n,t,r,e,o,u,c){return i(t^r^e,n,t,o,u,c)}function g(n,t,r,e,o,u,c){return i(r^(t|~e),n,t,o,u,c)}function p(n,t){n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;let r=1732584193,o=-271733879,u=-1732584194,c=271733878;for(let f=0;f<n.length;f+=16){const t=r,s=o,i=u,p=c;r=h(r,o,u,c,n[f+0],7,-680876936),c=h(c,r,o,u,n[f+1],12,-389564586),u=h(u,c,r,o,n[f+2],17,606105819),o=h(o,u,c,r,n[f+3],22,-1044525330),r=h(r,o,u,c,n[f+4],7,-176418897),c=h(c,r,o,u,n[f+5],12,1200080426),u=h(u,c,r,o,n[f+6],17,-1473231341),o=h(o,u,c,r,n[f+7],22,-45705983),r=h(r,o,u,c,n[f+8],7,1770035416),c=h(c,r,o,u,n[f+9],12,-1958414417),u=h(u,c,r,o,n[f+10],17,-42063),o=h(o,u,c,r,n[f+11],22,-1990404162),r=h(r,o,u,c,n[f+12],7,1804603682),c=h(c,r,o,u,n[f+13],12,-40341101),u=h(u,c,r,o,n[f+14],17,-1502002290),o=h(o,u,c,r,n[f+15],22,1236535329),r=a(r,o,u,c,n[f+1],5,-165796510),c=a(c,r,o,u,n[f+6],9,-1069501632),u=a(u,c,r,o,n[f+11],14,643717713),o=a(o,u,c,r,n[f+0],20,-373897302),r=a(r,o,u,c,n[f+5],5,-701558691),c=a(c,r,o,u,n[f+10],9,38016083),u=a(u,c,r,o,n[f+15],14,-660478335),o=a(o,u,c,r,n[f+4],20,-405537848),r=a(r,o,u,c,n[f+9],5,568446438),c=a(c,r,o,u,n[f+14],9,-1019803690),u=a(u,c,r,o,n[f+3],14,-187363961),o=a(o,u,c,r,n[f+8],20,1163531501),r=a(r,o,u,c,n[f+13],5,-1444681467),c=a(c,r,o,u,n[f+2],9,-51403784),u=a(u,c,r,o,n[f+7],14,1735328473),o=a(o,u,c,r,n[f+12],20,-1926607734),r=l(r,o,u,c,n[f+5],4,-378558),c=l(c,r,o,u,n[f+8],11,-2022574463),u=l(u,c,r,o,n[f+11],16,1839030562),o=l(o,u,c,r,n[f+14],23,-35309556),r=l(r,o,u,c,n[f+1],4,-1530992060),c=l(c,r,o,u,n[f+4],11,1272893353),u=l(u,c,r,o,n[f+7],16,-155497632),o=l(o,u,c,r,n[f+10],23,-1094730640),r=l(r,o,u,c,n[f+13],4,681279174),c=l(c,r,o,u,n[f+0],11,-358537222),u=l(u,c,r,o,n[f+3],16,-722521979),o=l(o,u,c,r,n[f+6],23,76029189),r=l(r,o,u,c,n[f+9],4,-640364487),c=l(c,r,o,u,n[f+12],11,-421815835),u=l(u,c,r,o,n[f+15],16,530742520),o=l(o,u,c,r,n[f+2],23,-995338651),r=g(r,o,u,c,n[f+0],6,-198630844),c=g(c,r,o,u,n[f+7],10,1126891415),u=g(u,c,r,o,n[f+14],15,-1416354905),o=g(o,u,c,r,n[f+5],21,-57434055),r=g(r,o,u,c,n[f+12],6,1700485571),c=g(c,r,o,u,n[f+3],10,-1894986606),u=g(u,c,r,o,n[f+10],15,-1051523),o=g(o,u,c,r,n[f+1],21,-2054922799),r=g(r,o,u,c,n[f+8],6,1873313359),c=g(c,r,o,u,n[f+15],10,-30611744),u=g(u,c,r,o,n[f+6],15,-1560198380),o=g(o,u,c,r,n[f+13],21,1309151649),r=g(r,o,u,c,n[f+4],6,-145523070),c=g(c,r,o,u,n[f+11],10,-1120210379),u=g(u,c,r,o,n[f+2],15,718787259),o=g(o,u,c,r,n[f+9],21,-343485551),r=e(r,t),o=e(o,s),u=e(u,i),c=e(c,p)}return[r,o,u,c]}function x(r,e=n.Hex){const s=e||n.Base64,i=p(o(r),r.length*t);switch(s){case n.Raw:return i;case n.Hex:return c(i);case n.String:return u(i);case n.Base64:return f(i)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/core/sql/AggregateFunctions.js":
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/core/sql/AggregateFunctions.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "aggregateFunction": () => (/* binding */ a),
/* harmony export */   "isAggregate": () => (/* binding */ n)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function a(a,n){const t=l[a.toLowerCase()];if(null==t)throw new Error("Function Not Recognised");if(n.length<t.minParams||n.length>t.maxParams)throw new Error(`Invalid Parameter count for call to ${a.toUpperCase()}`);return t.evaluate(n)}function n(a,n){const t=l[a.toLowerCase()];return null!=t&&n>=t.minParams&&n<=t.maxParams}const l={min:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.min.apply(Math,a[0])},max:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.max.apply(Math,a[0])},avg:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:t(a[0])},sum:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:r(a[0])},stddev:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sqrt(e(a[0]))},count:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].length},var:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:e(a[0])}};function t(a){let n=0;for(let l=0;l<a.length;l++)n+=a[l];return n/a.length}function r(a){let n=0;for(let l=0;l<a.length;l++)n+=a[l];return n}function e(a){const n=t(a),l=a.length;let r=0;for(const t of a)r+=(t-n)**2;return l>1?r/(l-1):0}


/***/ }),

/***/ "./node_modules/@arcgis/core/core/sql/StandardizedFunctions.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@arcgis/core/core/sql/StandardizedFunctions.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SqlInterval": () => (/* binding */ e),
/* harmony export */   "evaluateFunction": () => (/* binding */ t),
/* harmony export */   "isStandardized": () => (/* binding */ r)
/* harmony export */ });
/* harmony import */ var _string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../string.js */ "./node_modules/@arcgis/core/core/string.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}static fixDefaults(a){if(null!==a.precision||null!==a.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static createFromMilliseconds(a){const t=new e;return t.second=a/1e3,t}static createFromValueAndQualifer(a,t,r){let n=null;const l=new e;if(l.op="-"===r?"-":"+","interval-period"===t.type){e.fixDefaults(t);const r=new RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new Error("Year-Month Intervals not supported");if(!r.test(a))throw new Error("Illegal Interval");l[t.period]=parseFloat(a)}else{if(e.fixDefaults(t.start),e.fixDefaults(t.end),"year"===t.start.period||"month"===t.start.period)throw new Error("Year-Month Intervals not supported");if("year"===t.end.period||"month"===t.end.period)throw new Error("Year-Month Intervals not supported");switch(t.start.period){case"day":switch(t.end.period){case"hour":if(n=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!n.test(a))throw new Error("Illegal Interval");l[t.start.period]=parseFloat(a.split(" ")[0]),l[t.end.period]=parseFloat(a.split(" ")[1]);break;case"minute":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!n.test(a))throw new Error("Illegal Interval");{l[t.start.period]=parseFloat(a.split(" ")[0]);const e=a.split(" ")[1].split(":");l.hour=parseFloat(e[0]),l.minute=parseFloat(e[1])}break;case"second":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(a))throw new Error("Illegal Interval");{l[t.start.period]=parseFloat(a.split(" ")[0]);const e=a.split(" ")[1].split(":");l.hour=parseFloat(e[0]),l.minute=parseFloat(e[1]),l.second=parseFloat(e[2])}break;default:throw"Invalid Interval."}break;case"hour":switch(t.end.period){case"minute":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!n.test(a))throw new Error("Illegal Interval");l.hour=parseFloat(a.split(":")[0]),l.minute=parseFloat(a.split(":")[1]);break;case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(a))throw new Error("Illegal Interval");{const e=a.split(":");l.hour=parseFloat(e[0]),l.minute=parseFloat(e[1]),l.second=parseFloat(e[2])}break;default:throw"Invalid Interval."}break;case"minute":if("second"!==t.end.period)throw"Invalid Interval.";if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(a))throw new Error("Illegal Interval");{const e=a.split(":");l.minute=parseFloat(e[0]),l.second=parseFloat(e[1])}break;default:throw"Invalid Interval."}}return l}valueInMilliseconds(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function t(a,e){const t=n[a.toLowerCase()];if(null==t)throw new Error("Function Not Recognised");if(e.length<t.minParams||e.length>t.maxParams)throw new Error(`Invalid Parameter count for call to ${a.toUpperCase()}`);return t.evaluate(e)}function r(a,e){const t=n[a.toLowerCase()];return null!=t&&e>=t.minParams&&e<=t.maxParams}const n={extract:{minParams:2,maxParams:2,evaluate:([a,e])=>{if(null==e)return null;if(e instanceof Date)switch(a.toUpperCase()){case"SECOND":return e.getSeconds();case"MINUTE":return e.getMinutes();case"HOUR":return e.getHours();case"DAY":return e.getDate();case"MONTH":return e.getMonth()+1;case"YEAR":return e.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(2===a.length){const[e,t]=a;return null==e||null==t?null:e.toString().substring(t-1)}if(3===a.length){const[e,t,r]=a;return null==e||null==t||null==r?null:r<=0?"":e.toString().substring(t-1,t+r-1)}}},position:{minParams:2,maxParams:2,evaluate:([a,e])=>null==a||null==e?null:e.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=3===e.length,r=t?e[1]:" ",n=t?e[2]:e[1];if(null==r||null==n)return null;const l=`(${(0,_string_js__WEBPACK_IMPORTED_MODULE_0__.escapeRegExpString)(r)})`;switch(e[0]){case"BOTH":return n.replace(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return n.replace(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return n.replace(new RegExp(`${l}*$`,"g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0]>0?1:a[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]**a[1]},mod:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const e=a[0],t=2===a.length?10**a[1]:1;return null==e?null:Math.round(e*t)/t}},truncate:{minParams:1,maxParams:2,evaluate:a=>null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>"string"==typeof a[0]||a[0]instanceof String?a[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:a=>{let e="";for(let t=0;t<a.length;t++){if(null==a[t])return null;e+=a[t].toString()}return e}},lower:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toUpperCase()}};


/***/ }),

/***/ "./node_modules/@arcgis/core/core/sql/WhereClause.js":
/*!***********************************************************!*\
  !*** ./node_modules/@arcgis/core/core/sql/WhereClause.js ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WhereClause": () => (/* binding */ m),
/* harmony export */   "defaultAttributeAdapter": () => (/* binding */ F)
/* harmony export */ });
/* harmony import */ var _has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _AggregateFunctions_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AggregateFunctions.js */ "./node_modules/@arcgis/core/core/sql/AggregateFunctions.js");
/* harmony import */ var _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./StandardizedFunctions.js */ "./node_modules/@arcgis/core/core/sql/StandardizedFunctions.js");
/* harmony import */ var _WhereGrammar_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./WhereGrammar.js */ "./node_modules/@arcgis/core/core/sql/WhereGrammar.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,u=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,o=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,h=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,d=new Set(["current_timestamp","current_date","current_time"]);function p(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function v(e,t,a="0",r="0",s="0",n="0",i="",l="0",u="0"){if("+"===i||"-"===i){const o=`${p(parseInt(e,10),4)}-${p(parseInt(t,10),2)}-${p(parseInt(a,10),2)}`;let c="";parseFloat(n)<10&&(c="0");const h=`${p(parseInt(r,10),2)}:${p(parseInt(s,10),2)}:${c+parseFloat(n).toString()}`,d=`${i}${p(parseInt(l,10),2)}:${p(parseInt(u,10),2)}`;return new Date(o+"T"+h+d)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(a,10),parseInt(r,10),parseInt(s,10),parseFloat(n))}class f{static makeBool(e){return T(e)}static featureValue(e,t,a,r){return E(e,t,a,r)}static equalsNull(e){return null===e}static applyLike(e,t,a){return A(e,t,a)}static ensureArray(e){return S(e)}static applyIn(e,t){return J(e,t)}static currentDate(){const e=new Date;return e.setHours(0,0,0,0),e}static makeSqlInterval(e,t,a){return _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval.createFromValueAndQualifer(e,t,a)}static convertInterval(e){return e instanceof _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval?e.valueInMilliseconds():e}static currentTimestamp(){return new Date}static compare(e,t,a){return _(e,t,a)}static calculate(e,t,a){return b(e,t,a)}static makeComparable(e){return D(e)}static evaluateFunction(e,t){return (0,_StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.evaluateFunction)(e,t)}static lookup(e,t){const a=t[e];return void 0===a?null:a}static between(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]}static notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]}static ternaryNot(e){return w(e)}static ternaryAnd(e,t){return y(e,t)}static ternaryOr(e,t){return I(e,t)}}class m{constructor(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this._hasDateFunctions=void 0,this.parseTree=_WhereGrammar_js__WEBPACK_IMPORTED_MODULE_3__.WhereGrammar.parse(e);const{isStandardized:a,isAggregate:r,referencedFieldNames:s}=this.extractExpressionInfo(t);this.referencedFieldNames=s,this.isStandardized=a,this.isAggregate=r}static create(e,t){return new m(e,t)}get fieldNames(){return this.referencedFieldNames}testSet(e,t=F){const a={};for(const r of this.fieldNames)a[r]=e.map((e=>t.getAttribute(e,r)));return!!this.evaluateNode(this.parseTree,{attributes:a},F)}calculateValue(e,t=F){const a=this.evaluateNode(this.parseTree,e,t);return a instanceof _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval?a.valueInMilliseconds()/864e5:a}calculateValueCompiled(t,a=F){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(t,this.parameters,a,this.datefields):(0,_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-csp-restrictions")?this.calculateValue(t,a):(this.compileMe(),this.parseTree._compiledVersion(t,this.parameters,a,this.datefields))}testFeature(e,t=F){return!!this.evaluateNode(this.parseTree,e,t)}testFeatureCompiled(t,a=F){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(t,this.parameters,a,this.datefields):(0,_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-csp-restrictions")?this.testFeature(t,a):(this.compileMe(),!!this.parseTree._compiledVersion(t,this.parameters,a,this.datefields))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,this.visitAll(this.parseTree,(e=>{"current_time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||d.has(e.name.toLowerCase()))}))),this._hasDateFunctions}getFunctions(){const e=new Set;return this.visitAll(this.parseTree,(t=>{"function"===t.type&&e.add(t.name.toLowerCase())})),Array.from(e)}getExpressions(){const e=new Map;return this.visitAll(this.parseTree,(t=>{if("function"===t.type){const a=t.name.toLowerCase(),r=t.args.value[0];if("column_ref"===r.type){const t=r.column,s=`${a}-${t}`;e.has(s)||e.set(s,{aggregateType:a,field:t})}}})),[...e.values()]}getVariables(){const e=new Set;return this.visitAll(this.parseTree,(t=>{"param"===t.type&&e.add(t.value.toLowerCase())})),Array.from(e)}compileMe(){const e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(f)}extractExpressionInfo(e){const a=[],r=new Set;let n=!0,i=!0;return this.visitAll(this.parseTree,(l=>{switch(l.type){case"column_ref":{const t=e.get(l.column);let s,n;t?s=n=t.name:(n=l.column,s=n.toLowerCase()),!t||"date"!==t.type&&"esriFieldTypeDate"!==t.type||(this.datefields[t.name]=1),r.has(s)||(r.add(s),a.push(n)),l.column=n;break}case"function":{const{name:e,args:a}=l,r=a.value.length;n&&(n=(0,_StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.isStandardized)(e,r)),i&&(i=(0,_AggregateFunctions_js__WEBPACK_IMPORTED_MODULE_1__.isAggregate)(e,r));break}}})),{referencedFieldNames:Array.from(a),isStandardized:n,isAggregate:i}}visitAll(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(const a of e.clauses)this.visitAll(a,t);"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(const a of e.value)this.visitAll(a,t);break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":{let t="";if("simple"===e.format){const a="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(let r=0;r<e.clauses.length;r++)t+=" ("+a+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[r].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let a=0;a<e.clauses.length;a++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[a].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[a].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":{let t="[";for(const a of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(a);return t+="]",t}case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+g(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+N(e.value).getTime().toString()+"))";case"current_time":return"date"===e.mode?"this.currentDate()":"this.currentTimestamp()";case"column_ref":return"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)}evaluateNode(e,t,s){switch(e.type){case"interval":{const a=this.evaluateNode(e.value,t,s);return _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval.createFromValueAndQualifer(a,e.qualifier,e.op)}case"case_expression":if("simple"===e.format){const a=D(this.evaluateNode(e.operand,t,s));for(let r=0;r<e.clauses.length;r++)if(a===D(this.evaluateNode(e.clauses[r].operand,t,s)))return this.evaluateNode(e.clauses[r].value,t,s);if(null!==e.else)return this.evaluateNode(e.else,t,s)}else{for(let a=0;a<e.clauses.length;a++)if(T(this.evaluateNode(e.clauses[a].operand,t,s)))return this.evaluateNode(e.clauses[a].value,t,s);if(null!==e.else)return this.evaluateNode(e.else,t,s)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":{const a=[];for(const r of e.value)a.push(this.evaluateNode(r,t,s));return a}case"unary_expr":return w(this.evaluateNode(e.expr,t,s));case"binary_expr":switch(e.operator){case"AND":return y(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s));case"OR":return I(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,s);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,s);case"IN":{const a=S(this.evaluateNode(e.right,t,s));return J(this.evaluateNode(e.left,t,s),a)}case"NOT IN":{const a=S(this.evaluateNode(e.right,t,s));return w(J(this.evaluateNode(e.left,t,s),a))}case"BETWEEN":{const a=this.evaluateNode(e.left,t,s),r=this.evaluateNode(e.right,t,s);return null==a||null==r[0]||null==r[1]?null:a>=D(r[0])&&a<=D(r[1])}case"NOTBETWEEN":{const a=this.evaluateNode(e.left,t,s),r=this.evaluateNode(e.right,t,s);return null==a||null==r[0]||null==r[1]?null:a<D(r[0])||a>D(r[1])}case"LIKE":return A(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s),e.escape);case"NOT LIKE":return w(A(this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return _(e.operator,this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s));case"-":case"+":case"*":case"/":return b(e.operator,this.evaluateNode(e.left,t,s),this.evaluateNode(e.right,t,s))}case"null":case"bool":case"string":case"number":return e.value;case"date":return g(e.value);case"timestamp":return N(e.value);case"current_time":{const t=new Date;return"date"===e.mode&&t.setHours(0,0,0,0),t}case"column_ref":return E(t,e.column,this.datefields,s);case"function":{const r=this.evaluateNode(e.args,t,s);return this.isAggregate?(0,_AggregateFunctions_js__WEBPACK_IMPORTED_MODULE_1__.aggregateFunction)(e.name,r):(0,_StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.evaluateFunction)(e.name,r)}}throw new Error("Unsupported sql syntax "+e.type)}}function N(e){let t=u.exec(e);if(null!==t){const[,e,a,r,s,n,i]=t;return v(e,a,r,s,n,i)}if(t=o.exec(e),null!==t){const[,e,a,r,s,n,i,l,u,o]=t;return v(e,a,r,s,n,i,l,u,o)}if(t=c.exec(e),null!==t){const[,e,a,r,s,n,i,l,u]=t;return v(e,a,r,s,n,"0",i,l,u)}if(t=h.exec(e),null!==t){const[,e,a,r,s,n]=t;return v(e,a,r,s,n)}if(t=l.exec(e),null!==t){const[,e,a,r]=t;return v(e,a,r)}throw new Error("SQL Invalid Timestamp")}function g(e){const t=l.exec(e);if(null===t)throw new Error("SQL Invalid Date");const[,a,r,s]=t;return new Date(parseInt(a,10),parseInt(r,10)-1,parseInt(s,10))}function T(e){return!0===e}function S(e){return Array.isArray(e)?e:[e]}function w(e){return null!==e?!0!==e:null}function y(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function I(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function J(e,t){if(null==e)return null;let a=!1;for(const r of t)if(null==r)a=null;else if(e===r){a=!0;break}return a}function A(e,t,a){if(null==e)return null;const r=t,s=a;let n="";const i="-[]/{}()*+?.\\^$|";let l=0;for(let u=0;u<r.length;u++){const e=r.charAt(u);switch(l){case 0:e===s?l=1:i.indexOf(e)>=0?n+="\\"+e:n+="%"===e?".*":"_"===e?".":e;break;case 1:i.indexOf(e)>=0?n+="\\"+e:n+=e,l=0}}return new RegExp("^"+n+"$").test(e)}function D(e){return e instanceof Date?e.valueOf():e}function _(e,t,a){if(null==t||null==a)return null;const r=D(t),s=D(a);switch(e){case"<>":return r!==s;case"=":return r===s;case">":return r>s;case"<":return r<s;case">=":return r>=s;case"<=":return r<=s}}function b(e,t,a){if(t instanceof _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval)if(a instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+a.getTime());case"-":return t.valueInMilliseconds()-a.getTime();case"*":return t.valueInMilliseconds()*a.getTime();case"/":return t.valueInMilliseconds()/a.getTime()}else if(a instanceof _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval)switch(e){case"+":return _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()+a.valueInMilliseconds());case"-":return _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()-a.valueInMilliseconds());case"*":return t.valueInMilliseconds()*a.valueInMilliseconds();case"/":return t.valueInMilliseconds()/a.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(a instanceof _StandardizedFunctions_js__WEBPACK_IMPORTED_MODULE_2__.SqlInterval)if(t instanceof Date)switch(e){case"+":return new Date(a.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-a.valueInMilliseconds());case"*":return t.getTime()*a.valueInMilliseconds();case"/":return t.getTime()/a.valueInMilliseconds()}else a=a.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof a)switch(a=24*a*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+a);case"-":return new Date(t-a);case"*":return new Date(t*a);case"/":return new Date(t/a)}else if(a instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,a=a.getTime(),e){case"+":return new Date(t+a);case"-":return new Date(t-a);case"*":return new Date(t*a);case"/":return new Date(t/a)}switch(e){case"+":return t+a;case"-":return t-a;case"*":return t*a;case"/":return t/a}}function x(e){return e&&"object"==typeof e.attributes}function E(e,t,a,r){const s=r.getAttribute(e,t);return null!=s&&1===a[t]?new Date(s):s}const F={getAttribute:(e,t)=>(x(e)?e.attributes:e)[t]};


/***/ }),

/***/ "./node_modules/@arcgis/core/core/sql/WhereGrammar.js":
/*!************************************************************!*\
  !*** ./node_modules/@arcgis/core/core/sql/WhereGrammar.js ***!
  \************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WhereGrammar": () => (/* binding */ u)
/* harmony export */ });
/* harmony import */ var _chunks_commonjsHelpers_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../chunks/_commonjsHelpers.js */ "./node_modules/@arcgis/core/chunks/_commonjsHelpers.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var n,t,e={exports:{}};t=function(){function r(r,n){function t(){this.constructor=r}t.prototype=n.prototype,r.prototype=new t}function n(r,t,e,u){var o=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(o,n.prototype),o.expected=t,o.found=e,o.location=u,o.name="SyntaxError",o}function t(r,n,t){return t=t||" ",r.length>n?r:(n-=r.length,r+(t+=t.repeat(n)).slice(0,n))}function e(r,t){var e,u={},o=(t=void 0!==t?t:{}).grammarSource,i={start:Ue},a=Ue,c="!",s="=",f=">=",l=">",v="<=",p="<>",d="<",h="!=",b="+",y="-",A="*",g="/",C="@",m="'",E="N'",x="''",L=".",T="null",w="true",N="false",O="in",_="is",R="like",I="escape",F="not",S="and",M="or",D="between",H="from",U="for",j="substring",P="extract",B="trim",z="position",G="timestamp",Z="date",W="leading",Y="trailing",k="both",q="to",K="interval",V="year",X="month",$="day",J="hour",Q="minute",rr="second",nr="case",tr="end",er="when",ur="then",or="else",ir=",",ar="(",cr=")",sr="`",fr=/^[A-Za-z_\x80-\uFFFF]/,lr=/^[A-Za-z0-9_]/,vr=/^[A-Za-z0-9_.\x80-\uFFFF]/,pr=/^[^']/,dr=/^[0-9]/,hr=/^[eE]/,br=/^[+\-]/,yr=/^[ \t\n\r]/,Ar=/^[^`]/,gr=Re("!",!1),Cr=Re("=",!1),mr=Re(">=",!1),Er=Re(">",!1),xr=Re("<=",!1),Lr=Re("<>",!1),Tr=Re("<",!1),wr=Re("!=",!1),Nr=Re("+",!1),Or=Re("-",!1),_r=Re("*",!1),Rr=Re("/",!1),Ir=Ie([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),Fr=Ie([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Sr=Ie([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),Mr=Re("@",!1),Dr=Re("'",!1),Hr=Re("N'",!1),Ur=Re("''",!1),jr=Ie(["'"],!0,!1),Pr=Re(".",!1),Br=Ie([["0","9"]],!1,!1),zr=Ie(["e","E"],!1,!1),Gr=Ie(["+","-"],!1,!1),Zr=Re("NULL",!0),Wr=Re("TRUE",!0),Yr=Re("FALSE",!0),kr=Re("IN",!0),qr=Re("IS",!0),Kr=Re("LIKE",!0),Vr=Re("ESCAPE",!0),Xr=Re("NOT",!0),$r=Re("AND",!0),Jr=Re("OR",!0),Qr=Re("BETWEEN",!0),rn=Re("FROM",!0),nn=Re("FOR",!0),tn=Re("SUBSTRING",!0),en=Re("EXTRACT",!0),un=Re("TRIM",!0),on=Re("POSITION",!0),an=Re("TIMESTAMP",!0),cn=Re("DATE",!0),sn=Re("LEADING",!0),fn=Re("TRAILING",!0),ln=Re("BOTH",!0),vn=Re("TO",!0),pn=Re("INTERVAL",!0),dn=Re("YEAR",!0),hn=Re("MONTH",!0),bn=Re("DAY",!0),yn=Re("HOUR",!0),An=Re("MINUTE",!0),gn=Re("SECOND",!0),Cn=Re("CASE",!0),mn=Re("END",!0),En=Re("WHEN",!0),xn=Re("THEN",!0),Ln=Re("ELSE",!0),Tn=Re(",",!1),wn=Re("(",!1),Nn=Re(")",!1),On=Ie([" ","\t","\n","\r"],!1,!1),_n=Re("`",!1),Rn=Ie(["`"],!0,!1),In=function(r){return r},Fn=function(r,n){var t={type:"expr_list"},e=jo(r,n);return t.value=e,t},Sn=function(r,n){return Po(r,n)},Mn=function(r){return Do("NOT",r)},Dn=function(r,n){return""==n||null==n||null==n?r:"arithmetic"==n.type?Po(r,n.tail):Ho(n.op,r,n.right,n.escape)},Hn=function(r){return{type:"arithmetic",tail:r}},Un=function(r,n){return{op:r+"NOT",right:n}},jn=function(r,n){return{op:r,right:n}},Pn=function(r,n,t){return{op:"NOT"+r,right:{type:"expr_list",value:[n,t]}}},Bn=function(r,n,t){return{op:r,right:{type:"expr_list",value:[n,t]}}},zn=function(r){return r[0]+" "+r[2]},Gn=function(r,n,t){return{op:r,right:n,escape:t.value}},Zn=function(r,n){return{op:r,right:n,escape:""}},Wn=function(r,n){return{op:r,right:n}},Yn=function(r){return{op:r,right:{type:"expr_list",value:[]}}},kn=function(r,n){return{op:r,right:n}},qn=function(r,n){return Po(r,n)},Kn=function(r){return r.paren=!0,r},Vn=function(r){return/^CURRENT_DATE$/i.test(r)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(r)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:r}},Xn=function(r){return r},$n=function(r,n){return r+n.join("")},Jn=function(r){return{type:"param",value:r[1]}},Qn=function(r,n){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:r},n]}}},rt=function(r,n,t){return{type:"function",name:"substring",args:{type:"expr_list",value:t?[r,n,t[2]]:[r,n]}}},nt=function(r,n,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==r?"BOTH":r},n,t]}}},tt=function(r,n){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==r?"BOTH":r},n]}}},et=function(r,n){return{type:"function",name:"position",args:{type:"expr_list",value:[r,n]}}},ut=function(r,n){return{type:"function",name:r,args:n||{type:"expr_list",value:[]}}},ot=function(r){return{type:"timestamp",value:r.value}},it=function(r,n,t){return{type:"interval",value:n,qualifier:t,op:r}},at=function(r,n){return{type:"interval",value:r,qualifier:n,op:""}},ct=function(r,n){return{type:"interval-qualifier",start:r,end:n}},st=function(r,n){return{type:"interval-period",period:r.value,precision:n,secondary:null}},ft=function(r){return{type:"interval-period",period:r.value,precision:null,secondary:null}},lt=function(r){return{type:"interval-period",period:r.value,precision:null,secondary:null}},vt=function(r,n){return{type:"interval-period",period:"second",precision:r,secondary:n}},pt=function(r){return{type:"interval-period",period:"second",precision:r,secondary:null}},dt=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},ht=function(r,n){return{type:"interval-period",period:r.value,precision:n,secondary:null}},bt=function(r){return{type:"interval-period",period:"second",precision:r,secondary:null}},yt=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},At=function(){return{type:"string",value:"day"}},gt=function(){return{type:"string",value:"hour"}},Ct=function(){return{type:"string",value:"minute"}},mt=function(){return{type:"string",value:"month"}},Et=function(){return{type:"string",value:"year"}},xt=function(r){return parseFloat(r)},Lt=function(r){return{type:"date",value:r.value}},Tt=function(){return{type:"null",value:null}},wt=function(){return{type:"bool",value:!0}},Nt=function(){return{type:"bool",value:!1}},Ot=function(){return"'"},_t=function(r){return{type:"string",value:r.join("")}},Rt=function(r,n){return{type:"case_expression",format:"simple",operand:r,clauses:n,else:null}},It=function(r,n,t){return{type:"case_expression",format:"simple",operand:r,clauses:n,else:t.value}},Ft=function(r){return{type:"case_expression",format:"searched",clauses:r,else:null}},St=function(r,n){return{type:"case_expression",format:"searched",clauses:r,else:n.value}},Mt=function(r,n){return{type:"when_clause",operand:r,value:n}},Dt=function(r){return{type:"else_clause",value:r}},Ht=function(r){return{type:"number",value:r}},Ut=function(r,n,t){return parseFloat(r+n+t)},jt=function(r,n){return parseFloat(r+n)},Pt=function(r,n){return parseFloat(r+n)},Bt=function(r){return parseFloat(r)},zt=function(r,n){return r[0]+n},Gt=function(r){return"."+(null!=r?r:"")},Zt=function(r,n){return r+n},Wt=function(r){return r.join("")},Yt=function(r,n){return"e"+(null===n?"":n)},kt=function(){return"IN"},qt=function(){return"IS"},Kt=function(){return"LIKE"},Vt=function(){return"ESCAPE"},Xt=function(){return"NOT"},$t=function(){return"AND"},Jt=function(){return"OR"},Qt=function(){return"BETWEEN"},re=function(){return"FROM"},ne=function(){return"FOR"},te=function(){return"SUBSTRING"},ee=function(){return"EXTRACT"},ue=function(){return"TRIM"},oe=function(){return"POSITION"},ie=function(){return"TIMESTAMP"},ae=function(){return"DATE"},ce=function(){return"LEADING"},se=function(){return"TRAILING"},fe=function(){return"BOTH"},le=function(){return"TO"},ve=function(){return"INTERVAL"},pe=function(){return"YEAR"},de=function(){return"MONTH"},he=function(){return"DAY"},be=function(){return"HOUR"},ye=function(){return"MINUTE"},Ae=function(){return"SECOND"},ge=function(){return"CASE"},Ce=function(){return"END"},me=function(){return"WHEN"},Ee=function(){return"THEN"},xe=function(){return"ELSE"},Le=function(r){return r.join("")},Te=0,we=[{line:1,column:1}],Ne=0,Oe=[],_e=0;if("startRule"in t){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=i[t.startRule]}function Re(r,n){return{type:"literal",text:r,ignoreCase:n}}function Ie(r,n,t){return{type:"class",parts:r,inverted:n,ignoreCase:t}}function Fe(){return{type:"end"}}function Se(n){var t,e=we[n];if(e)return e;for(t=n-1;!we[t];)t--;for(e={line:(e=we[t]).line,column:e.column};t<n;)10===r.charCodeAt(t)?(e.line++,e.column=1):e.column++,t++;return we[n]=e,e}function Me(r,n){var t=Se(r),e=Se(n);return{source:o,start:{offset:r,line:t.line,column:t.column},end:{offset:n,line:e.line,column:e.column}}}function De(r){Te<Ne||(Te>Ne&&(Ne=Te,Oe=[]),Oe.push(r))}function He(r,t,e){return new n(n.buildMessage(r,t),r,t,e)}function Ue(){var r,n;return r=Te,Fo(),(n=Pe())!==u?(Fo(),r=In(n)):(Te=r,r=u),r}function je(){var r,n,t,e,o,i,a,c;if(r=Te,(n=Pe())!==u){for(t=[],e=Te,o=Fo(),(i=_o())!==u?(a=Fo(),(c=Pe())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);e!==u;)t.push(e),e=Te,o=Fo(),(i=_o())!==u?(a=Fo(),(c=Pe())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);r=Fn(n,t)}else Te=r,r=u;return r}function Pe(){var r,n,t,e,o,i,a,c;if(r=Te,(n=Be())!==u){for(t=[],e=Te,o=Fo(),(i=to())!==u?(a=Fo(),(c=Be())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);e!==u;)t.push(e),e=Te,o=Fo(),(i=to())!==u?(a=Fo(),(c=Be())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);r=Sn(n,t)}else Te=r,r=u;return r}function Be(){var r,n,t,e,o,i,a,c;if(r=Te,(n=ze())!==u){for(t=[],e=Te,o=Fo(),(i=no())!==u?(a=Fo(),(c=ze())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);e!==u;)t.push(e),e=Te,o=Fo(),(i=no())!==u?(a=Fo(),(c=ze())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);r=Sn(n,t)}else Te=r,r=u;return r}function ze(){var n,t,e,o,i;return n=Te,(t=ro())===u&&(t=Te,33===r.charCodeAt(Te)?(e=c,Te++):(e=u,0===_e&&De(gr)),e!==u?(o=Te,_e++,61===r.charCodeAt(Te)?(i=s,Te++):(i=u,0===_e&&De(Cr)),_e--,i===u?o=void 0:(Te=o,o=u),o!==u?t=e=[e,o]:(Te=t,t=u)):(Te=t,t=u)),t!==u?(e=Fo(),(o=ze())!==u?n=Mn(o):(Te=n,n=u)):(Te=n,n=u),n===u&&(n=Ge()),n}function Ge(){var r,n,t;return r=Te,(n=Je())!==u?(Fo(),(t=Ze())===u&&(t=null),r=Dn(n,t)):(Te=r,r=u),r}function Ze(){var r;return(r=We())===u&&(r=$e())===u&&(r=qe())===u&&(r=ke())===u&&(r=Xe()),r}function We(){var r,n,t,e,o,i;if(r=[],n=Te,t=Fo(),(e=Ye())!==u?(o=Fo(),(i=Je())!==u?n=t=[t,e,o,i]:(Te=n,n=u)):(Te=n,n=u),n!==u)for(;n!==u;)r.push(n),n=Te,t=Fo(),(e=Ye())!==u?(o=Fo(),(i=Je())!==u?n=t=[t,e,o,i]:(Te=n,n=u)):(Te=n,n=u);else r=u;return r!==u&&(r=Hn(r)),r}function Ye(){var n;return r.substr(Te,2)===f?(n=f,Te+=2):(n=u,0===_e&&De(mr)),n===u&&(62===r.charCodeAt(Te)?(n=l,Te++):(n=u,0===_e&&De(Er)),n===u&&(r.substr(Te,2)===v?(n=v,Te+=2):(n=u,0===_e&&De(xr)),n===u&&(r.substr(Te,2)===p?(n=p,Te+=2):(n=u,0===_e&&De(Lr)),n===u&&(60===r.charCodeAt(Te)?(n=d,Te++):(n=u,0===_e&&De(Tr)),n===u&&(61===r.charCodeAt(Te)?(n=s,Te++):(n=u,0===_e&&De(Cr)),n===u&&(r.substr(Te,2)===h?(n=h,Te+=2):(n=u,0===_e&&De(wr)))))))),n}function ke(){var r,n,t,e;return r=Te,(n=$u())!==u?(Fo(),(t=ro())!==u?(Fo(),(e=Je())!==u?r=Un(n,e):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=$u())!==u?(Fo(),(t=Je())!==u?r=jn(n,t):(Te=r,r=u)):(Te=r,r=u)),r}function qe(){var r,n,t,e,o,i;return r=Te,(n=ro())!==u?(Fo(),(t=eo())!==u?(Fo(),(e=Je())!==u?(Fo(),(o=no())!==u?(Fo(),(i=Je())!==u?r=Pn(t,e,i):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=eo())!==u?(Fo(),(t=Je())!==u?(Fo(),(e=no())!==u?(Fo(),(o=Je())!==u?r=Bn(n,t,o):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)),r}function Ke(){var r,n,t,e,o;return r=Te,n=Te,(t=ro())!==u?(e=Fo(),(o=Ju())!==u?n=t=[t,e,o]:(Te=n,n=u)):(Te=n,n=u),n!==u&&(n=zn(n)),(r=n)===u&&(r=Ju()),r}function Ve(){var r,n,t,e,o;return r=Te,n=Te,(t=ro())!==u?(e=Fo(),(o=Xu())!==u?n=t=[t,e,o]:(Te=n,n=u)):(Te=n,n=u),n!==u&&(n=zn(n)),(r=n)===u&&(r=Xu()),r}function Xe(){var r,n,t,e;return r=Te,(n=Ke())!==u?(Fo(),(t=Iu())!==u?(Fo(),Qu()!==u?(Fo(),(e=Fu())!==u?r=Gn(n,t,e):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=Ke())!==u?(Fo(),(t=Iu())!==u?r=Zn(n,t):(Te=r,r=u)):(Te=r,r=u)),r}function $e(){var r,n,t,e;return r=Te,(n=Ve())!==u?(Fo(),(t=Ro())!==u?(Fo(),(e=je())!==u?(Fo(),Io()!==u?r=Wn(n,e):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=Ve())!==u?(Fo(),(t=Ro())!==u?(Fo(),(e=Io())!==u?r=Yn(n):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=Ve())!==u?(Fo(),(t=fu())!==u?r=kn(n,t):(Te=r,r=u)):(Te=r,r=u))),r}function Je(){var r,n,t,e,o,i,a,c;if(r=Te,(n=ru())!==u){for(t=[],e=Te,o=Fo(),(i=Qe())!==u?(a=Fo(),(c=ru())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);e!==u;)t.push(e),e=Te,o=Fo(),(i=Qe())!==u?(a=Fo(),(c=ru())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);r=Sn(n,t)}else Te=r,r=u;return r}function Qe(){var n;return 43===r.charCodeAt(Te)?(n=b,Te++):(n=u,0===_e&&De(Nr)),n===u&&(45===r.charCodeAt(Te)?(n=y,Te++):(n=u,0===_e&&De(Or))),n}function ru(){var r,n,t,e,o,i,a,c;if(r=Te,(n=tu())!==u){for(t=[],e=Te,o=Fo(),(i=nu())!==u?(a=Fo(),(c=tu())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);e!==u;)t.push(e),e=Te,o=Fo(),(i=nu())!==u?(a=Fo(),(c=tu())!==u?e=o=[o,i,a,c]:(Te=e,e=u)):(Te=e,e=u);r=qn(n,t)}else Te=r,r=u;return r}function nu(){var n;return 42===r.charCodeAt(Te)?(n=A,Te++):(n=u,0===_e&&De(_r)),n===u&&(47===r.charCodeAt(Te)?(n=g,Te++):(n=u,0===_e&&De(Rr))),n}function tu(){var r,n;return(r=Au())===u&&(r=lu())===u&&(r=vu())===u&&(r=pu())===u&&(r=hu())===u&&(r=bu())===u&&(r=Su())===u&&(r=eu())===u&&(r=fu())===u&&(r=Te,Ro()!==u?(Fo(),(n=Pe())!==u?(Fo(),Io()!==u?r=Kn(n):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)),r}function eu(){var r;return(r=uu())!==u&&(r=Vn(r)),r}function uu(){var r;return(r=ou())!==u&&(r=Xn(r)),r}function ou(){var r,n,t,e;if(r=Te,(n=au())!==u){for(t=[],e=su();e!==u;)t.push(e),e=su();r=$n(n,t)}else Te=r,r=u;return r}function iu(){var r,n,t,e;if(r=Te,(n=au())!==u){for(t=[],e=cu();e!==u;)t.push(e),e=cu();r=$n(n,t)}else Te=r,r=u;return r}function au(){var n;return fr.test(r.charAt(Te))?(n=r.charAt(Te),Te++):(n=u,0===_e&&De(Ir)),n}function cu(){var n;return lr.test(r.charAt(Te))?(n=r.charAt(Te),Te++):(n=u,0===_e&&De(Fr)),n}function su(){var n;return vr.test(r.charAt(Te))?(n=r.charAt(Te),Te++):(n=u,0===_e&&De(Sr)),n}function fu(){var n,t,e;return n=Te,64===r.charCodeAt(Te)?(t=C,Te++):(t=u,0===_e&&De(Mr)),t!==u&&(e=iu())!==u?n=t=[t,e]:(Te=n,n=u),n!==u&&(n=Jn(n)),n}function lu(){var r,n,t;return r=Te,ao()!==u?(Fo(),Ro()!==u?(Fo(),(n=yu())!==u?(Fo(),uo()!==u?(Fo(),(t=Pe())!==u?(Fo(),Io()!==u?r=Qn(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r}function vu(){var r,n,t,e,o,i,a;return r=Te,io()!==u?(Fo(),Ro()!==u?(Fo(),(n=Pe())!==u?(Fo(),uo()!==u?(Fo(),(t=Pe())!==u?(Fo(),e=Te,(o=oo())!==u?(i=Fo(),(a=Pe())!==u?e=o=[o,i,a,Fo()]:(Te=e,e=u)):(Te=e,e=u),e===u&&(e=null),(o=Io())!==u?r=rt(n,t,e):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r}function pu(){var r,n,t,e;return r=Te,co()!==u?(Fo(),Ro()!==u?(Fo(),(n=du())===u&&(n=null),Fo(),(t=Pe())!==u?(Fo(),uo()!==u?(Fo(),(e=Pe())!==u?(Fo(),Io()!==u?r=nt(n,t,e):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,co()!==u?(Fo(),Ro()!==u?(Fo(),(n=du())===u&&(n=null),Fo(),(t=Pe())!==u?(Fo(),Io()!==u?r=tt(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)),r}function du(){var r;return(r=vo())===u&&(r=po())===u&&(r=ho()),r}function hu(){var r,n,t;return r=Te,so()!==u?(Fo(),Ro()!==u?(Fo(),(n=Pe())!==u?(Fo(),Xu()!==u?(Fo(),(t=Pe())!==u?(Fo(),Io()!==u?r=et(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r}function bu(){var r,n,t;return r=Te,(n=Mo())!==u?(Fo(),Ro()!==u?(Fo(),(t=je())===u&&(t=null),Fo(),Io()!==u?r=ut(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r}function yu(){var r;return(r=Ao())===u&&(r=go())===u&&(r=Co())===u&&(r=mo())===u&&(r=Eo())===u&&(r=xo()),r}function Au(){var r;return(r=Fu())===u&&(r=Pu())===u&&(r=Ru())===u&&(r=_u())===u&&(r=Ou())===u&&(r=gu())===u&&(r=Cu()),r}function gu(){var r,n;return r=Te,fo()!==u?(Fo(),(n=Iu())!==u?r=ot(n):(Te=r,r=u)):(Te=r,r=u),r}function Cu(){var n,t,e,o;return n=Te,yo()!==u?(Fo(),45===r.charCodeAt(Te)?(t=y,Te++):(t=u,0===_e&&De(Or)),t===u&&(43===r.charCodeAt(Te)?(t=b,Te++):(t=u,0===_e&&De(Nr))),t!==u?(Fo(),(e=Iu())!==u?(Fo(),(o=mu())!==u?n=it(t,e,o):(Te=n,n=u)):(Te=n,n=u)):(Te=n,n=u)):(Te=n,n=u),n===u&&(n=Te,yo()!==u?(Fo(),(t=Iu())!==u?(Fo(),(e=mu())!==u?n=at(t,e):(Te=n,n=u)):(Te=n,n=u)):(Te=n,n=u)),n}function mu(){var r,n,t;return r=Te,(n=Eu())!==u?(Fo(),bo()!==u?(Fo(),(t=xu())!==u?r=ct(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Lu()),r}function Eu(){var r,n,t;return r=Te,(n=Tu())!==u?(Fo(),Ro()!==u?(Fo(),(t=Nu())!==u?(Fo(),Io()!==u?r=st(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=Tu())!==u&&(n=ft(n)),r=n),r}function xu(){var r,n,t,e;return r=Te,(n=Tu())!==u&&(n=lt(n)),(r=n)===u&&(r=Te,(n=xo())!==u?(Fo(),Ro()!==u?(Fo(),(t=Nu())!==u?(Fo(),_o()!==u?(Fo(),(e=wu())!==u?(Fo(),Io()!==u?r=vt(t,e):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=xo())!==u?(Fo(),Ro()!==u?(Fo(),(t=Nu())!==u?(Fo(),Io()!==u?r=pt(t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=xo())!==u&&(n=dt()),r=n))),r}function Lu(){var r,n,t,e;return r=Te,(n=Tu())!==u?(Fo(),Ro()!==u?(Fo(),(t=wu())!==u?(Fo(),Io()!==u?r=ht(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=Tu())!==u&&(n=ft(n)),(r=n)===u&&(r=Te,(n=xo())!==u?(Fo(),Ro()!==u?(Fo(),(t=Nu())!==u?(Fo(),_o()!==u?(Fo(),(e=wu())!==u?(Fo(),Io()!==u?r=vt(t,e):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=xo())!==u?(Fo(),Ro()!==u?(Fo(),(t=wu())!==u?(Fo(),Io()!==u?r=bt(t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r===u&&(r=Te,(n=xo())!==u&&(n=yt()),r=n)))),r}function Tu(){var r,n;return r=Te,(n=Co())!==u&&(n=At()),(r=n)===u&&(r=Te,(n=mo())!==u&&(n=gt()),(r=n)===u&&(r=Te,(n=Eo())!==u&&(n=Ct()),(r=n)===u&&(r=Te,(n=go())!==u&&(n=mt()),(r=n)===u&&(r=Te,(n=Ao())!==u&&(n=Et()),r=n)))),r}function wu(){var r;return(r=Wu())!==u&&(r=xt(r)),r}function Nu(){var r;return(r=Wu())!==u&&(r=xt(r)),r}function Ou(){var r,n;return r=Te,lo()!==u?(Fo(),(n=Iu())!==u?r=Lt(n):(Te=r,r=u)):(Te=r,r=u),r}function _u(){var r;return(r=qu())!==u&&(r=Tt()),r}function Ru(){var r,n;return r=Te,(n=Ku())!==u&&(n=wt()),(r=n)===u&&(r=Te,(n=Vu())!==u&&(n=Nt()),r=n),r}function Iu(){var r;return(r=Fu())===u&&(r=fu()),r}function Fu(){var n,t,e,o,i;if(n=Te,39===r.charCodeAt(Te)?(t=m,Te++):(t=u,0===_e&&De(Dr)),t===u&&(r.substr(Te,2)===E?(t=E,Te+=2):(t=u,0===_e&&De(Hr))),t!==u){for(e=[],o=Te,r.substr(Te,2)===x?(i=x,Te+=2):(i=u,0===_e&&De(Ur)),i!==u&&(i=Ot()),(o=i)===u&&(pr.test(r.charAt(Te))?(o=r.charAt(Te),Te++):(o=u,0===_e&&De(jr)));o!==u;)e.push(o),o=Te,r.substr(Te,2)===x?(i=x,Te+=2):(i=u,0===_e&&De(Ur)),i!==u&&(i=Ot()),(o=i)===u&&(pr.test(r.charAt(Te))?(o=r.charAt(Te),Te++):(o=u,0===_e&&De(jr)));39===r.charCodeAt(Te)?(o=m,Te++):(o=u,0===_e&&De(Dr)),o!==u?n=_t(e):(Te=n,n=u)}else Te=n,n=u;return n}function Su(){var r;return(r=Mu())===u&&(r=Du()),r}function Mu(){var r,n,t,e,o;if(r=Te,Lo()!==u)if(Fo(),(n=Pe())!==u){for(Fo(),t=[],e=Uu();e!==u;)t.push(e),e=Uu();e=Fo(),(o=To())!==u?r=Rt(n,t):(Te=r,r=u)}else Te=r,r=u;else Te=r,r=u;if(r===u)if(r=Te,Lo()!==u)if(Fo(),(n=Pe())!==u){for(Fo(),t=[],e=Uu();e!==u;)t.push(e),e=Uu();e=Fo(),(o=ju())!==u?(Fo(),To()!==u?r=It(n,t,o):(Te=r,r=u)):(Te=r,r=u)}else Te=r,r=u;else Te=r,r=u;return r}function Du(){var r,n,t,e;if(r=Te,Lo()!==u){for(Fo(),n=[],t=Hu();t!==u;)n.push(t),t=Hu();t=Fo(),(e=To())!==u?r=Ft(n):(Te=r,r=u)}else Te=r,r=u;if(r===u)if(r=Te,Lo()!==u){for(Fo(),n=[],t=Hu();t!==u;)n.push(t),t=Hu();t=Fo(),(e=ju())!==u?(Fo(),To()!==u?r=St(n,e):(Te=r,r=u)):(Te=r,r=u)}else Te=r,r=u;return r}function Hu(){var r,n,t;return r=Te,wo()!==u?(Fo(),(n=Pe())!==u?(Fo(),No()!==u?(Fo(),(t=Pe())!==u?r=Mt(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r}function Uu(){var r,n,t;return r=Te,wo()!==u?(Fo(),(n=Pe())!==u?(Fo(),No()!==u?(Fo(),(t=Pe())!==u?r=Mt(n,t):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u)):(Te=r,r=u),r}function ju(){var r,n;return r=Te,Oo()!==u?(Fo(),(n=Pe())!==u?r=Dt(n):(Te=r,r=u)):(Te=r,r=u),r}function Pu(){var r,n,t,e;return r=Te,(n=Bu())!==u?(t=Te,_e++,e=au(),_e--,e===u?t=void 0:(Te=t,t=u),t!==u?r=Ht(n):(Te=r,r=u)):(Te=r,r=u),r}function Bu(){var r,n,t,e;return r=Te,(n=zu())!==u&&(t=Gu())!==u&&(e=Zu())!==u?r=Ut(n,t,e):(Te=r,r=u),r===u&&(r=Te,(n=zu())!==u&&(t=Gu())!==u?r=jt(n,t):(Te=r,r=u),r===u&&(r=Te,(n=zu())!==u&&(t=Zu())!==u?r=Pt(n,t):(Te=r,r=u),r===u&&(r=Te,(n=zu())!==u&&(n=Bt(n)),r=n))),r}function zu(){var n,t,e;return(n=Wu())===u&&(n=Te,45===r.charCodeAt(Te)?(t=y,Te++):(t=u,0===_e&&De(Or)),t===u&&(43===r.charCodeAt(Te)?(t=b,Te++):(t=u,0===_e&&De(Nr))),t!==u&&(e=Wu())!==u?n=zt(t,e):(Te=n,n=u)),n}function Gu(){var n,t,e;return n=Te,46===r.charCodeAt(Te)?(t=L,Te++):(t=u,0===_e&&De(Pr)),t!==u?((e=Wu())===u&&(e=null),n=Gt(e)):(Te=n,n=u),n}function Zu(){var r,n,t;return r=Te,(n=ku())!==u&&(t=Wu())!==u?r=Zt(n,t):(Te=r,r=u),r}function Wu(){var r,n;if(r=[],(n=Yu())!==u)for(;n!==u;)r.push(n),n=Yu();else r=u;return r!==u&&(r=Wt(r)),r}function Yu(){var n;return dr.test(r.charAt(Te))?(n=r.charAt(Te),Te++):(n=u,0===_e&&De(Br)),n}function ku(){var n,t,e;return n=Te,hr.test(r.charAt(Te))?(t=r.charAt(Te),Te++):(t=u,0===_e&&De(zr)),t!==u?(br.test(r.charAt(Te))?(e=r.charAt(Te),Te++):(e=u,0===_e&&De(Gr)),e===u&&(e=null),n=Yt(t,e)):(Te=n,n=u),n}function qu(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===T?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(Zr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=t=[t,e]:(Te=n,n=u)):(Te=n,n=u),n}function Ku(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===w?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(Wr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=t=[t,e]:(Te=n,n=u)):(Te=n,n=u),n}function Vu(){var n,t,e,o;return n=Te,r.substr(Te,5).toLowerCase()===N?(t=r.substr(Te,5),Te+=5):(t=u,0===_e&&De(Yr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=t=[t,e]:(Te=n,n=u)):(Te=n,n=u),n}function Xu(){var n,t,e,o;return n=Te,r.substr(Te,2).toLowerCase()===O?(t=r.substr(Te,2),Te+=2):(t=u,0===_e&&De(kr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=kt():(Te=n,n=u)):(Te=n,n=u),n}function $u(){var n,t,e,o;return n=Te,r.substr(Te,2).toLowerCase()===_?(t=r.substr(Te,2),Te+=2):(t=u,0===_e&&De(qr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=qt():(Te=n,n=u)):(Te=n,n=u),n}function Ju(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===R?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(Kr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Kt():(Te=n,n=u)):(Te=n,n=u),n}function Qu(){var n,t,e,o;return n=Te,r.substr(Te,6).toLowerCase()===I?(t=r.substr(Te,6),Te+=6):(t=u,0===_e&&De(Vr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Vt():(Te=n,n=u)):(Te=n,n=u),n}function ro(){var n,t,e,o;return n=Te,r.substr(Te,3).toLowerCase()===F?(t=r.substr(Te,3),Te+=3):(t=u,0===_e&&De(Xr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Xt():(Te=n,n=u)):(Te=n,n=u),n}function no(){var n,t,e,o;return n=Te,r.substr(Te,3).toLowerCase()===S?(t=r.substr(Te,3),Te+=3):(t=u,0===_e&&De($r)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=$t():(Te=n,n=u)):(Te=n,n=u),n}function to(){var n,t,e,o;return n=Te,r.substr(Te,2).toLowerCase()===M?(t=r.substr(Te,2),Te+=2):(t=u,0===_e&&De(Jr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Jt():(Te=n,n=u)):(Te=n,n=u),n}function eo(){var n,t,e,o;return n=Te,r.substr(Te,7).toLowerCase()===D?(t=r.substr(Te,7),Te+=7):(t=u,0===_e&&De(Qr)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Qt():(Te=n,n=u)):(Te=n,n=u),n}function uo(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===H?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(rn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=re():(Te=n,n=u)):(Te=n,n=u),n}function oo(){var n,t,e,o;return n=Te,r.substr(Te,3).toLowerCase()===U?(t=r.substr(Te,3),Te+=3):(t=u,0===_e&&De(nn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ne():(Te=n,n=u)):(Te=n,n=u),n}function io(){var n,t,e,o;return n=Te,r.substr(Te,9).toLowerCase()===j?(t=r.substr(Te,9),Te+=9):(t=u,0===_e&&De(tn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=te():(Te=n,n=u)):(Te=n,n=u),n}function ao(){var n,t,e,o;return n=Te,r.substr(Te,7).toLowerCase()===P?(t=r.substr(Te,7),Te+=7):(t=u,0===_e&&De(en)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ee():(Te=n,n=u)):(Te=n,n=u),n}function co(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===B?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(un)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ue():(Te=n,n=u)):(Te=n,n=u),n}function so(){var n,t,e,o;return n=Te,r.substr(Te,8).toLowerCase()===z?(t=r.substr(Te,8),Te+=8):(t=u,0===_e&&De(on)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=oe():(Te=n,n=u)):(Te=n,n=u),n}function fo(){var n,t,e,o;return n=Te,r.substr(Te,9).toLowerCase()===G?(t=r.substr(Te,9),Te+=9):(t=u,0===_e&&De(an)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ie():(Te=n,n=u)):(Te=n,n=u),n}function lo(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===Z?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(cn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ae():(Te=n,n=u)):(Te=n,n=u),n}function vo(){var n,t,e,o;return n=Te,r.substr(Te,7).toLowerCase()===W?(t=r.substr(Te,7),Te+=7):(t=u,0===_e&&De(sn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ce():(Te=n,n=u)):(Te=n,n=u),n}function po(){var n,t,e,o;return n=Te,r.substr(Te,8).toLowerCase()===Y?(t=r.substr(Te,8),Te+=8):(t=u,0===_e&&De(fn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=se():(Te=n,n=u)):(Te=n,n=u),n}function ho(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===k?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(ln)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=fe():(Te=n,n=u)):(Te=n,n=u),n}function bo(){var n,t,e,o;return n=Te,r.substr(Te,2).toLowerCase()===q?(t=r.substr(Te,2),Te+=2):(t=u,0===_e&&De(vn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=le():(Te=n,n=u)):(Te=n,n=u),n}function yo(){var n,t,e,o;return n=Te,r.substr(Te,8).toLowerCase()===K?(t=r.substr(Te,8),Te+=8):(t=u,0===_e&&De(pn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ve():(Te=n,n=u)):(Te=n,n=u),n}function Ao(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===V?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(dn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=pe():(Te=n,n=u)):(Te=n,n=u),n}function go(){var n,t,e,o;return n=Te,r.substr(Te,5).toLowerCase()===X?(t=r.substr(Te,5),Te+=5):(t=u,0===_e&&De(hn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=de():(Te=n,n=u)):(Te=n,n=u),n}function Co(){var n,t,e,o;return n=Te,r.substr(Te,3).toLowerCase()===$?(t=r.substr(Te,3),Te+=3):(t=u,0===_e&&De(bn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=he():(Te=n,n=u)):(Te=n,n=u),n}function mo(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===J?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(yn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=be():(Te=n,n=u)):(Te=n,n=u),n}function Eo(){var n,t,e,o;return n=Te,r.substr(Te,6).toLowerCase()===Q?(t=r.substr(Te,6),Te+=6):(t=u,0===_e&&De(An)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ye():(Te=n,n=u)):(Te=n,n=u),n}function xo(){var n,t,e,o;return n=Te,r.substr(Te,6).toLowerCase()===rr?(t=r.substr(Te,6),Te+=6):(t=u,0===_e&&De(gn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Ae():(Te=n,n=u)):(Te=n,n=u),n}function Lo(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===nr?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(Cn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=ge():(Te=n,n=u)):(Te=n,n=u),n}function To(){var n,t,e,o;return n=Te,r.substr(Te,3).toLowerCase()===tr?(t=r.substr(Te,3),Te+=3):(t=u,0===_e&&De(mn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Ce():(Te=n,n=u)):(Te=n,n=u),n}function wo(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===er?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(En)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=me():(Te=n,n=u)):(Te=n,n=u),n}function No(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===ur?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(xn)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=Ee():(Te=n,n=u)):(Te=n,n=u),n}function Oo(){var n,t,e,o;return n=Te,r.substr(Te,4).toLowerCase()===or?(t=r.substr(Te,4),Te+=4):(t=u,0===_e&&De(Ln)),t!==u?(e=Te,_e++,o=cu(),_e--,o===u?e=void 0:(Te=e,e=u),e!==u?n=xe():(Te=n,n=u)):(Te=n,n=u),n}function _o(){var n;return 44===r.charCodeAt(Te)?(n=ir,Te++):(n=u,0===_e&&De(Tn)),n}function Ro(){var n;return 40===r.charCodeAt(Te)?(n=ar,Te++):(n=u,0===_e&&De(wn)),n}function Io(){var n;return 41===r.charCodeAt(Te)?(n=cr,Te++):(n=u,0===_e&&De(Nn)),n}function Fo(){var r,n;for(r=[],n=So();n!==u;)r.push(n),n=So();return r}function So(){var n;return yr.test(r.charAt(Te))?(n=r.charAt(Te),Te++):(n=u,0===_e&&De(On)),n}function Mo(){var n,t,e,o;if(n=Te,(t=iu())!==u&&(t=Xn(t)),(n=t)===u)if(n=Te,96===r.charCodeAt(Te)?(t=sr,Te++):(t=u,0===_e&&De(_n)),t!==u){if(e=[],Ar.test(r.charAt(Te))?(o=r.charAt(Te),Te++):(o=u,0===_e&&De(Rn)),o!==u)for(;o!==u;)e.push(o),Ar.test(r.charAt(Te))?(o=r.charAt(Te),Te++):(o=u,0===_e&&De(Rn));else e=u;e!==u?(96===r.charCodeAt(Te)?(o=sr,Te++):(o=u,0===_e&&De(_n)),o!==u?n=Le(e):(Te=n,n=u)):(Te=n,n=u)}else Te=n,n=u;return n}function Do(r,n){return{type:"unary_expr",operator:r,expr:n}}function Ho(r,n,t,e){var u={type:"binary_expr",operator:r,left:n,right:t};return void 0!==e&&(u.escape=e),u}function Uo(r,n){for(var t=[r],e=0;e<n.length;e++)t.push(n[e][3]);return t}function jo(r,n,t){return Uo(r,n)}function Po(r,n){for(var t=r,e=0;e<n.length;e++)t=Ho(n[e][1],t,n[e][3]);return t}if((e=a())!==u&&Te===r.length)return e;throw e!==u&&Te<r.length&&De(Fe()),He(Oe,Ne<r.length?r.charAt(Ne):null,Ne<r.length?Me(Ne,Ne+1):Me(Ne,Ne))}return r(n,Error),n.prototype.format=function(r){var n="Error: "+this.message;if(this.location){var e,u=null;for(e=0;e<r.length;e++)if(r[e].source===this.location.source){u=r[e].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,i=this.location.source+":"+o.line+":"+o.column;if(u){var a=this.location.end,c=t("",o.line.toString().length),s=u[o.line-1],f=o.line===a.line?a.column:s.length+1;n+="\n --\x3e "+i+"\n"+c+" |\n"+o.line+" | "+s+"\n"+c+" | "+t("",o.column-1)+t("",f-o.column,"^")}else n+="\n at "+i}return n},n.buildMessage=function(r,n){var t={literal:function(r){return'"'+u(r.text)+'"'},class:function(r){var n=r.parts.map((function(r){return Array.isArray(r)?o(r[0])+"-"+o(r[1]):o(r)}));return"["+(r.inverted?"^":"")+n+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(r){return r.description}};function e(r){return r.charCodeAt(0).toString(16).toUpperCase()}function u(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+e(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+e(r)}))}function o(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+e(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+e(r)}))}function i(r){return t[r.type](r)}function a(r){var n,t,e=r.map(i);if(e.sort(),e.length>0){for(n=1,t=1;n<e.length;n++)e[n-1]!==e[n]&&(e[t]=e[n],t++);e.length=t}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}function c(r){return r?'"'+u(r)+'"':"end of input"}return"Expected "+a(r)+" but "+c(n)+" found."},{SyntaxError:n,parse:e}},(n=e).exports&&(n.exports=t());class u{static parse(r){return e.exports.parse(r)}}


/***/ }),

/***/ "./node_modules/@arcgis/core/geometry/geometryEngineAsync.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@arcgis/core/geometry/geometryEngineAsync.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "buffer": () => (/* binding */ V),
/* harmony export */   "clip": () => (/* binding */ l),
/* harmony export */   "contains": () => (/* binding */ p),
/* harmony export */   "convexHull": () => (/* binding */ N),
/* harmony export */   "crosses": () => (/* binding */ w),
/* harmony export */   "cut": () => (/* binding */ y),
/* harmony export */   "densify": () => (/* binding */ P),
/* harmony export */   "difference": () => (/* binding */ R),
/* harmony export */   "disjoint": () => (/* binding */ S),
/* harmony export */   "distance": () => (/* binding */ m),
/* harmony export */   "equals": () => (/* binding */ d),
/* harmony export */   "extendedSpatialReferenceInfo": () => (/* binding */ f),
/* harmony export */   "flipHorizontal": () => (/* binding */ B),
/* harmony export */   "flipVertical": () => (/* binding */ C),
/* harmony export */   "generalize": () => (/* binding */ G),
/* harmony export */   "geodesicArea": () => (/* binding */ K),
/* harmony export */   "geodesicBuffer": () => (/* binding */ b),
/* harmony export */   "geodesicDensify": () => (/* binding */ U),
/* harmony export */   "geodesicLength": () => (/* binding */ M),
/* harmony export */   "intersect": () => (/* binding */ j),
/* harmony export */   "intersects": () => (/* binding */ g),
/* harmony export */   "isSimple": () => (/* binding */ v),
/* harmony export */   "nearestCoordinate": () => (/* binding */ z),
/* harmony export */   "nearestVertex": () => (/* binding */ D),
/* harmony export */   "nearestVertices": () => (/* binding */ H),
/* harmony export */   "offset": () => (/* binding */ I),
/* harmony export */   "overlaps": () => (/* binding */ O),
/* harmony export */   "planarArea": () => (/* binding */ W),
/* harmony export */   "planarLength": () => (/* binding */ F),
/* harmony export */   "relate": () => (/* binding */ h),
/* harmony export */   "rotate": () => (/* binding */ q),
/* harmony export */   "simplify": () => (/* binding */ J),
/* harmony export */   "symmetricDifference": () => (/* binding */ E),
/* harmony export */   "touches": () => (/* binding */ A),
/* harmony export */   "union": () => (/* binding */ k),
/* harmony export */   "within": () => (/* binding */ x)
/* harmony export */ });
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../geometry.js */ "./node_modules/@arcgis/core/geometry.js");
/* harmony import */ var _core_workers_workers_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/workers/workers.js */ "./node_modules/@arcgis/core/core/workers/workers.js");
/* harmony import */ var _Point_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Point.js */ "./node_modules/@arcgis/core/geometry/Point.js");
/* harmony import */ var _support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./support/jsonUtils.js */ "./node_modules/@arcgis/core/geometry/support/jsonUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e(n){var t;return Array.isArray(n)?null==(t=n[0])?void 0:t.spatialReference:null==n?void 0:n.spatialReference}function i(n){return n?Array.isArray(n)?n.map(i):n.toJSON?n.toJSON():n:n}function a(n){return Array.isArray(n)?n.map((n=>(0,_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_3__.fromJSON)(n))):(0,_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_3__.fromJSON)(n)}function o(n,t){let r;return Array.isArray(n)?r=n:(r=[],r.push(n),null!=t&&r.push(t)),r}let c;async function u(){return c||(c=(0,_core_workers_workers_js__WEBPACK_IMPORTED_MODULE_1__.open)("geometryEngineWorker",{strategy:"distributed"})),c}async function s(n,t){return(await u()).invoke("executeGEOperation",{operation:n,parameters:i(t)})}function f(n){return s("extendedSpatialReferenceInfo",[n])}async function l(n,t){return a(await s("clip",[e(n),n,t]))}async function y(n,t){return a(await s("cut",[e(n),n,t]))}function p(n,t){return s("contains",[e(n),n,t])}function w(n,t){return s("crosses",[e(n),n,t])}function m(n,t,r){return s("distance",[e(n),n,t,r])}function d(n,t){return s("equals",[e(n),n,t])}function g(n,t){return s("intersects",[e(n),n,t])}function A(n,t){return s("touches",[e(n),n,t])}function x(n,t){return s("within",[e(n),n,t])}function S(n,t){return s("disjoint",[e(n),n,t])}function O(n,t){return s("overlaps",[e(n),n,t])}function h(n,t,r){return s("relate",[e(n),n,t,r])}function v(n){return s("isSimple",[e(n),n])}async function J(n){return a(await s("simplify",[e(n),n]))}async function N(n,t=!1){return a(await s("convexHull",[e(n),n,t]))}async function R(n,t){return a(await s("difference",[e(n),n,t]))}async function E(n,t){return a(await s("symmetricDifference",[e(n),n,t]))}async function j(n,t){return a(await s("intersect",[e(n),n,t]))}async function k(n,t=null){const r=o(n,t);return a(await s("union",[e(r),r]))}async function I(n,t,r,i,o,c){return a(await s("offset",[e(n),n,t,r,i,o,c]))}async function V(n,t,r,i=!1){const o=[e(n),n,t,r,i];return a(await s("buffer",o))}async function b(n,t,r,i,o,c){const u=[e(n),n,t,r,i,o,c];return a(await s("geodesicBuffer",u))}async function z(n,r,i=!0){const a=await s("nearestCoordinate",[e(n),n,r,i]);return{...a,coordinate:_Point_js__WEBPACK_IMPORTED_MODULE_2__["default"].fromJSON(a.coordinate)}}async function D(n,r){const i=await s("nearestVertex",[e(n),n,r]);return{...i,coordinate:_Point_js__WEBPACK_IMPORTED_MODULE_2__["default"].fromJSON(i.coordinate)}}async function H(n,r,i,a){return(await s("nearestVertices",[e(n),n,r,i,a])).map((n=>({...n,coordinate:_Point_js__WEBPACK_IMPORTED_MODULE_2__["default"].fromJSON(n.coordinate)})))}function L(n){return"xmin"in n?n.center:"x"in n?n:n.extent.center}async function q(n,t,r){var e;if(null==n)throw new Error("Illegal Argument Exception");const i=n.spatialReference;r=null!=(e=r)?e:L(n);const a=n.constructor.fromJSON(await s("rotate",[i,n,t,r]));return a.spatialReference=i,a}async function B(n,t){var r;if(null==n)throw new Error("Illegal Argument Exception");const e=n.spatialReference;t=null!=(r=t)?r:L(n);const i=n.constructor.fromJSON(await s("flipHorizontal",[e,n,t]));return i.spatialReference=e,i}async function C(n,t){var r;if(null==n)throw new Error("Illegal Argument Exception");const e=n.spatialReference;t=null!=(r=t)?r:L(n);const i=n.constructor.fromJSON(await s("flipVertical",[e,n,t]));return i.spatialReference=e,i}async function G(n,t,r,i){return a(await s("generalize",[e(n),n,t,r,i]))}async function P(n,t,r){return a(await s("densify",[e(n),n,t,r]))}async function U(n,t,r,i=0){return a(await s("geodesicDensify",[e(n),n,t,r,i]))}function W(n,t){return s("planarArea",[e(n),n,t])}function F(n,t){return s("planarLength",[e(n),n,t])}function K(n,t,r){return s("geodesicArea",[e(n),n,t,r])}function M(n,t,r){return s("geodesicLength",[e(n),n,t,r])}


/***/ })

}]);